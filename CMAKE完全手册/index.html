<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CMAKEå®Œå…¨æ‰‹å†Œ | JUST NOTE</title><meta name="author" content="Fravel Wang"><meta name="copyright" content="Fravel Wang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="é…åˆCMakeç®€æ˜æ•™ç¨‹ä½¿ç”¨ï¼Œç»†èŠ‚æ›´å¤š, æ—¥å¸¸å°é¡¹ç›®ï¼Œç®€æ˜æ‰‹å†Œçš„å·¥ç¨‹æ¨¡æ¿å®Œå…¨å¤Ÿç”¨,è¿™ä¸ªæ•™ç¨‹æœ«å°¾çš„æ¨¡æ¿å°±æ˜¯æ›´ç¬¦åˆå›½é™…æƒ¯ä¾‹ä¸€äº›">
<meta property="og:type" content="article">
<meta property="og:title" content="CMAKEå®Œå…¨æ‰‹å†Œ">
<meta property="og:url" content="http://example.com/CMAKE%E5%AE%8C%E5%85%A8%E6%89%8B%E5%86%8C/index.html">
<meta property="og:site_name" content="JUST NOTE">
<meta property="og:description" content="é…åˆCMakeç®€æ˜æ•™ç¨‹ä½¿ç”¨ï¼Œç»†èŠ‚æ›´å¤š, æ—¥å¸¸å°é¡¹ç›®ï¼Œç®€æ˜æ‰‹å†Œçš„å·¥ç¨‹æ¨¡æ¿å®Œå…¨å¤Ÿç”¨,è¿™ä¸ªæ•™ç¨‹æœ«å°¾çš„æ¨¡æ¿å°±æ˜¯æ›´ç¬¦åˆå›½é™…æƒ¯ä¾‹ä¸€äº›">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/avatar.jpeg">
<meta property="article:published_time" content="2025-10-12T17:39:14.000Z">
<meta property="article:modified_time" content="2025-10-13T12:42:44.392Z">
<meta property="article:author" content="Fravel Wang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CMAKEå®Œå…¨æ‰‹å†Œ",
  "url": "http://example.com/CMAKE%E5%AE%8C%E5%85%A8%E6%89%8B%E5%86%8C/",
  "image": "http://example.com/img/avatar.jpeg",
  "datePublished": "2025-10-12T17:39:14.000Z",
  "dateModified": "2025-10-13T12:42:44.392Z",
  "author": [
    {
      "@type": "Person",
      "name": "Fravel Wang",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/avatar.jpeg"><link rel="canonical" href="http://example.com/CMAKE%E5%AE%8C%E5%85%A8%E6%89%8B%E5%86%8C/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"pagination":{"enable":true,"hitsPerPage":8},"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CMAKEå®Œå…¨æ‰‹å†Œ',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/bg_img.jpg);"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent;"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">JUST NOTE</span></a><a class="nav-page-title" href="/"><span class="site-name">CMAKEå®Œå…¨æ‰‹å†Œ</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div></div></nav><div id="post-info"><h1 class="post-title">CMAKEå®Œå…¨æ‰‹å†Œ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-10-12T17:39:14.000Z" title="Created 2025-10-13 01:39:14">2025-10-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-13T12:42:44.392Z" title="Updated 2025-10-13 20:42:44">2025-10-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>é…åˆCMakeç®€æ˜æ•™ç¨‹ä½¿ç”¨ï¼Œç»†èŠ‚æ›´å¤š, æ—¥å¸¸å°é¡¹ç›®ï¼Œç®€æ˜æ‰‹å†Œçš„å·¥ç¨‹æ¨¡æ¿å®Œå…¨å¤Ÿç”¨,è¿™ä¸ªæ•™ç¨‹æœ«å°¾çš„æ¨¡æ¿å°±æ˜¯æ›´ç¬¦åˆå›½é™…æƒ¯ä¾‹ä¸€äº›</p>
<span id="more"></span>

<hr>
<h1 id="ğŸ§±-ç¬¬-1-ç« -CMake-å˜é‡ç³»ç»Ÿå…¨è§£ï¼ˆè„šæœ¬è¯­æ³•æ ¸å¿ƒï¼‰"><a href="#ğŸ§±-ç¬¬-1-ç« -CMake-å˜é‡ç³»ç»Ÿå…¨è§£ï¼ˆè„šæœ¬è¯­æ³•æ ¸å¿ƒï¼‰" class="headerlink" title="ğŸ§±â€¯ç¬¬â€¯1â€¯ç« â€¯|â€¯CMakeâ€¯å˜é‡ç³»ç»Ÿå…¨è§£ï¼ˆè„šæœ¬è¯­æ³•æ ¸å¿ƒï¼‰"></a>ğŸ§±â€¯ç¬¬â€¯1â€¯ç« â€¯|â€¯CMakeâ€¯å˜é‡ç³»ç»Ÿå…¨è§£ï¼ˆè„šæœ¬è¯­æ³•æ ¸å¿ƒï¼‰</h1><hr>
<h2 id="1-å˜é‡ç±»å‹ä¸å®šä¹‰è§„åˆ™"><a href="#1-å˜é‡ç±»å‹ä¸å®šä¹‰è§„åˆ™" class="headerlink" title="1.â€¯å˜é‡ç±»å‹ä¸å®šä¹‰è§„åˆ™"></a>1.â€¯å˜é‡ç±»å‹ä¸å®šä¹‰è§„åˆ™</h2><p>CMakeâ€¯çš„è„šæœ¬ä¸–ç•Œé‡Œï¼Œä¸€åˆ‡éƒ½æ˜¯å­—ç¬¦ä¸²å˜é‡ï¼ˆæ— æ˜¾å¼æ•°æ®ç±»å‹ï¼‰ã€‚<br>è¯­æ³•ç»“æ„ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(&lt;å˜é‡å&gt; &lt;å€¼&gt; [CACHE &lt;ç±»å‹&gt; &lt;æè¿°&gt; [FORCE]])</span><br></pre></td></tr></table></figure>

<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(MY_NAME <span class="string">&quot;Alice&quot;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;name = $&#123;MY_NAME&#125;&quot;</span>)  <span class="comment"># è¾“å‡ºï¼šname = Alice</span></span><br></pre></td></tr></table></figure>

<p><strong>è¯´æ˜ï¼š</strong>  </p>
<ul>
<li>å˜é‡åŒºåˆ†å¤§å°å†™ï¼›  </li>
<li>é»˜è®¤ä½œç”¨åŸŸæ˜¯å½“å‰æ–‡ä»¶ï¼›  </li>
<li>åœ¨å‡½æ•°â€¯functionâ€¯å†…æ˜¯å±€éƒ¨ä½œç”¨åŸŸï¼›åœ¨â€¯macroâ€¯åˆ™å…±äº«å¤–å±‚ï¼›  </li>
<li><code>$&#123;å˜é‡å&#125;</code>â€¯å–å€¼ï¼Œä¸èƒ½çœâ€¯<code>$&#123;&#125;</code>ã€‚</li>
</ul>
<hr>
<h2 id="2-ä¸‰ç±»ä¸»è¦å˜é‡"><a href="#2-ä¸‰ç±»ä¸»è¦å˜é‡" class="headerlink" title="2.â€¯ä¸‰ç±»ä¸»è¦å˜é‡"></a>2.â€¯ä¸‰ç±»ä¸»è¦å˜é‡</h2><table>
<thead>
<tr>
<th>åˆ†ç±»</th>
<th>å®šä¹‰æ–¹å¼</th>
<th>ç”Ÿå‘½å‘¨æœŸ &#x2F; å­˜å‚¨ä½ç½®</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>æ™®é€šå˜é‡</td>
<td><code>set(VAR val)</code></td>
<td>å½“å‰ä½œç”¨åŸŸ</td>
<td><code>set(Aâ€¯5)</code></td>
</tr>
<tr>
<td>ç¼“å­˜å˜é‡</td>
<td><code>set(VAR val CACHE TYPE DESC)</code></td>
<td>å†™å…¥â€¯CMakeCache.txt</td>
<td>æ„å»ºé…ç½®é€‰é¡¹</td>
</tr>
<tr>
<td>ç¯å¢ƒå˜é‡</td>
<td><code>set(ENV&#123;VAR&#125; val)</code></td>
<td>ä¼ é€’ç»™å¤–éƒ¨å‘½ä»¤ç¯å¢ƒ</td>
<td><code>set(ENV&#123;PATH&#125; /opt/bin:$ENV&#123;PATH&#125;)</code></td>
</tr>
</tbody></table>
<p>ğŸ”¹â€¯<strong>ç¯å¢ƒå˜é‡ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">message</span>(<span class="string">&quot;before = $ENV&#123;PATH&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(ENV&#123;PATH&#125; <span class="string">&quot;/extra:$ENV&#123;PATH&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">execute_process</span>(<span class="keyword">COMMAND</span> env)  <span class="comment"># ç”Ÿæˆè¿‡ç¨‹ä¸­çš„ç¯å¢ƒå¯ç”¨</span></span><br></pre></td></tr></table></figure>

<p>ğŸ”¹â€¯<strong>ç¼“å­˜å˜é‡ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(BUILD_VERBOSE <span class="keyword">ON</span> CACHE BOOL <span class="string">&quot;Show build details&quot;</span>)</span><br><span class="line"><span class="comment"># å‘½ä»¤è¡Œï¼šcmake -DBUILD_VERBOSE=ON ..</span></span><br></pre></td></tr></table></figure>

<p>ç¼“å­˜å˜é‡å¯ç”¨äºç”Ÿæˆé…ç½®é€‰é¡¹ç•Œé¢ï¼ˆccmake &#x2F; CMakeâ€¯GUIï¼‰ï¼Œå€¼æŒä¹…åŒ–åœ¨å½“å‰â€¯buildâ€¯ç›®å½•ï¼Œé™¤éåŠ â€¯FORCEâ€¯æ‰ä¼šè¦†ç›–ã€‚</p>
<hr>
<h2 id="3-å˜é‡ä½œç”¨åŸŸç¤ºä¾‹"><a href="#3-å˜é‡ä½œç”¨åŸŸç¤ºä¾‹" class="headerlink" title="3.â€¯å˜é‡ä½œç”¨åŸŸç¤ºä¾‹"></a>3.â€¯å˜é‡ä½œç”¨åŸŸç¤ºä¾‹</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(V outer)</span><br><span class="line"><span class="keyword">function</span>(<span class="keyword">test</span>)</span><br><span class="line">  <span class="keyword">set</span>(V inner)</span><br><span class="line">  <span class="keyword">message</span>(<span class="string">&quot;in function: $&#123;V&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endfunction</span>()</span><br><span class="line"><span class="keyword">test</span>()</span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;outside: $&#123;V&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">in function: inner</span><br><span class="line">outside: outer</span><br></pre></td></tr></table></figure>

<p>functionâ€¯å†…éƒ¨ä¸ä¼šä¿®æ”¹å¤–å±‚ï¼›<br>è‹¥ç”¨â€¯macroâ€¯å®šä¹‰ï¼Œåˆ™ä½œç”¨åŸŸå…±äº«ï¼Œä¼šæ”¹åŠ¨å¤–å±‚ã€‚  </p>
<hr>
<h2 id="4-åˆ—è¡¨ä¸å­—ç¬¦ä¸²æ“ä½œ"><a href="#4-åˆ—è¡¨ä¸å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="4.â€¯åˆ—è¡¨ä¸å­—ç¬¦ä¸²æ“ä½œ"></a>4.â€¯åˆ—è¡¨ä¸å­—ç¬¦ä¸²æ“ä½œ</h2><h3 id="4-1-åˆ—è¡¨åŸºç¡€"><a href="#4-1-åˆ—è¡¨åŸºç¡€" class="headerlink" title="4.1â€¯åˆ—è¡¨åŸºç¡€"></a>4.1â€¯åˆ—è¡¨åŸºç¡€</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(MYLIST A B C)</span><br><span class="line"><span class="keyword">list</span>(APPEND MYLIST D)</span><br><span class="line"><span class="keyword">foreach</span>(item IN LISTS MYLIST)</span><br><span class="line">  <span class="keyword">message</span>(<span class="string">&quot;item=$&#123;item&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>()</span><br></pre></td></tr></table></figure>

<h3 id="4-2-å¸¸ç”¨-list-å­å‘½ä»¤"><a href="#4-2-å¸¸ç”¨-list-å­å‘½ä»¤" class="headerlink" title="4.2â€¯å¸¸ç”¨â€¯list()â€¯å­å‘½ä»¤"></a>4.2â€¯å¸¸ç”¨â€¯list()â€¯å­å‘½ä»¤</h3><table>
<thead>
<tr>
<th>å­å‘½ä»¤</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>APPEND</td>
<td>è¿½åŠ </td>
</tr>
<tr>
<td>LENGTH</td>
<td>è·å–é•¿åº¦</td>
</tr>
<tr>
<td>GET i</td>
<td>å–å…ƒç´ </td>
</tr>
<tr>
<td>REMOVE_ITEM</td>
<td>åˆ é™¤åŒ¹é…é¡¹</td>
</tr>
<tr>
<td>JOIN</td>
<td>åˆå¹¶ä¸ºå­—ç¬¦ä¸²</td>
</tr>
</tbody></table>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">list</span>(JOIN MYLIST <span class="string">&quot;,&quot;</span> JOINED)</span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;$&#123;JOINED&#125;&quot;</span>)  <span class="comment"># â†’ A,B,C,D</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-3-å­—ç¬¦ä¸²å¤„ç†"><a href="#4-3-å­—ç¬¦ä¸²å¤„ç†" class="headerlink" title="4.3â€¯å­—ç¬¦ä¸²å¤„ç†"></a>4.3â€¯å­—ç¬¦ä¸²å¤„ç†</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">string</span>(TOUPPER <span class="string">&quot;abc&quot;</span> OUT)     <span class="comment"># å˜å¤§å†™</span></span><br><span class="line"><span class="keyword">string</span>(SUBSTRING <span class="string">&quot;abcdef&quot;</span> <span class="number">0</span> <span class="number">3</span> FIRST)</span><br><span class="line"><span class="keyword">string</span>(REPLACE <span class="string">&quot;a&quot;</span> <span class="string">&quot;x&quot;</span> CHANGED <span class="string">&quot;$&#123;VAR&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">string</span>(FIND <span class="string">&quot;$&#123;TEXT&#125;&quot;</span> <span class="string">&quot;key&quot;</span> POS)</span><br></pre></td></tr></table></figure>

<p>ğŸ“˜â€¯CMakeâ€¯å­—ç¬¦ä¸²æ“ä½œç»Ÿç»Ÿç”Ÿæˆæ–°å˜é‡ï¼Œä¸ä¼šåŸåœ°ä¿®æ”¹ã€‚  </p>
<hr>
<h2 id="5-é¢„å®šä¹‰è·¯å¾„å˜é‡ï¼ˆå¿…é¡»ç†Ÿï¼‰"><a href="#5-é¢„å®šä¹‰è·¯å¾„å˜é‡ï¼ˆå¿…é¡»ç†Ÿï¼‰" class="headerlink" title="5.â€¯é¢„å®šä¹‰è·¯å¾„å˜é‡ï¼ˆå¿…é¡»ç†Ÿï¼‰"></a>5.â€¯é¢„å®šä¹‰è·¯å¾„å˜é‡ï¼ˆå¿…é¡»ç†Ÿï¼‰</h2><table>
<thead>
<tr>
<th>å˜é‡</th>
<th>è§£é‡Š</th>
<th>å…¸å‹å€¼</th>
</tr>
</thead>
<tbody><tr>
<td><code>CMAKE_SOURCE_DIR</code></td>
<td>é¡¶å±‚â€¯CMakeLists.txtâ€¯æ‰€åœ¨æºç æ ¹</td>
<td><code>/home/user/demo</code></td>
</tr>
<tr>
<td><code>CMAKE_CURRENT_SOURCE_DIR</code></td>
<td>å½“å‰â€¯CMakeListsâ€¯æ‰€åœ¨æºç ç›®å½•</td>
<td><code>/home/user/demo/Core</code></td>
</tr>
<tr>
<td><code>CMAKE_BINARY_DIR</code></td>
<td>é¡¶å±‚æ„å»ºç›®å½•</td>
<td><code>/home/user/demo/build</code></td>
</tr>
<tr>
<td><code>CMAKE_CURRENT_BINARY_DIR</code></td>
<td>å½“å‰å­ç›®å½•æ„å»ºç›®å½•</td>
<td><code>/home/user/demo/build/Core</code></td>
</tr>
<tr>
<td><code>PROJECT_SOURCE_DIR</code></td>
<td>å®šä¹‰â€¯project()â€¯çš„ç›®å½•</td>
<td>åŒâ€¯CMAKE_SOURCE_DIR</td>
</tr>
<tr>
<td><code>CMAKE_INSTALL_PREFIX</code></td>
<td>å®‰è£…ç›®æ ‡æ ¹ç›®å½•</td>
<td><code>/usr/local</code>â€¯æˆ–æ‰‹åŠ¨â€¯-prefix</td>
</tr>
<tr>
<td><code>CMAKE_RUNTIME_OUTPUT_DIRECTORY</code></td>
<td>å¯æ‰§è¡Œè¾“å‡ºè·¯å¾„</td>
<td><code>$&#123;CMAKE_SOURCE_DIR&#125;/bin</code></td>
</tr>
<tr>
<td><code>CMAKE_LIBRARY_OUTPUT_DIRECTORY</code></td>
<td>åŠ¨æ€åº“è¾“å‡ºè·¯å¾„</td>
<td><code>$&#123;CMAKE_SOURCE_DIR&#125;/bin/lib</code></td>
</tr>
<tr>
<td><code>CMAKE_ARCHIVE_OUTPUT_DIRECTORY</code></td>
<td>é™æ€åº“è¾“å‡ºè·¯å¾„</td>
<td><code>$&#123;CMAKE_SOURCE_DIR&#125;/bin/lib</code></td>
</tr>
</tbody></table>
<p><strong>èŒƒä¾‹ï¼š</strong></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/bin)</span><br><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br></pre></td></tr></table></figure>
<p>â†’â€¯<code>bin/app</code>â€¯ç”Ÿæˆåœ¨æºç çš„â€¯binâ€¯ç›®å½•ã€‚</p>
<hr>
<h2 id="6-è·¯å¾„ä¸æ–‡ä»¶è¾…åŠ©å˜é‡"><a href="#6-è·¯å¾„ä¸æ–‡ä»¶è¾…åŠ©å˜é‡" class="headerlink" title="6.â€¯è·¯å¾„ä¸æ–‡ä»¶è¾…åŠ©å˜é‡"></a>6.â€¯è·¯å¾„ä¸æ–‡ä»¶è¾…åŠ©å˜é‡</h2><table>
<thead>
<tr>
<th>å˜é‡</th>
<th>å†…å®¹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody><tr>
<td><code>CMAKE_CURRENT_FUNCTION_LIST_DIR</code></td>
<td>å½“å‰å‡½æ•°æ‰€åœ¨æ–‡ä»¶è·¯å¾„</td>
<td>æ¨¡å—å†…å¼•å…¥ç›¸å¯¹è·¯å¾„</td>
</tr>
<tr>
<td><code>CMAKE_COMMAND</code></td>
<td>å½“å‰â€¯cmakeâ€¯å¯æ‰§è¡Œè·¯å¾„</td>
<td>ç”¨äºâ€¯add_custom_commandâ€¯è°ƒç”¨</td>
</tr>
<tr>
<td><code>CMAKE_MODULE_PATH</code></td>
<td>æœç´¢â€¯FindXXX.cmakeâ€¯çš„é¢å¤–ç›®å½•</td>
<td><code>set(CMAKE_MODULE_PATH &quot;$&#123;CMAKE_SOURCE_DIR&#125;/cmake&quot;)</code></td>
</tr>
<tr>
<td><code>CMAKE_GENERATOR</code></td>
<td>å½“å‰ç”Ÿæˆå™¨ï¼ˆNinja &#x2F; Makefiles &#x2F; MSVCï¼‰</td>
<td>æ¡ä»¶åˆ¤æ–­</td>
</tr>
<tr>
<td><code>CMAKE_SYSTEM_NAME</code></td>
<td>æ“ä½œç³»ç»Ÿæ ‡è¯†</td>
<td>äº¤å‰ç¼–è¯‘åˆ¤æ–­</td>
</tr>
<tr>
<td><code>CMAKE_CXX_COMPILER_ID</code></td>
<td>ç¼–è¯‘å™¨æ ‡è¯†</td>
<td>GCC &#x2F; Clang &#x2F; MSVC</td>
</tr>
<tr>
<td><code>CMAKE_BUILD_TYPE</code></td>
<td>æ„å»ºç±»å‹</td>
<td>Debug &#x2F; Releaseâ€¯â€¦</td>
</tr>
</tbody></table>
<hr>
<h2 id="7-å˜é‡å­˜åœ¨æ€§ä¸é»˜è®¤å€¼å¤„ç†"><a href="#7-å˜é‡å­˜åœ¨æ€§ä¸é»˜è®¤å€¼å¤„ç†" class="headerlink" title="7.â€¯å˜é‡å­˜åœ¨æ€§ä¸é»˜è®¤å€¼å¤„ç†"></a>7.â€¯å˜é‡å­˜åœ¨æ€§ä¸é»˜è®¤å€¼å¤„ç†</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">DEFINED</span> VAR)</span><br><span class="line">  <span class="keyword">message</span>(<span class="string">&quot;VAR is defined&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">NOT</span> <span class="keyword">DEFINED</span> SOME_OPTION)</span><br><span class="line">  <span class="keyword">set</span>(SOME_OPTION <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-é«˜çº§æŠ€å·§ï¼šçˆ¶ä½œç”¨åŸŸ-å¤åˆè·¯å¾„"><a href="#8-é«˜çº§æŠ€å·§ï¼šçˆ¶ä½œç”¨åŸŸ-å¤åˆè·¯å¾„" class="headerlink" title="8.â€¯é«˜çº§æŠ€å·§ï¼šçˆ¶ä½œç”¨åŸŸ &amp; å¤åˆè·¯å¾„"></a>8.â€¯é«˜çº§æŠ€å·§ï¼šçˆ¶ä½œç”¨åŸŸ &amp; å¤åˆè·¯å¾„</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨å­å‡½æ•°ä¿®æ”¹å¤–å±‚å€¼</span></span><br><span class="line"><span class="keyword">function</span>(setFlag)</span><br><span class="line">  <span class="keyword">set</span>(MODE ready PARENT_SCOPE)</span><br><span class="line"><span class="keyword">endfunction</span>()</span><br><span class="line">setFlag()</span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;MODE=$&#123;MODE&#125;&quot;</span>)  <span class="comment"># â†’ ready</span></span><br></pre></td></tr></table></figure>

<p>å¤åˆè·¯å¾„æ„å»ºï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(DIR /home)</span><br><span class="line"><span class="keyword">set</span>(PATH <span class="variable">$&#123;DIR&#125;</span>/<span class="keyword">project</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-å°ç»“ä¸å¸¸è§è¯¯åŒº"><a href="#9-å°ç»“ä¸å¸¸è§è¯¯åŒº" class="headerlink" title="9.â€¯å°ç»“ä¸å¸¸è§è¯¯åŒº"></a>9.â€¯å°ç»“ä¸å¸¸è§è¯¯åŒº</h2><table>
<thead>
<tr>
<th>æƒ…å½¢</th>
<th>é—®é¢˜</th>
<th>ä¿®å¤æ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td>ä½¿ç”¨ <code>$VAR</code>â€¯è€Œéâ€¯<code>$&#123;VAR&#125;</code></td>
<td>è§£é‡Šä¸ºç©ºå­—ç¬¦ä¸²</td>
<td>å§‹ç»ˆåŠ èŠ±æ‹¬å·</td>
</tr>
<tr>
<td>æƒ³æ”¹çˆ¶ä½œç”¨åŸŸå˜é‡ä¸èµ·ä½œç”¨</td>
<td>functionâ€¯æœ‰å±€éƒ¨ä½œç”¨åŸŸ</td>
<td>ä½¿ç”¨â€¯PARENT_SCOPE</td>
</tr>
<tr>
<td>æ–°æ–‡ä»¶æœªè¢«æ£€æµ‹åˆ°</td>
<td>ä½¿ç”¨â€¯file(GLOB)</td>
<td>æ˜¾å¼åˆ—æºç æˆ–è§¦å‘â€¯reconfigure</td>
</tr>
<tr>
<td>æƒ³è·¨â€¯buildâ€¯ä¿å­˜è®¾ç½®</td>
<td>ç”¨â€¯CACHEâ€¯å˜é‡</td>
<td><code>set(VAR val CACHE ...)</code></td>
</tr>
<tr>
<td>éœ€è¦ç¯å¢ƒå˜é‡æ›´æ–°</td>
<td>éœ€åœ¨æ‰§è¡Œå‘½ä»¤å‰â€¯set(ENV{})</td>
<td>å¦åˆ™å·²å¯åŠ¨çš„æ„å»ºä¸ä¼šç»§æ‰¿</td>
</tr>
</tbody></table>
<hr>
<p>åˆ°æ­¤ï¼Œç¬¬â€¯1â€¯ç« è¦†ç›–ï¼š</p>
<ul>
<li>å˜é‡å®šä¹‰ä¸3ç§ç±»å‹  </li>
<li>ä½œç”¨åŸŸä¸å‡½æ•°&#x2F;å®å·®å¼‚  </li>
<li>listâ€¯&#x2F;â€¯stringâ€¯å¸¸ç”¨æ“ä½œ  </li>
<li>é¢„å®šä¹‰è·¯å¾„ä¸ç³»ç»Ÿå˜é‡  </li>
<li>ç¼“å­˜ã€ç¯å¢ƒåŠçˆ¶ä½œç”¨åŸŸæŠ€å·§</li>
</ul>
<hr>
<hr>
<h1 id="âš™ï¸-ç¬¬-2-ç« -CMake-ç›®æ ‡-Target-ä½“ç³»ä¸ä¾èµ–æœºåˆ¶å…¨è§£"><a href="#âš™ï¸-ç¬¬-2-ç« -CMake-ç›®æ ‡-Target-ä½“ç³»ä¸ä¾èµ–æœºåˆ¶å…¨è§£" class="headerlink" title="âš™ï¸â€¯ç¬¬â€¯2â€¯ç« â€¯|â€¯CMakeâ€¯ç›®æ ‡â€¯(Target)â€¯ä½“ç³»ä¸ä¾èµ–æœºåˆ¶å…¨è§£"></a>âš™ï¸â€¯ç¬¬â€¯2â€¯ç« â€¯|â€¯CMakeâ€¯ç›®æ ‡â€¯(Target)â€¯ä½“ç³»ä¸ä¾èµ–æœºåˆ¶å…¨è§£</h1><hr>
<h2 id="2-1-Target-æ˜¯ä»€ä¹ˆ"><a href="#2-1-Target-æ˜¯ä»€ä¹ˆ" class="headerlink" title="2.1â€¯Targetâ€¯æ˜¯ä»€ä¹ˆ"></a>2.1â€¯Targetâ€¯æ˜¯ä»€ä¹ˆ</h2><p>åœ¨â€¯CMakeâ€¯é‡Œï¼Œ<strong>ç›®æ ‡(Target)</strong>â€¯æ˜¯ä¸€ç§ã€Œå¯æ„å»ºå®ä½“ã€ã€‚<br>æ¯ä¸€ä¸ªâ€¯<code>add_executable()</code>ã€<code>add_library()</code>â€¯è°ƒç”¨åï¼Œéƒ½ä¼šåœ¨å†…éƒ¨äº§ç”Ÿä¸€ä¸ªâ€¯Targetâ€¯å¯¹è±¡ï¼Œè®°å½•å®ƒçš„ï¼š</p>
<ul>
<li>æºæ–‡ä»¶é›†åˆ  </li>
<li>ç¼–è¯‘&#x2F;é“¾æ¥å‚æ•°  </li>
<li>å¯¼å‡ºåç§°  </li>
<li>å®‰è£…ä½ç½®  </li>
<li>ä¸å…¶ä»–â€¯Targetâ€¯çš„å…³ç³»</li>
</ul>
<p>è¿™äº›ç›®æ ‡è¢«ç¼–è¯‘å·¥å…·ï¼ˆNinja &#x2F; Makefile &#x2F; MSVC â€¦ï¼‰æ˜ å°„æˆçœŸå®çš„æ„å»ºå•å…ƒã€‚<br>æ‰€æœ‰ä¾èµ–å…³ç³»ã€å¤´æ–‡ä»¶è·¯å¾„ã€å®å®šä¹‰ï¼Œæœ€ç»ˆéƒ½ç»‘å®šåœ¨Targetâ€¯ä¸Šã€‚</p>
<hr>
<h3 id="2-1-1-åˆ›å»ºç›®æ ‡"><a href="#2-1-1-åˆ›å»ºç›®æ ‡" class="headerlink" title="2.1.1â€¯åˆ›å»ºç›®æ ‡"></a>2.1.1â€¯åˆ›å»ºç›®æ ‡</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br><span class="line"><span class="keyword">add_library</span>(core STATIC core.cpp)</span><br><span class="line"><span class="keyword">add_library</span>(net SHARED net.cpp)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å…³é”®å­—</th>
<th>è¯´æ˜</th>
<th>è¾“å‡ºå½¢å¼</th>
</tr>
</thead>
<tbody><tr>
<td><code>STATIC</code></td>
<td>é™æ€åº“</td>
<td>libcore.a &#x2F; core.lib</td>
</tr>
<tr>
<td><code>SHARED</code></td>
<td>åŠ¨æ€åº“</td>
<td>libnet.so &#x2F; net.dll</td>
</tr>
<tr>
<td><code>MODULE</code></td>
<td>æ’ä»¶æ¨¡å—åº“</td>
<td>ä»… <code>dlopen</code>&#x2F;<code>LoadLibrary</code> è°ƒç”¨åŠ è½½</td>
</tr>
<tr>
<td><em>(æ— ç±»å‹)</em></td>
<td>ç”±å˜é‡â€¯<code>BUILD_SHARED_LIBS</code>â€¯æ§åˆ¶</td>
<td></td>
</tr>
</tbody></table>
<blockquote>
<p>âš™ï¸â€¯<code>add_library(core core.cpp)</code>â€¯ä¼šåœ¨å˜é‡â€¯<code>BUILD_SHARED_LIBS</code>â€¯ä¸ºâ€¯ONâ€¯æ—¶è‡ªåŠ¨ç”Ÿæˆå…±äº«åº“ã€‚  </p>
</blockquote>
<hr>
<h3 id="2-1-2-ç›®æ ‡å‘½åä¸è·¯å¾„å±æ€§"><a href="#2-1-2-ç›®æ ‡å‘½åä¸è·¯å¾„å±æ€§" class="headerlink" title="2.1.2â€¯ç›®æ ‡å‘½åä¸è·¯å¾„å±æ€§"></a>2.1.2â€¯ç›®æ ‡å‘½åä¸è·¯å¾„å±æ€§</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set_target_properties</span>(core PROPERTIES</span><br><span class="line">  OUTPUT_NAME <span class="string">&quot;MyCore&quot;</span>            <span class="comment"># ç”Ÿæˆæ–‡ä»¶å</span></span><br><span class="line">  ARCHIVE_OUTPUT_DIRECTORY lib    <span class="comment"># é™æ€åº“è·¯å¾„</span></span><br><span class="line">  LIBRARY_OUTPUT_DIRECTORY lib    <span class="comment"># åŠ¨æ€åº“è·¯å¾„</span></span><br><span class="line">  RUNTIME_OUTPUT_DIRECTORY bin    <span class="comment"># å¯æ‰§è¡Œè¾“å‡ºè·¯å¾„</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>ğŸ“˜â€¯å±æ€§æ§åˆ¶å•ä¸ªç›®æ ‡çš„ç”Ÿæˆè¡Œä¸ºã€‚å¯éšæ—¶â€¯<code>get_target_property()</code>â€¯è¯»å–ã€‚</p>
<hr>
<h2 id="2-2-target-link-librariesï¼šå»ºç«‹ä¾èµ–å…³ç³»"><a href="#2-2-target-link-librariesï¼šå»ºç«‹ä¾èµ–å…³ç³»" class="headerlink" title="2.2â€¯target_link_librariesï¼šå»ºç«‹ä¾èµ–å…³ç³»"></a>2.2â€¯target_link_librariesï¼šå»ºç«‹ä¾èµ–å…³ç³»</h2><p>è¿™æ˜¯æœ€å¸¸ç”¨å‘½ä»¤ï¼Œç”¨äºå‘Šè¯‰â€¯CMakeâ€¯å¦‚ä½•æŠŠä¸€ä¸ªç›®æ ‡è¿æ¥åˆ°å¦ä¸€ä¸ªç›®æ ‡æˆ–ç³»ç»Ÿåº“ã€‚</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE core pthread)</span><br></pre></td></tr></table></figure>

<p><strong>å®Œæ•´è¯­æ³•ï¼š</strong></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_libraries</span>(&lt;<span class="keyword">target</span>&gt;</span><br><span class="line">  [PRIVATE|PUBLIC|INTERFACE] &lt;item&gt; [&lt;item&gt;...])</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å…³é”®å­—</th>
<th>è¯´æ˜</th>
<th>ä¼ æ’­æ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td>PRIVATE</td>
<td>ä»…å½“å‰ç›®æ ‡ç”Ÿæ•ˆ</td>
<td>ä¸ä¼ æ’­</td>
</tr>
<tr>
<td>PUBLIC</td>
<td>å½“å‰ç›®æ ‡åŠå…¶ä¾èµ–çš„ä¸‹æ¸¸ç›®æ ‡</td>
<td>ä¼ æ’­</td>
</tr>
<tr>
<td>INTERFACE</td>
<td>æœ¬ç›®æ ‡ä¸ä½¿ç”¨ï¼Œä½†ä¸‹æ¸¸ä½¿ç”¨</td>
<td>ä»…ä¼ æ’­</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(A a.cpp)</span><br><span class="line"><span class="keyword">add_library</span>(B b.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(B PUBLIC A)</span><br><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE B)</span><br><span class="line"><span class="comment"># app è‡ªåŠ¨è·å¾—å¯¹ A çš„é“¾æ¥ï¼šB å…¬å¸ƒäº† A ä½œä¸º PUBLIC ä¾èµ–</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="å¸¸è§åœºæ™¯ä¸¾ä¾‹"><a href="#å¸¸è§åœºæ™¯ä¸¾ä¾‹" class="headerlink" title="å¸¸è§åœºæ™¯ä¸¾ä¾‹"></a>å¸¸è§åœºæ™¯ä¸¾ä¾‹</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Header-only åº“</span></span><br><span class="line"><span class="keyword">add_library</span>(utils INTERFACE)</span><br><span class="line"><span class="keyword">target_include_directories</span>(utils INTERFACE <span class="keyword">include</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ™®é€šåº“åº”ç”¨</span></span><br><span class="line"><span class="keyword">add_library</span>(core src/core.cpp)</span><br><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE core utils)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-3-target-include-directoriesï¼šå¤´æ–‡ä»¶è·¯å¾„"><a href="#2-3-target-include-directoriesï¼šå¤´æ–‡ä»¶è·¯å¾„" class="headerlink" title="2.3â€¯target_include_directoriesï¼šå¤´æ–‡ä»¶è·¯å¾„"></a>2.3â€¯target_include_directoriesï¼šå¤´æ–‡ä»¶è·¯å¾„</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_include_directories</span>(core</span><br><span class="line">  PUBLIC <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span>)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>ä¿®é¥°ç¬¦</th>
<th>ä½œç”¨èŒƒå›´</th>
</tr>
</thead>
<tbody><tr>
<td>PRIVATE</td>
<td>æœ¬ç›®æ ‡å¯è§</td>
</tr>
<tr>
<td>INTERFACE</td>
<td>ä»…ä¾èµ–è€…å¯è§</td>
</tr>
<tr>
<td>PUBLIC</td>
<td>ä¸¤è€…éƒ½å¯è§</td>
</tr>
</tbody></table>
<p>ğŸ“˜â€¯æ¨èåšæ³•ï¼šæ¯ä¸ªåº“åœ¨è‡ªå·±çš„â€¯CMakeListsâ€¯é‡Œé€šè¿‡â€¯target_include_directoriesâ€¯å…¬å¸ƒè·¯å¾„ï¼Œè€Œä¸æ˜¯å…¨å±€â€¯include_directories()ã€‚  </p>
<hr>
<h2 id="2-4-target-compile-definitionsï¼šç¼–è¯‘å®"><a href="#2-4-target-compile-definitionsï¼šç¼–è¯‘å®" class="headerlink" title="2.4â€¯target_compile_definitionsï¼šç¼–è¯‘å®"></a>2.4â€¯target_compile_definitionsï¼šç¼–è¯‘å®</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_compile_definitions</span>(core</span><br><span class="line">  PRIVATE CORE_EXPORTS</span><br><span class="line">  PUBLIC CORE_API_LEVEL=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äºç¼–è¯‘å‘½ä»¤ä¸­å¢åŠ â€¯<code>-DCORE_EXPORTS</code>â€¯&#x2F;â€¯<code>-DCORE_API_LEVEL=2</code>ã€‚<br>ä½¿ç”¨ä¿®é¥°ç¬¦æ§åˆ¶ä¼ æ’­èŒƒå›´ã€‚</p>
<hr>
<h2 id="2-5-target-compile-optionsï¼šæ·»åŠ ç¼–è¯‘å™¨æ ‡å¿—"><a href="#2-5-target-compile-optionsï¼šæ·»åŠ ç¼–è¯‘å™¨æ ‡å¿—" class="headerlink" title="2.5â€¯target_compile_optionsï¼šæ·»åŠ ç¼–è¯‘å™¨æ ‡å¿—"></a>2.5â€¯target_compile_optionsï¼šæ·»åŠ ç¼–è¯‘å™¨æ ‡å¿—</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_compile_options</span>(core PRIVATEWall -Wextra)</span><br><span class="line"><span class="keyword">target_compile_options</span>(app PUBLIC -O2)</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯ä¸ºä¸åŒç›®æ ‡å®šä¹‰ä¸åŒç¼–è¯‘å‚æ•°ï¼›  </li>
<li>æ”¯æŒâ€¯PRIVATE &#x2F; PUBLICâ€¯åŒæ ·ä¿®é¥°è¯ã€‚</li>
</ul>
<hr>
<h2 id="2-6-ç›®æ ‡å±æ€§-ä¸-get-set"><a href="#2-6-ç›®æ ‡å±æ€§-ä¸-get-set" class="headerlink" title="2.6â€¯ç›®æ ‡å±æ€§â€¯ä¸â€¯get&#x2F;set"></a>2.6â€¯ç›®æ ‡å±æ€§â€¯ä¸â€¯get&#x2F;set</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set_target_properties</span>(app PROPERTIES CXX_STANDARD <span class="number">17</span>)</span><br><span class="line"><span class="keyword">get_target_property</span>(standard app CXX_STANDARD)</span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;C++ standard for app = $&#123;standard&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å¸¸ç”¨å±æ€§ï¼š</p>
<table>
<thead>
<tr>
<th>å±æ€§å</th>
<th>åŠŸèƒ½</th>
<th>å–å€¼</th>
</tr>
</thead>
<tbody><tr>
<td>CXX_STANDARD</td>
<td>++â€¯æ ‡å‡†ç‰ˆæœ¬</td>
<td>11â€¯&#x2F;â€¯14â€¯&#x2F;â€¯17â€¯&#x2F;â€¯20â€¯â€¦</td>
</tr>
<tr>
<td>POSITION_INDEPENDENT_CODE</td>
<td>æ§åˆ¶â€¯fPIC</td>
<td>ONâ€¯&#x2F;â€¯OFF</td>
</tr>
<tr>
<td>LINKER_LANGUAGE</td>
<td>æŒ‡å®šé“¾æ¥è¯­è¨€</td>
<td>Câ€¯&#x2F;â€¯CXX</td>
</tr>
<tr>
<td>OUTPUT_NAME</td>
<td>è¾“å‡ºå</td>
<td>ä¾‹å¦‚â€¯MyApp</td>
</tr>
</tbody></table>
<hr>
<h2 id="2-7-å¯¼å…¥ä¸æ¥å£ç›®æ ‡"><a href="#2-7-å¯¼å…¥ä¸æ¥å£ç›®æ ‡" class="headerlink" title="2.7â€¯å¯¼å…¥ä¸æ¥å£ç›®æ ‡"></a>2.7â€¯å¯¼å…¥ä¸æ¥å£ç›®æ ‡</h2><h3 id="2-7-1-IMPORTED"><a href="#2-7-1-IMPORTED" class="headerlink" title="2.7.1â€¯IMPORTED"></a>2.7.1â€¯IMPORTED</h3><p>ä»£è¡¨å¤–éƒ¨å·²å­˜åœ¨çš„åº“ï¼Œä¸å‚ä¸æ„å»ºï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(MyExternal UNKNOWN IMPORTED)</span><br><span class="line"><span class="keyword">set_target_properties</span>(MyExternal PROPERTIES</span><br><span class="line">  IMPORTED_LOCATION /usr/lib/libext.so</span><br><span class="line">  INTERFACE_INCLUDE_DIRECTORIES /usr/<span class="keyword">include</span>/ext)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE MyExternal)</span><br></pre></td></tr></table></figure>

<h3 id="2-7-2-INTERFACE"><a href="#2-7-2-INTERFACE" class="headerlink" title="2.7.2â€¯INTERFACE"></a>2.7.2â€¯INTERFACE</h3><p>Headerâ€‘onlyâ€¯æˆ–çº¯æ¥å£ç›®æ ‡ï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(header_only INTERFACE)</span><br><span class="line"><span class="keyword">target_include_directories</span>(header_only INTERFACE <span class="keyword">include</span>)</span><br></pre></td></tr></table></figure>

<p>ä¸ä¼šç¼–è¯‘ï¼Œåªæœ‰æ¥å£å±æ€§ã€‚</p>
<hr>
<h2 id="2-8-å‘½åç©ºé—´-NAMESPACE"><a href="#2-8-å‘½åç©ºé—´-NAMESPACE" class="headerlink" title="2.8â€¯å‘½åç©ºé—´â€¯(NAMESPACE)"></a>2.8â€¯å‘½åç©ºé—´â€¯(NAMESPACE)</h2><p>CMakeâ€¯å»ºè®®ä¸ºå¯¼å‡ºçš„ target ä½¿ç”¨ã€Œå‘½åç©ºé—´::åç§°ã€æ ¼å¼ã€‚<br>ä¾‹å¦‚â€¯<code>find_package(OpenCV)</code>â€¯åå¯ä½¿ç”¨ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE OpenCV::core)</span><br></pre></td></tr></table></figure>

<p>å½“ä½ è‡ªå·±çš„é¡¹ç›®å¯¼å‡ºæ—¶ï¼ŒåŒæ ·å¯å®šä¹‰ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> MyProjTargets</span><br><span class="line">  NAMESPACE MyProj::</span><br><span class="line">  DESTINATION lib/cmake/MyProj)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ–¹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(MyProj)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE MyProj::core)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-9-å¸¸è§é”™è¯¯ä¸æ’æŸ¥"><a href="#2-9-å¸¸è§é”™è¯¯ä¸æ’æŸ¥" class="headerlink" title="2.9â€¯å¸¸è§é”™è¯¯ä¸æ’æŸ¥"></a>2.9â€¯å¸¸è§é”™è¯¯ä¸æ’æŸ¥</h2><table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>ç°è±¡</th>
<th>è§£å†³</th>
</tr>
</thead>
<tbody><tr>
<td>æœªæ‰¾åˆ°æŸåº“</td>
<td>é“¾æ¥é˜¶æ®µâ€¯undefinedâ€¯reference</td>
<td>ç¡®è®¤â€¯target_link_librariesâ€¯é¡ºåºä¸ä¿®é¥°ç¬¦</td>
</tr>
<tr>
<td>includeâ€¯æ— æ•ˆ</td>
<td>ç¼–è¯‘æ—¶æŠ¥å¤´æ‰¾ä¸åˆ°</td>
<td>æ£€æŸ¥â€¯target_include_directoriesâ€¯ä¿®é¥°ç¬¦</td>
</tr>
<tr>
<td>å±æ€§æœªç”Ÿæ•ˆ</td>
<td>è¯­æ³•æ­£ç¡®ä½†ä¸æ‰§è¡Œ</td>
<td>çŠ¶æ€æ˜¯å¦è®¾ç½®åˆ°æ­£ç¡®ç›®æ ‡</td>
</tr>
<tr>
<td>æ— æ³•å¯¼å‡ºâ€¯INTERFACEâ€¯ç›®æ ‡</td>
<td>é”™è¯¯æç¤ºâ€¯â€œtarget not builtâ€</td>
<td>åŠ ä¸Šâ€¯EXPORTâ€¯å’Œâ€¯install(EXPORTâ€¯â€¦)â€¯ä¸€èµ·ä½¿ç”¨</td>
</tr>
</tbody></table>
<hr>
<h2 id="2-10-ç« èŠ‚å°ç»“"><a href="#2-10-ç« èŠ‚å°ç»“" class="headerlink" title="2.10â€¯ç« èŠ‚å°ç»“"></a>2.10â€¯ç« èŠ‚å°ç»“</h2><blockquote>
<p>ä¸€åˆ‡ç¼–è¯‘ä¸é“¾æ¥ä¿¡æ¯éƒ½ç»‘å®šåœ¨â€¯Targetâ€¯å¯¹è±¡ä¸Šã€‚  </p>
</blockquote>
<p><strong>æ„å»ºä¾èµ–é“¾ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add_library(A)</span><br><span class="line">add_library(B)</span><br><span class="line">target_link_libraries(B PUBLIC A)</span><br><span class="line">add_executable(app)</span><br><span class="line">target_link_libraries(app PRIVATE B)</span><br></pre></td></tr></table></figure>
<p>ğŸ”â€¯CMakeâ€¯è‡ªåŠ¨æ¨å¯¼â€¯appâ€¯â†’â€¯Bâ€¯â†’â€¯Aâ€¯å®Œæ•´ä¾èµ–ï¼›<br>å¤´æ–‡ä»¶è·¯å¾„ä¸å®å®šä¹‰æŒ‰â€¯PUBLIC&#x2F;INTERFACEâ€¯ä¼ æ’­ã€‚</p>
<hr>
<p>ğŸŸ¢â€¯ç¬¬â€¯2â€¯ç« è®²å®Œï¼Œç°åœ¨ä½ æ‹¥æœ‰ï¼š</p>
<ul>
<li>å®Œæ•´â€¯Targetâ€¯å®šä¹‰æ–¹å¼  </li>
<li>é“¾æ¥ä¾èµ–çš„ä¸‰å±‚ä¿®é¥°ç¬¦è¯­ä¹‰  </li>
<li>includeâ€¯&#x2F;â€¯compileâ€¯&#x2F;â€¯macroâ€¯å±æ€§ç»‘å®š  </li>
<li>å¯¼å…¥ç›®æ ‡ä¸å‘½åç©ºé—´ç†è§£</li>
</ul>
<hr>
<hr>
<h1 id="ğŸ§©-ç¬¬-3-ç« -install-ä¸-export-æœºåˆ¶è¯¦è§£"><a href="#ğŸ§©-ç¬¬-3-ç« -install-ä¸-export-æœºåˆ¶è¯¦è§£" class="headerlink" title="ğŸ§© ç¬¬â€¯3â€¯ç« â€¯|â€¯install()â€¯ä¸â€¯export()â€¯æœºåˆ¶è¯¦è§£"></a>ğŸ§© ç¬¬â€¯3â€¯ç« â€¯|â€¯install()â€¯ä¸â€¯export()â€¯æœºåˆ¶è¯¦è§£</h1><hr>
<h2 id="3-1-ä¸ºä»€ä¹ˆè¦-install"><a href="#3-1-ä¸ºä»€ä¹ˆè¦-install" class="headerlink" title="3.1â€¯ä¸ºä»€ä¹ˆè¦â€¯install()"></a>3.1â€¯ä¸ºä»€ä¹ˆè¦â€¯install()</h2><blockquote>
<p>æ„å»ºå™¨äº§ç‰© (å¯æ‰§è¡Œæ–‡ä»¶ã€é™æ€&#x2F;åŠ¨æ€åº“ã€å¤´æ–‡ä»¶ç­‰) ä¸€èˆ¬ä¼šåˆ†å‘ç»™å…¶ä»–é¡¹ç›®æˆ–ç”¨æˆ·ä½¿ç”¨ï¼Œ<br>CMakeâ€¯çš„â€¯<code>install()</code>â€¯ç”¨äºå®šä¹‰â€œå“ªäº›æ–‡ä»¶ã€æ”¾åˆ°å“ªé‡Œã€è£…æˆä»€ä¹ˆç»“æ„â€ã€‚</p>
</blockquote>
<hr>
<h2 id="3-2-åŸºæœ¬è¯­æ³•åˆ†ç±»"><a href="#3-2-åŸºæœ¬è¯­æ³•åˆ†ç±»" class="headerlink" title="3.2â€¯åŸºæœ¬è¯­æ³•åˆ†ç±»"></a>3.2â€¯åŸºæœ¬è¯­æ³•åˆ†ç±»</h2><ol>
<li><strong>å®‰è£…ç›®æ ‡</strong><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(TARGETS &lt;targets&gt; [<span class="keyword">EXPORT</span> &lt;<span class="keyword">export</span>-<span class="keyword">set</span>&gt;]</span><br><span class="line">        [RUNTIME DESTINATION &lt;dir&gt;]</span><br><span class="line">        [LIBRARY DESTINATION &lt;dir&gt;]</span><br><span class="line">        [ARCHIVE DESTINATION &lt;dir&gt;]</span><br><span class="line">        [PUBLIC_HEADER DESTINATION &lt;dir&gt;]</span><br><span class="line">        [INCLUDES DESTINATION &lt;dir&gt;])</span><br></pre></td></tr></table></figure></li>
<li><strong>å®‰è£…æ™®é€šæ–‡ä»¶</strong><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(FILES &lt;files&gt; DESTINATION &lt;dir&gt;)</span><br></pre></td></tr></table></figure></li>
<li><strong>å®‰è£…æ•´ä¸ªç›®å½•</strong><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(DIRECTORY &lt;path&gt; DESTINATION &lt;dir&gt; [FILES_MATCHING PATTERN <span class="string">&quot;*.h&quot;</span>])</span><br></pre></td></tr></table></figure></li>
<li><strong>å®‰è£…å¯¼å‡ºæ¸…å•ï¼ˆç”Ÿæˆ Config åŒ…ï¼‰</strong><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> &lt;<span class="keyword">export</span>-<span class="keyword">set</span>&gt;</span><br><span class="line">        <span class="keyword">FILE</span> &lt;config.cmake&gt;</span><br><span class="line">        NAMESPACE &lt;ns&gt;::</span><br><span class="line">        DESTINATION &lt;path&gt;)</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="3-3-ä¸»è¦å‚æ•°è¯´æ˜"><a href="#3-3-ä¸»è¦å‚æ•°è¯´æ˜" class="headerlink" title="3.3â€¯ä¸»è¦å‚æ•°è¯´æ˜"></a>3.3â€¯ä¸»è¦å‚æ•°è¯´æ˜</h2><table>
<thead>
<tr>
<th>å­å…³é”®å­—</th>
<th>è¯´æ˜</th>
<th>å…¸å‹å†…å®¹</th>
</tr>
</thead>
<tbody><tr>
<td><strong>RUNTIME</strong></td>
<td>å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºè·¯å¾„</td>
<td><code>$&#123;CMAKE_INSTALL_BINDIR&#125;</code> (<code>bin</code>)</td>
</tr>
<tr>
<td><strong>LIBRARY</strong></td>
<td>åŠ¨æ€åº“(<code>.so/.dll</code>)è·¯å¾„</td>
<td><code>$&#123;CMAKE_INSTALL_LIBDIR&#125;</code></td>
</tr>
<tr>
<td><strong>ARCHIVE</strong></td>
<td>é™æ€åº“(<code>.a/.lib</code>)è·¯å¾„</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td><strong>PUBLIC_HEADER</strong></td>
<td>å…¬å…±å¤´æ–‡ä»¶å®‰è£…ç›®å½•</td>
<td><code>$&#123;CMAKE_INSTALL_INCLUDEDIR&#125;</code></td>
</tr>
<tr>
<td><strong>INCLUDES</strong></td>
<td>å¤´æ–‡ä»¶åŒ…å«ç›®å½•æç¤º</td>
<td>ä¾›â€¯<code>EXPORT</code>â€¯ç”Ÿæˆä¿¡æ¯ä½¿ç”¨</td>
</tr>
</tbody></table>
<p>ğŸ§ â€¯æç¤ºï¼š<br><code>include(GNUInstallDirs)</code>â€¯å¯è·å¾—æ ‡å‡†ç›®å½•å˜é‡ï¼Œå¦‚â€¯<code>CMAKE_INSTALL_BINDIR</code>ã€<code>LIBDIR</code>ã€<code>INCLUDEDIR</code>â€¯ç­‰ï¼Œä¾¿äºè·¨å¹³å°ç»Ÿä¸€ã€‚</p>
<hr>
<h2 id="3-4-ç¤ºä¾‹ï¼šå®‰è£…åº“ä¸å¯æ‰§è¡Œæ–‡ä»¶"><a href="#3-4-ç¤ºä¾‹ï¼šå®‰è£…åº“ä¸å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="3.4â€¯ç¤ºä¾‹ï¼šå®‰è£…åº“ä¸å¯æ‰§è¡Œæ–‡ä»¶"></a>3.4â€¯ç¤ºä¾‹ï¼šå®‰è£…åº“ä¸å¯æ‰§è¡Œæ–‡ä»¶</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(GNUInstallDirs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span>(core SHARED core.cpp)</span><br><span class="line"><span class="keyword">target_include_directories</span>(core PUBLIC <span class="keyword">include</span>)</span><br><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE core)</span><br><span class="line"></span><br><span class="line"><span class="keyword">install</span>(TARGETS core app</span><br><span class="line">  RUNTIME DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_BINDIR&#125;</span></span><br><span class="line">  LIBRARY DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_LIBDIR&#125;</span></span><br><span class="line">  ARCHIVE DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_LIBDIR&#125;</span></span><br><span class="line">  PUBLIC_HEADER DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_INCLUDEDIR&#125;</span>/core)</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake --install build --prefix ./install</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">install/</span><br><span class="line">â”œâ”€ bin/app</span><br><span class="line">â”œâ”€ lib/libcore.so</span><br><span class="line">â””â”€ include/core/core.h</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-5-install-EXPORT-ç”Ÿæˆ-Config-åŒ…"><a href="#3-5-install-EXPORT-ç”Ÿæˆ-Config-åŒ…" class="headerlink" title="3.5â€¯install(EXPORT)â€¯ç”Ÿæˆâ€¯Configâ€¯åŒ…"></a>3.5â€¯install(EXPORT)â€¯ç”Ÿæˆâ€¯Configâ€¯åŒ…</h2><p>è®©åˆ«çš„é¡¹ç›®å¯ä»¥ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(MyProj REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(other PRIVATE MyProj::core)</span><br></pre></td></tr></table></figure>

<p>å°±å¿…é¡»å¯¼å‡ºè‡ªèº«çš„ç›®æ ‡æè¿°æ–‡ä»¶ã€‚</p>
<h3 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h3><p>1ï¸âƒ£ æ³¨å†Œå¯¼å‡ºæ¸…å•åï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(TARGETS core <span class="keyword">EXPORT</span> MyProjTargets</span><br><span class="line">        LIBRARY DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_LIBDIR&#125;</span></span><br><span class="line">        PUBLIC_HEADER DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_INCLUDEDIR&#125;</span>/core)</span><br></pre></td></tr></table></figure>
<p>2ï¸âƒ£ å†™å‡ºæ¸…å•åˆ°â€¯cmake&#x2F;â€¯ç›®å½•ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> MyProjTargets</span><br><span class="line">        <span class="keyword">FILE</span> MyProjTargets.cmake</span><br><span class="line">        NAMESPACE MyProj::</span><br><span class="line">        DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_LIBDIR&#125;</span>/cmake/MyProj)</span><br></pre></td></tr></table></figure>
<p>3ï¸âƒ£ ç”Ÿæˆé¡¶å±‚â€¯Configâ€¯æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">configure_file</span>(MyProjConfig.cmake.in</span><br><span class="line">               <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjConfig.cmake&quot;</span> @ONLY)</span><br><span class="line"><span class="keyword">install</span>(FILES <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjConfig.cmake&quot;</span></span><br><span class="line">        DESTINATION <span class="variable">$&#123;CMAKE_INSTALL_LIBDIR&#125;</span>/cmake/MyProj)</span><br></pre></td></tr></table></figure>

<p>ä¹‹åï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake --install build --prefix ./package</span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªå·¥ç¨‹ä¸­ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(MyProj_DIR <span class="string">&quot;/path/to/package/lib/cmake/MyProj&quot;</span>)</span><br><span class="line"><span class="keyword">find_package</span>(MyProj)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(userApp PRIVATE MyProj::core)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-6-å¯¼å‡ºæ¸…å•ä¸å‘½åç©ºé—´ï¼ˆNAMESPACEï¼‰"><a href="#3-6-å¯¼å‡ºæ¸…å•ä¸å‘½åç©ºé—´ï¼ˆNAMESPACEï¼‰" class="headerlink" title="3.6â€¯å¯¼å‡ºæ¸…å•ä¸å‘½åç©ºé—´ï¼ˆNAMESPACEï¼‰"></a>3.6â€¯å¯¼å‡ºæ¸…å•ä¸å‘½åç©ºé—´ï¼ˆNAMESPACEï¼‰</h2><ul>
<li><code>EXPORT &lt;name&gt;</code>â€¯åªæ˜¯ä¸€ä¸ªæ”¶é›†å™¨æ¸…å•ã€‚  </li>
<li><code>NAMESPACE</code>â€¯å®šä¹‰å¯¼å…¥ç›®æ ‡å‰ç¼€ï¼Œç”¨äºé˜²æ­¢å‘½åå†²çªã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> MathKitTargets</span><br><span class="line">        <span class="keyword">FILE</span> MathKitConfig.cmake</span><br><span class="line">        NAMESPACE MathKit::</span><br><span class="line">        DESTINATION lib/cmake/MathKit)</span><br></pre></td></tr></table></figure>

<p>æ¶ˆè´¹è€…å·¥ç¨‹å³å¯å®‰å…¨è°ƒç”¨ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE MathKit::algebra)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-7-install-FILES-DIRECTORY-å¸¸è§„ç”¨é€”"><a href="#3-7-install-FILES-DIRECTORY-å¸¸è§„ç”¨é€”" class="headerlink" title="3.7â€¯install(FILES | DIRECTORY)â€¯å¸¸è§„ç”¨é€”"></a>3.7â€¯install(FILES | DIRECTORY)â€¯å¸¸è§„ç”¨é€”</h2><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>ç”¨é€”</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>FILES</td>
<td>å®‰è£…è‹¥å¹²æ–‡ä»¶</td>
<td><code>install(FILES config.toml DESTINATION etc)</code></td>
</tr>
<tr>
<td>DIRECTORY</td>
<td>æ‹·è´æ•´ä¸ªç›®å½•</td>
<td><code>install(DIRECTORY shaders DESTINATION share)</code></td>
</tr>
<tr>
<td>DIRECTORYâ€¯+â€¯è¿‡æ»¤</td>
<td>ä»…åŒ¹é…ç‰¹å®šæ–‡ä»¶</td>
<td><code>install(DIRECTORY include/ DESTINATION include FILES_MATCHING PATTERN &quot;*.h&quot;)</code></td>
</tr>
</tbody></table>
<hr>
<h2 id="3-8-é…ç½®æ–‡ä»¶æ¨¡æ¿-configure-file"><a href="#3-8-é…ç½®æ–‡ä»¶æ¨¡æ¿-configure-file" class="headerlink" title="3.8â€¯é…ç½®æ–‡ä»¶æ¨¡æ¿â€¯configure_file()"></a>3.8â€¯é…ç½®æ–‡ä»¶æ¨¡æ¿â€¯configure_file()</h2><p>åœ¨â€¯installâ€¯ç”Ÿæˆâ€¯Configâ€¯è¿‡ç¨‹ä¸­å¸¸éœ€è¦å†™å…¥è·¯å¾„ä¿¡æ¯ã€‚  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">configure_file</span>(</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;/cmake/MyProjConfig.cmake.in&quot;</span></span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/MyProjConfig.cmake&quot;</span></span><br><span class="line">  @ONLY)</span><br></pre></td></tr></table></figure>

<p><strong>æ¨¡æ¿å†…å®¹ç¤ºæ„ï¼š</strong></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MyProjConfig.cmake.in</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;$&#123;CMAKE_CURRENT_LIST_DIR&#125;/MyProjTargets.cmake&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(MyProj_VERSION <span class="string">&quot;@PROJECT_VERSION@&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­â€¯<code>@PROJECT_VERSION@</code>â€¯ç­‰å ä½ç¬¦ä¼šè¢«æ›¿æ¢ã€‚</p>
<hr>
<h2 id="3-9-å¸¸è§-install-å˜é‡"><a href="#3-9-å¸¸è§-install-å˜é‡" class="headerlink" title="3.9â€¯å¸¸è§ install å˜é‡"></a>3.9â€¯å¸¸è§ install å˜é‡</h2><table>
<thead>
<tr>
<th>å˜é‡</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>CMAKE_INSTALL_PREFIX</code></td>
<td>å®‰è£…æ ¹è·¯å¾„</td>
</tr>
<tr>
<td><code>CMAKE_INSTALL_BINDIR</code></td>
<td>é»˜è®¤ <code>bin</code></td>
</tr>
<tr>
<td><code>CMAKE_INSTALL_LIBDIR</code></td>
<td>é»˜è®¤ <code>lib</code> &#x2F; <code>lib64</code></td>
</tr>
<tr>
<td><code>CMAKE_INSTALL_INCLUDEDIR</code></td>
<td>é»˜è®¤ <code>include</code></td>
</tr>
<tr>
<td><code>CMAKE_INSTALL_DATADIR</code></td>
<td><code>share</code></td>
</tr>
<tr>
<td><code>CMAKE_INSTALL_SYSCONFDIR</code></td>
<td><code>etc</code></td>
</tr>
</tbody></table>
<p>å‘½ä»¤è¡Œè¦†å†™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake --install build --prefix /opt/MyProj</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-10-å¸¸è§é—®é¢˜-Q-A"><a href="#3-10-å¸¸è§é—®é¢˜-Q-A" class="headerlink" title="3.10â€¯å¸¸è§é—®é¢˜â€¯Q&amp;A"></a>3.10â€¯å¸¸è§é—®é¢˜â€¯Q&amp;A</h2><table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>åŸå› </th>
<th>è§£å†³</th>
</tr>
</thead>
<tbody><tr>
<td>å®‰è£…è·¯å¾„ä¸å¯¹</td>
<td>å¿˜è®°åŒ…å«â€¯GNUInstallDirs</td>
<td><code>include(GNUInstallDirs)</code></td>
</tr>
<tr>
<td>find_packageâ€¯æ‰¾ä¸åˆ°</td>
<td>æœªç”Ÿæˆâ€¯Config.cmake</td>
<td>è¯·åŠ â€¯install(EXPORTâ€¦)</td>
</tr>
<tr>
<td>Headerâ€¯æœªéšåº“å®‰è£…</td>
<td>æœªæŒ‡å®šâ€¯PUBLIC_HEADER&#x2F;FILESâ€¯æˆ–è·¯å¾„é”™è¯¯</td>
<td>ç¡®è®¤â€¯ç›®æ ‡â€¯PUBLIC_HEADERâ€¯æˆ–æ˜¾å¼â€¯install(FILES)</td>
</tr>
<tr>
<td>namespaceâ€¯å¤±æ•ˆ</td>
<td>æ²¡åœ¨â€¯install(EXPORT)â€¯é‡Œå£°æ˜â€¯NAMESPACE</td>
<td>è¡¥åŠ â€¯NAMESPACEâ€¯MyProj::</td>
</tr>
</tbody></table>
<hr>
<h2 id="3-11-ç« èŠ‚å°ç»“"><a href="#3-11-ç« èŠ‚å°ç»“" class="headerlink" title="3.11â€¯ç« èŠ‚å°ç»“"></a>3.11â€¯ç« èŠ‚å°ç»“</h2><p>âœ…â€¯æœ¬ç« ä½ åº”æŒæ¡ï¼š</p>
<ul>
<li>installâ€¯ä¸‰å¤§ç”¨æ³•:â€¯(TARGETS &#x2F; FILES &#x2F; DIRECTORY)  </li>
<li>exportâ€¯å¯¼å‡ºæœºåˆ¶â€¯+â€¯ç”Ÿæˆâ€¯Configâ€¯åŒ…æ­¥éª¤  </li>
<li>GNUInstallDirsâ€¯æ ‡å‡†è·¯å¾„é›†åˆ  </li>
<li>namespaceâ€¯çš„æ„ä¹‰ä¸ä½¿ç”¨  </li>
<li>å¸¸è§é”™è¯¯å®šä½</li>
</ul>
<hr>
<hr>
<h1 id="ğŸ”-ç¬¬-4-ç« -find-package-ä¸-CMake-åŒ…ï¼ˆPackageï¼‰æœºåˆ¶å®æˆ˜"><a href="#ğŸ”-ç¬¬-4-ç« -find-package-ä¸-CMake-åŒ…ï¼ˆPackageï¼‰æœºåˆ¶å®æˆ˜" class="headerlink" title="ğŸ” ç¬¬â€¯4â€¯ç« â€¯|â€¯find_package()â€¯ä¸â€¯CMakeâ€¯åŒ…ï¼ˆPackageï¼‰æœºåˆ¶å®æˆ˜"></a>ğŸ” ç¬¬â€¯4â€¯ç« â€¯|â€¯find_package()â€¯ä¸â€¯CMakeâ€¯åŒ…ï¼ˆPackageï¼‰æœºåˆ¶å®æˆ˜</h1><hr>
<h2 id="4-1-find-package-çš„ä½¿å‘½"><a href="#4-1-find-package-çš„ä½¿å‘½" class="headerlink" title="4.1â€¯find_packageâ€¯çš„ä½¿å‘½"></a>4.1â€¯find_packageâ€¯çš„ä½¿å‘½</h2><blockquote>
<p>CMakeâ€¯å…è®¸ä½ å¤ç”¨å¤–éƒ¨åº“ï¼Œä½†å®ƒå¿…é¡»<strong>çŸ¥é“æ€ä¹ˆæ‰¾åˆ°è¿™äº›åº“</strong>ã€‚<br><code>find_package()</code>â€¯å°±æ˜¯è¿æ¥é¡¹ç›®ä¾èµ–ä¸å®é™…è·¯å¾„çš„æ¡¥æ¢ã€‚  </p>
</blockquote>
<p>å®ƒä¼šå»ç³»ç»Ÿè·¯å¾„åŠç”¨æˆ·æŒ‡å®šè·¯å¾„æœç´¢åŒ¹é…çš„æè¿°æ–‡ä»¶æ¥å®šä½å¹¶å¯¼å…¥åº“çš„ Targetsã€‚  </p>
<hr>
<h2 id="4-2-ä¸¤ç§åŒ…æ¨¡å¼"><a href="#4-2-ä¸¤ç§åŒ…æ¨¡å¼" class="headerlink" title="4.2â€¯ä¸¤ç§åŒ…æ¨¡å¼"></a>4.2â€¯ä¸¤ç§åŒ…æ¨¡å¼</h2><table>
<thead>
<tr>
<th>æ¨¡å¼</th>
<th>æ–‡ä»¶ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Config æ¨¡å¼</strong></td>
<td><code>&lt;Name&gt;Config.cmake</code>â€¯&#x2F; <code>&lt;Name&gt;-config.cmake</code></td>
<td>æ¨èã€ç°ä»£é¡¹ç›®ï¼ˆä½¿ç”¨â€¯targetï¼‰å¯¼å‡ºä½¿ç”¨</td>
</tr>
<tr>
<td><strong>Module æ¨¡å¼</strong></td>
<td><code>Find&lt;Name&gt;.cmake</code></td>
<td>ä¼ ç»Ÿæ‰‹å†™æœç´¢è„šæœ¬</td>
</tr>
</tbody></table>
<p><code>find_package(MyProj)</code>â€¯ä¾æ¬¡å°è¯•ï¼š<br>1ï¸âƒ£â€¯åœ¨è·¯å¾„ä¸­æŸ¥æ‰¾â€¯<code>MyProjConfig.cmake</code>â€¯æˆ–â€¯<code>MyProj-config.cmake</code>;<br>2ï¸âƒ£â€¯è‹¥æ‰¾ä¸åˆ°ï¼Œå†æŸ¥æ˜¯å¦æœ‰â€¯<code>FindMyProj.cmake</code>â€¯æ¨¡å—ã€‚  </p>
<hr>
<h2 id="4-3-Config-æ¨¡å¼å·¥ä½œåŸç†"><a href="#4-3-Config-æ¨¡å¼å·¥ä½œåŸç†" class="headerlink" title="4.3â€¯Config æ¨¡å¼å·¥ä½œåŸç†"></a>4.3â€¯Config æ¨¡å¼å·¥ä½œåŸç†</h2><p>å½“æˆ‘ä»¬ä¸Šä¸€ç« é€šè¿‡  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> MyProjTargets</span><br><span class="line">        <span class="keyword">FILE</span> MyProjTargets.cmake</span><br><span class="line">        NAMESPACE MyProj::</span><br><span class="line">        DESTINATION lib/cmake/MyProj)</span><br><span class="line"><span class="keyword">install</span>(FILES MyProjConfig.cmake DESTINATION lib/cmake/MyProj)</span><br><span class="line">```  </span><br><span class="line">ç”Ÿæˆè¿™äº›æ–‡ä»¶åï¼Œ  </span><br><span class="line">å¤–éƒ¨é¡¹ç›®è°ƒç”¨ï¼š</span><br><span class="line"></span><br><span class="line">```cmake</span><br><span class="line"><span class="keyword">find_package</span>(MyProj REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE MyProj::core)</span><br></pre></td></tr></table></figure>

<p>CMake æŸ¥æ‰¾é¡ºåºï¼ˆç®€ç•¥ï¼‰ï¼š</p>
<ol>
<li>å˜é‡â€¯<code>MyProj_DIR</code>â€¯æŒ‡å®šçš„ç›®å½•  </li>
<li>ç³»ç»Ÿè·¯å¾„ <code>/usr/lib/cmake/MyProj</code>â€¯ç­‰  </li>
<li>ç”¨æˆ·è‡ªå®šä¹‰åŒ…æ³¨å†Œè·¯å¾„</li>
</ol>
<p>æ‰¾åˆ°â€¯<code>MyProjConfig.cmake</code>â€¯åï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œâ€¯<code>include(MyProjTargets.cmake)</code>â€¯ï¼Œä»è€Œå¯¼å…¥â€¯MyProj::coreã€‚  </p>
<hr>
<h3 id="4-3-1-Config-æ–‡ä»¶æ¨¡æ¿å¿«é€Ÿç¤ºä¾‹"><a href="#4-3-1-Config-æ–‡ä»¶æ¨¡æ¿å¿«é€Ÿç¤ºä¾‹" class="headerlink" title="4.3.1â€¯Config æ–‡ä»¶æ¨¡æ¿å¿«é€Ÿç¤ºä¾‹"></a>4.3.1â€¯Config æ–‡ä»¶æ¨¡æ¿å¿«é€Ÿç¤ºä¾‹</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MyProjConfig.cmake.in</span></span><br><span class="line">@PACKAGE_INIT@</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;$&#123;CMAKE_CURRENT_LIST_DIR&#125;/MyProjTargets.cmake&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(MyProj_VERSION <span class="string">&quot;@PROJECT_VERSION@&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">configure_package_config_file(</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/MyProjConfig.cmake.in&quot;</span></span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjConfig.cmake&quot;</span></span><br><span class="line">  INSTALL_DESTINATION lib/cmake/MyProj)</span><br><span class="line"><span class="keyword">install</span>(FILES <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjConfig.cmake&quot;</span></span><br><span class="line">        DESTINATION lib/cmake/MyProj)</span><br></pre></td></tr></table></figure>

<p>ğŸ“˜ <code>configure_package_config_file</code>â€¯æ˜¯å®˜æ–¹å®ï¼ˆæ¥è‡ªâ€¯CMakePackageConfigHelpersï¼‰ï¼Œ<br>ä¼šè‡ªåŠ¨å¡«å……ç‰ˆæœ¬ä¸è·¯å¾„ç­‰ä¿¡æ¯ã€‚</p>
<hr>
<h2 id="4-4-Find-æ¨¡å¼å·¥ä½œåŸç†"><a href="#4-4-Find-æ¨¡å¼å·¥ä½œåŸç†" class="headerlink" title="4.4â€¯Find æ¨¡å¼å·¥ä½œåŸç†"></a>4.4â€¯Find æ¨¡å¼å·¥ä½œåŸç†</h2><p>æ—§å¼é¡¹ç›®æˆ–ç³»ç»Ÿåº“é€šå¸¸åªæä¾›â€¯<code>FindXXX.cmake</code>ï¼š</p>
<p>å­˜æ”¾åœ¨ <code>$CMAKE_MODULE_PATH</code>â€¯&#x2F;â€¯ç³»ç»Ÿâ€¯Modulesâ€¯è·¯å¾„ä¸‹ã€‚  </p>
<p>ç¤ºä¾‹ï¼ˆç³»ç»Ÿè‡ªå¸¦ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FindThreads.cmake</span><br><span class="line">FindPkgConfig.cmake</span><br><span class="line">FindOpenGL.cmake</span><br><span class="line">FindPython3.cmake</span><br></pre></td></tr></table></figure>

<p>å†…éƒ¨åŸºæœ¬æµç¨‹ï¼š</p>
<ol>
<li>å°è¯•ä½¿ç”¨â€¯pkg-configã€ç³»ç»Ÿå˜é‡ã€é»˜è®¤è·¯å¾„æœç´¢å¤´æ–‡ä»¶ä¸åº“ï¼›</li>
<li>è‹¥æˆåŠŸè®¾ç½®ä»¥ä¸‹å˜é‡ï¼š<ul>
<li><code>&lt;Pkg&gt;_FOUND</code></li>
<li><code>&lt;Pkg&gt;_INCLUDE_DIRS</code></li>
<li><code>&lt;Pkg&gt;_LIBRARIES</code></li>
</ul>
</li>
<li>ä½¿ç”¨ç¤ºä¾‹ï¼š<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(OpenGL REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE OpenGL::GL)</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="4-5-æœç´¢è·¯å¾„ä¸æ§åˆ¶å˜é‡"><a href="#4-5-æœç´¢è·¯å¾„ä¸æ§åˆ¶å˜é‡" class="headerlink" title="4.5â€¯æœç´¢è·¯å¾„ä¸æ§åˆ¶å˜é‡"></a>4.5â€¯æœç´¢è·¯å¾„ä¸æ§åˆ¶å˜é‡</h2><table>
<thead>
<tr>
<th>å˜é‡ &#x2F;é€‰é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>&lt;Pkg&gt;_DIR</code></td>
<td>æŒ‡å®š Config æ–‡ä»¶ç›®å½•</td>
</tr>
<tr>
<td><code>CMAKE_PREFIX_PATH</code></td>
<td>é™„åŠ æœç´¢æ ¹</td>
</tr>
<tr>
<td><code>CMAKE_MODULE_PATH</code></td>
<td>é™„åŠ æ¨¡å—æœç´¢è·¯å¾„</td>
</tr>
<tr>
<td><code>CMAKE_FIND_ROOT_PATH</code></td>
<td>äº¤å‰ç¼–è¯‘æ ¹è·¯å¾„</td>
</tr>
<tr>
<td><code>NO_DEFAULT_PATH</code></td>
<td>å…³é—­é»˜è®¤è·¯å¾„æœç´¢</td>
</tr>
<tr>
<td><code>PATHS</code> &#x2F; <code>HINTS</code></td>
<td>ä¸´æ—¶æŒ‡æ˜å€™é€‰è·¯å¾„</td>
</tr>
</tbody></table>
<p>ğŸ’¡ å¸¸ç”¨ä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_PREFIX_PATH <span class="string">&quot;/opt/mylibs;/usr/local&quot;</span>)</span><br><span class="line"><span class="keyword">find_package</span>(MyProj REQUIRED)</span><br></pre></td></tr></table></figure>
<p>æˆ–å‘½ä»¤è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -DCMAKE_PREFIX_PATH=/opt/mylibs ..</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-6-ç‰ˆæœ¬ä¸å¯é€‰é¡¹"><a href="#4-6-ç‰ˆæœ¬ä¸å¯é€‰é¡¹" class="headerlink" title="4.6â€¯ç‰ˆæœ¬ä¸å¯é€‰é¡¹"></a>4.6â€¯ç‰ˆæœ¬ä¸å¯é€‰é¡¹</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(Qt6 <span class="number">6.5</span> COMPONENTS Core Gui Widgets REQUIRED)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><strong><code>&lt;Name&gt;</code></strong></td>
<td>åŒ…å</td>
</tr>
<tr>
<td><strong><code>&lt;Version&gt;</code></strong></td>
<td>æœ€ä½ç‰ˆæœ¬è¦æ±‚</td>
</tr>
<tr>
<td><strong>COMPONENTS</strong></td>
<td>æŒ‡å®šå­æ¨¡å—</td>
</tr>
<tr>
<td><strong>CONFIG &#x2F; MODULE</strong></td>
<td>æŒ‡å®šæœç´¢æ¨¡å¼</td>
</tr>
<tr>
<td><strong>REQUIRED</strong></td>
<td>æ‰¾ä¸åˆ°åˆ™ç«‹å³æŠ¥é”™</td>
</tr>
<tr>
<td><strong>QUIET</strong></td>
<td>é™é»˜æœç´¢ï¼Œä¸æç¤º</td>
</tr>
</tbody></table>
<p>Package æ–‡ä»¶å¯æä¾›ï¼š</p>
<ul>
<li><code>&lt;Name&gt;_FOUND</code></li>
<li><code>&lt;Name&gt;_VERSION</code></li>
<li><code>&lt;Name&gt;_COMPONENTS_FOUND</code></li>
</ul>
<hr>
<h2 id="4-7-CMakePackageConfigHelpers-å·¥å…·"><a href="#4-7-CMakePackageConfigHelpers-å·¥å…·" class="headerlink" title="4.7â€¯CMakePackageConfigHelpers å·¥å…·"></a>4.7â€¯CMakePackageConfigHelpers å·¥å…·</h2><p>æä¾›ä¸¤ä¸ªæ ¸å¿ƒå®ï¼š</p>
<ol>
<li><code>configure_package_config_file()</code>  </li>
<li><code>write_basic_package_version_file()</code></li>
</ol>
<p>ç”ŸæˆåŸºç¡€â€¯Configâ€¯ä¸â€¯Versionâ€¯æ–‡ä»¶ï¼Œè®©é¡¹ç›®è‡ªåŠ¨æ”¯æŒç‰ˆæœ¬æ£€æµ‹ã€‚</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(CMakePackageConfigHelpers)</span><br><span class="line"></span><br><span class="line">write_basic_package_version_file(</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjConfigVersion.cmake&quot;</span></span><br><span class="line">  VERSION <span class="variable">$&#123;PROJECT_VERSION&#125;</span></span><br><span class="line">  COMPATIBILITY SameMajorVersion)</span><br><span class="line"><span class="keyword">install</span>(FILES</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjConfigVersion.cmake&quot;</span></span><br><span class="line">  DESTINATION lib/cmake/MyProj)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-8-è·¨å¹³å°-Find-å®æˆ˜ä¸¾ä¾‹"><a href="#4-8-è·¨å¹³å°-Find-å®æˆ˜ä¸¾ä¾‹" class="headerlink" title="4.8â€¯è·¨å¹³å° Find å®æˆ˜ä¸¾ä¾‹"></a>4.8â€¯è·¨å¹³å° Find å®æˆ˜ä¸¾ä¾‹</h2><h3 id="1-æŸ¥æ‰¾ç³»ç»Ÿåº“-OpenSSL"><a href="#1-æŸ¥æ‰¾ç³»ç»Ÿåº“-OpenSSL" class="headerlink" title="(1)â€¯æŸ¥æ‰¾ç³»ç»Ÿåº“ OpenSSL"></a>(1)â€¯æŸ¥æ‰¾ç³»ç»Ÿåº“ OpenSSL</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(OpenSSL REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE OpenSSL::SSL OpenSSL::Crypto)</span><br></pre></td></tr></table></figure>

<h3 id="2-æŸ¥æ‰¾è‡ªå®šä¹‰åŒ…è·¯å¾„"><a href="#2-æŸ¥æ‰¾è‡ªå®šä¹‰åŒ…è·¯å¾„" class="headerlink" title="(2)â€¯æŸ¥æ‰¾è‡ªå®šä¹‰åŒ…è·¯å¾„"></a>(2)â€¯æŸ¥æ‰¾è‡ªå®šä¹‰åŒ…è·¯å¾„</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(MyLib_DIR <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;/third_party/mylib&quot;</span>)</span><br><span class="line"><span class="keyword">find_package</span>(MyLib CONFIG REQUIRED)</span><br></pre></td></tr></table></figure>

<h3 id="3-ä½¿ç”¨-pkg-config-æ¨¡å¼"><a href="#3-ä½¿ç”¨-pkg-config-æ¨¡å¼" class="headerlink" title="(3)â€¯ä½¿ç”¨â€¯pkg-configâ€¯æ¨¡å¼"></a>(3)â€¯ä½¿ç”¨â€¯pkg-configâ€¯æ¨¡å¼</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(PkgConfig REQUIRED)</span><br><span class="line">pkg_check_modules(ZLIB REQUIRED zlib)</span><br><span class="line"><span class="keyword">target_include_directories</span>(app PRIVATE <span class="variable">$&#123;ZLIB_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE <span class="variable">$&#123;ZLIB_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-9-æŸ¥æ‰¾ä¼˜å…ˆçº§ç®€åŒ–æµç¨‹"><a href="#4-9-æŸ¥æ‰¾ä¼˜å…ˆçº§ç®€åŒ–æµç¨‹" class="headerlink" title="4.9â€¯æŸ¥æ‰¾ä¼˜å…ˆçº§ç®€åŒ–æµç¨‹"></a>4.9â€¯æŸ¥æ‰¾ä¼˜å…ˆçº§ç®€åŒ–æµç¨‹</h2><p>1ï¸âƒ£ ç›´æ¥æŒ‡å®š <code>&lt;Pkg&gt;_DIR</code><br>2ï¸âƒ£ æŸ¥â€¯CMAKE_PREFIX_PATH<br>3ï¸âƒ£ æŸ¥â€¯ç³»ç»Ÿé»˜è®¤è·¯å¾„â€¯(&#x2F;usr&#x2F;lib&#x2F;cmake&#x2F;<Pkg>)<br>4ï¸âƒ£ æŸ¥â€¯CMAKE_MODULE_PATH<br>â¡ï¸ æœ€å fallback åˆ°å†…ç½®â€¯FindXXX.cmake  </p>
<hr>
<h2 id="4-10-å¸¸è§é—®é¢˜ä¸ç»éªŒ"><a href="#4-10-å¸¸è§é—®é¢˜ä¸ç»éªŒ" class="headerlink" title="4.10â€¯å¸¸è§é—®é¢˜ä¸ç»éªŒ"></a>4.10â€¯å¸¸è§é—®é¢˜ä¸ç»éªŒ</h2><table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>åŸå› </th>
<th>å»ºè®®</th>
</tr>
</thead>
<tbody><tr>
<td>åŒ…æ‰¾ä¸åˆ°</td>
<td>æœç´¢è·¯å¾„æœªåŒ…å«å®‰è£…ç›®å½•</td>
<td>è®¾ç½®â€¯<code>&lt;Pkg&gt;_DIR</code>â€¯æˆ–â€¯<code>CMAKE_PREFIX_PATH</code></td>
</tr>
<tr>
<td>é“¾æ¥æŠ¥é”™</td>
<td>æœªä½¿ç”¨â€¯targetâ€¯æ¥å£</td>
<td>ç¡®ä¿ç›®æ ‡å¯¼å‡ºâ€¯namespaceâ€¯å¹¶ä½¿ç”¨â€¯target_link_libraries</td>
</tr>
<tr>
<td>æ‰¾åˆ°äº†æ—§ç‰ˆæœ¬åŒ…</td>
<td>å­˜åœ¨å¤šä¸ªå®‰è£…è·¯å¾„</td>
<td>æ˜¾å¼æŒ‡å®šç‰ˆæœ¬æˆ–è·¯å¾„</td>
</tr>
<tr>
<td>â€œfound falseâ€â€¯ä½†å¤´æ–‡ä»¶å­˜åœ¨</td>
<td>æ— æ­£ç¡®â€¯Configâ€¯æˆ–â€¯Findâ€¯æ¨¡å—</td>
<td>è‡ªå·±å†™â€¯Findâ€¯è„šæœ¬æˆ–åˆ‡æ¢â€¯CONFIGâ€¯æ¨¡å¼</td>
</tr>
<tr>
<td>äº¤å‰ç¼–è¯‘ä¸­æ‰¾é”™ä½“ç³»åº“</td>
<td>PATHâ€¯æœªé‡å®šä½</td>
<td>è®¾ç½®â€¯<code>CMAKE_FIND_ROOT_PATH_MODE_*</code>â€¯ç­–ç•¥</td>
</tr>
</tbody></table>
<hr>
<h2 id="4-11-ç« èŠ‚å°ç»“"><a href="#4-11-ç« èŠ‚å°ç»“" class="headerlink" title="4.11â€¯ç« èŠ‚å°ç»“"></a>4.11â€¯ç« èŠ‚å°ç»“</h2><p>âœ…â€¯æœ¬ç« è¦ç‚¹ï¼š  </p>
<ul>
<li><strong>ä¸¤ç§åŒ…æ¨¡å¼</strong>ï¼šConfigâ€¯(ç°ä»£)â€¯vsâ€¯Moduleâ€¯(ä¼ ç»Ÿ)  </li>
<li><strong>find_package</strong>â€¯æœç´¢è·¯å¾„ä¸å˜é‡æ§åˆ¶  </li>
<li><strong>Config&#x2F;Version</strong>â€¯æ–‡ä»¶ç”Ÿæˆå®ä¸ä½¿ç”¨  </li>
<li><strong>ä¼ æ’­ç›®æ ‡</strong>ï¼šé€šè¿‡â€¯namespaceâ€¯å¯¼å‡ºçš„â€¯Target  </li>
<li><strong>å¸¸è§é”™è¯¯æ’æŸ¥æ–¹æ³•</strong></li>
</ul>
<hr>
<hr>
<h1 id="ğŸ§±-ç¬¬-5-å¤šç›®å½•ä¸å­é¡¹ç›®ç®¡ç†ï¼šadd-subdirectory-ä¸-FetchContent-å®æˆ˜"><a href="#ğŸ§±-ç¬¬-5-å¤šç›®å½•ä¸å­é¡¹ç›®ç®¡ç†ï¼šadd-subdirectory-ä¸-FetchContent-å®æˆ˜" class="headerlink" title="ğŸ§± ç¬¬â€¯5â€¯â€¯|â€¯å¤šç›®å½•ä¸å­é¡¹ç›®ç®¡ç†ï¼šadd_subdirectory()â€¯ä¸â€¯FetchContentâ€¯å®æˆ˜"></a>ğŸ§± ç¬¬â€¯5â€¯â€¯|â€¯å¤šç›®å½•ä¸å­é¡¹ç›®ç®¡ç†ï¼šadd_subdirectory()â€¯ä¸â€¯FetchContentâ€¯å®æˆ˜</h1><hr>
<h2 id="5-1-å¤šç›®å½•é¡¹ç›®ç»“æ„çš„æ„ä¹‰"><a href="#5-1-å¤šç›®å½•é¡¹ç›®ç»“æ„çš„æ„ä¹‰" class="headerlink" title="5.1â€¯å¤šç›®å½•é¡¹ç›®ç»“æ„çš„æ„ä¹‰"></a>5.1â€¯å¤šç›®å½•é¡¹ç›®ç»“æ„çš„æ„ä¹‰</h2><p>å½“é¡¹ç›®å˜å¤§æ—¶ï¼Œå•ä¸ªâ€¯CMakeLists.txtâ€¯å·²ç»éš¾ä»¥ç»´æŠ¤ã€‚<br><strong>å¤šå±‚ç›®å½•ç»“æ„</strong>å¯ä»¥å®ç°ï¼š</p>
<ul>
<li>æ¨¡å—åŒ–ç®¡ç†ï¼ˆåº“â€¯coreã€ç½‘ç»œâ€¯netã€åº”ç”¨â€¯appâ€¯åˆ†å±‚ï¼‰</li>
<li>ç»„ä»¶ç‹¬ç«‹ç¼–è¯‘ã€å¤ç”¨ã€å•å…ƒæµ‹è¯•</li>
<li>æ¸…æ™°çš„ä¾èµ–é“¾ä¸ä½œç”¨åŸŸè¾¹ç•Œ</li>
</ul>
<p>å…¸å‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MyProj/</span><br><span class="line">â”œâ”€ CMakeLists.txt            # é¡¶å±‚</span><br><span class="line">â”œâ”€ src/</span><br><span class="line">â”‚  â”œâ”€ CMakeLists.txt         # å­ç›®å½•æ„å»ºæ ¸å¿ƒåº“</span><br><span class="line">â”‚  â””â”€ core/</span><br><span class="line">â”‚     â”œâ”€ CMakeLists.txt</span><br><span class="line">â”‚     â””â”€ core.cpp</span><br><span class="line">â”œâ”€ app/</span><br><span class="line">â”‚  â”œâ”€ CMakeLists.txt</span><br><span class="line">â”‚  â””â”€ main.cpp</span><br><span class="line">â””â”€ tests/</span><br><span class="line">   â””â”€ CMakeLists.txt</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-2-add-subdirectory"><a href="#5-2-add-subdirectory" class="headerlink" title="5.2â€¯add_subdirectory()"></a>5.2â€¯add_subdirectory()</h2><p>é¡¶å±‚â€¯CMakeListsâ€¯ä¸­æ³¨å†Œæ„å»ºçš„å­ç›®å½•ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_subdirectory</span>(src)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(app)</span><br><span class="line"><span class="keyword">enable_testing</span>()</span><br><span class="line"><span class="keyword">add_subdirectory</span>(tests)</span><br></pre></td></tr></table></figure>

<p>è¯­æ³•ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add_sub(&lt;dir&gt; [binary_dir] [EXCLUDE_FROM_ALL])</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td><code>&lt;dir&gt;</code></td>
<td>å­ç›®å½•ç›¸å¯¹è·¯å¾„</td>
</tr>
<tr>
<td><code>binary_dir</code></td>
<td>æŒ‡å®šæ„å»ºè¾“å‡ºç›®å½•ï¼ˆé»˜è®¤â€¯buildâ€¯æ ‘å†…åŒè·¯å¾„ï¼‰</td>
</tr>
<tr>
<td>&#96;EXCLUDE_FROM_ALL</td>
<td>å­é¡¹ç›®ä¸ä¼šéšä¸»é¡¹ç›®é»˜è®¤ç›®æ ‡ç¼–è¯‘</td>
</tr>
</tbody></table>
<p>âš™ï¸â€¯æ¯ä¸ªå­ç›®å½•éƒ½å¯ä»¥åƒç‹¬ç«‹é¡¹ç›®ä¸€æ ·ä½¿ç”¨â€¯add_libraryã€add_executableâ€¯ç­‰å‘½ä»¤ï¼Œ<br>ä¸”ç»§æ‰¿é¡¶å±‚çš„â€¯å˜é‡ã€ç¼“å­˜ã€é€‰é¡¹ã€‚  </p>
<hr>
<h2 id="5-3-ä½œç”¨åŸŸä¸å˜é‡ä¼ æ’­è§„åˆ™"><a href="#5-3-ä½œç”¨åŸŸä¸å˜é‡ä¼ æ’­è§„åˆ™" class="headerlink" title="5.3â€¯ä½œç”¨åŸŸä¸å˜é‡ä¼ æ’­è§„åˆ™"></a>5.3â€¯ä½œç”¨åŸŸä¸å˜é‡ä¼ æ’­è§„åˆ™</h2><ul>
<li><strong>å˜é‡</strong>ï¼š<code>set(VAR value)</code>â€¯é»˜è®¤åªåœ¨å½“å‰æ–‡ä»¶å’Œæ›´ä½å±‚â€¯å¯è§ï¼Œé™¤éå£°æ˜â€¯<code>CACHE</code>â€¯æˆ–â€¯<code>PARENT_SCOPE</code>ã€‚  </li>
<li><strong>ç›®æ ‡</strong>ï¼šæ‰€æœ‰å­ç›®å½•â€¯add_library&#x2F;add_executableâ€¯äº§ç”Ÿçš„ Targetâ€¯åœ¨å…¨å±€å¯è§ï¼ˆå¯è·¨ç›®å½•ä½¿ç”¨â€¯target_link_librariesï¼‰ã€‚  </li>
<li>**é€‰é¡¹(Option)**ï¼šé¡¶å±‚â€¯option()â€¯å®šä¹‰åï¼Œå­ç›®å½•éƒ½å¯â€¯ON&#x2F;OFFâ€¯æ§åˆ¶ã€‚</li>
</ul>
<p>ä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¡¶å±‚</span></span><br><span class="line"><span class="keyword">option</span>(ENABLE_NET <span class="string">&quot;Build net module&quot;</span> <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">if</span>(ENABLE_NET)</span><br><span class="line">  <span class="keyword">add_subdirectory</span>(src/net)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-4-å­é¡¹ç›®é—´ä¾èµ–"><a href="#5-4-å­é¡¹ç›®é—´ä¾èµ–" class="headerlink" title="5.4â€¯å­é¡¹ç›®é—´ä¾èµ–"></a>5.4â€¯å­é¡¹ç›®é—´ä¾èµ–</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># src/core/CMakeLists.txt</span></span><br><span class="line"><span class="keyword">add_library</span>(core core.cpp core.h)</span><br><span class="line"><span class="keyword">target_include_directories</span>(core PUBLIC <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># app/CMakeLists.txt</span></span><br><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE core)</span><br></pre></td></tr></table></figure>
<p>â®•â€¯è¿™æ ·å³å¯åœ¨é¡¶å±‚æ„å»ºæ—¶è‡ªåŠ¨æŒ‰ä¾èµ–é¡ºåºç¼–è¯‘ã€‚</p>
<hr>
<h2 id="5-5-EXCLUDE-FROM-ALL-çš„ä½¿ç”¨åœºæ™¯"><a href="#5-5-EXCLUDE-FROM-ALL-çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="5.5â€¯EXCLUDE_FROM_ALLâ€¯çš„ä½¿ç”¨åœºæ™¯"></a>5.5â€¯EXCLUDE_FROM_ALLâ€¯çš„ä½¿ç”¨åœºæ™¯</h2><p>æŸäº›å­æ¨¡å—ï¼ˆä¾‹å¦‚æµ‹è¯•ã€å·¥å…·ï¼‰åªåœ¨éœ€è¦æ—¶ç¼–è¯‘:</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_subdirectory</span>(tools EXCLUDE_FROM_ALL)</span><br></pre></td></tr></table></figure>
<p>é™¤éæ˜¾å¼è°ƒç”¨â€¯<code>cmake --build . --target toolname</code>ï¼Œå¦åˆ™ä¸ä¼šå‚ä¸é»˜è®¤â€¯<code>all</code>â€¯ç›®æ ‡ã€‚</p>
<hr>
<h2 id="5-6-å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆä¸€ï¼šadd-subdirectory-FetchContent"><a href="#5-6-å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆä¸€ï¼šadd-subdirectory-FetchContent" class="headerlink" title="5.6â€¯å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆä¸€ï¼šadd_subdirectory + FetchContent"></a>5.6â€¯å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆä¸€ï¼šadd_subdirectory + FetchContent</h2><blockquote>
<p>â€œä¸å®‰è£…å¤–éƒ¨ä¾èµ–ï¼Œä¹Ÿèƒ½è¾¾æˆè·¨é¡¹ç›®æ„å»ºâ€  </p>
</blockquote>
<p>ä»â€¯CMakeâ€¯3.11â€¯å¼€å§‹æä¾›çš„ <strong>FetchContent</strong> æ¨¡å—ï¼Œè®©ä½ åœ¨é…ç½®é˜¶æ®µä¸‹è½½å¹¶æ·»åŠ å¤–éƒ¨æºç ã€‚</p>
<hr>
<h3 id="5-6-1-åŸºæœ¬æµç¨‹"><a href="#5-6-1-åŸºæœ¬æµç¨‹" class="headerlink" title="5.6.1â€¯åŸºæœ¬æµç¨‹"></a>5.6.1â€¯åŸºæœ¬æµç¨‹</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(FetchContent)</span><br><span class="line"></span><br><span class="line">FetchContent_Declare(</span><br><span class="line">  spdlog</span><br><span class="line">  GIT_REPOSITORY https://github.com/gabime/spdlog.git</span><br><span class="line">  GIT_TAG        v1.<span class="number">11.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨ä¸‹è½½ + add_subdirectory</span></span><br><span class="line">FetchContent_MakeAvailable(spdlog)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸€æ—¦æ‰§è¡Œåï¼Œä½ å°±å¯ä»¥ç›´æ¥ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE spdlog::spdlog)</span><br></pre></td></tr></table></figure>
<p>æ— éœ€é¢å¤–â€¯find_packageã€‚</p>
</blockquote>
<hr>
<h3 id="5-6-2-å¯é€‰å‚æ•°"><a href="#5-6-2-å¯é€‰å‚æ•°" class="headerlink" title="5.6.2â€¯å¯é€‰å‚æ•°"></a>5.6.2â€¯å¯é€‰å‚æ•°</h3><table>
<thead>
<tr>
<th>å…³é”®å­—</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>URL</code>â€¯&#x2F;â€¯<code>URL_HASH</code></td>
<td>HTTPâ€¯åŒ…ä¸‹è½½ï¼ˆzip&#x2F;tar.gzï¼‰</td>
</tr>
<tr>
<td><code>GIT_REPOSITORY</code>â€¯&#x2F;â€¯<code>GIT_TAG</code></td>
<td>Gitâ€¯ä»“åº“æºç </td>
</tr>
<tr>
<td><code>SOURCE_DIR</code></td>
<td>å·²æœ‰æºç è·¯å¾„ï¼Œå¯è·³è¿‡ä¸‹è½½</td>
</tr>
<tr>
<td><code>SYSTEM</code></td>
<td>å°†ç›®å½•æ ‡è®°ä¸ºç³»ç»Ÿåº“è·¯å¾„ï¼ˆé¿å…è­¦å‘Šï¼‰</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ â€” ä¸‹è½½ fmtï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FetchContent_Declare(fmt</span><br><span class="line">  URL https://github.com/fmtlib/fmt/archive/<span class="number">9.1</span>.<span class="number">0</span>.tar.gz)</span><br><span class="line">FetchContent_MakeAvailable(fmt)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-7-å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆäºŒï¼šExternalProject-Add"><a href="#5-7-å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆäºŒï¼šExternalProject-Add" class="headerlink" title="5.7â€¯å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆäºŒï¼šExternalProject_Add"></a>5.7â€¯å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆäºŒï¼šExternalProject_Add</h2><p>åŒºåˆ«ï¼š  </p>
<ul>
<li><strong>ExternalProject_Add</strong>â€¯åœ¨ <em>æ„å»ºé˜¶æ®µ</em> ä¸‹è½½å¹¶å•ç‹¬æ‰§è¡Œå®‰è£…ï¼ˆä¸ä¼šç›´æ¥ä½œä¸ºå­ç›®å½•ï¼‰ã€‚  </li>
<li><strong>FetchContent</strong>â€¯åœ¨ <em>é…ç½®é˜¶æ®µ</em> ä¸‹è½½å¹¶ç›´æ¥ç¼–å…¥å½“å‰æ„å»ºæ ‘ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>FetchContent</th>
<th>ExternalProject_Add</th>
</tr>
</thead>
<tbody><tr>
<td>ä¸‹è½½æ—¶æœº</td>
<td>é…ç½®é˜¶æ®µ</td>
<td>æ„å»ºé˜¶æ®µ</td>
</tr>
<tr>
<td>æ˜¯å¦å˜æˆæœ¬åœ° target</td>
<td>âœ…â€¯æ˜¯ï¼ˆadd_subdirectoryï¼‰</td>
<td>âŒâ€¯ç‹¬ç«‹</td>
</tr>
<tr>
<td>ç¼–è¯‘ä¾èµ–è‡ªåŠ¨ä¼ æ’­</td>
<td>âœ…</td>
<td>âŒï¼ˆè¦æ‰‹åŠ¨å¯¼å…¥ï¼‰</td>
</tr>
<tr>
<td>ç”¨é€”</td>
<td>Header-onlyã€å°ä¸­å‹åº“</td>
<td>å·¨å‹å·¥ç¨‹ã€ç¬¬ä¸‰æ–¹å·¥å…·é“¾</td>
</tr>
</tbody></table>
<p>ç¤ºæ„ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(ExternalProject)</span><br><span class="line">ExternalProject_Add(googletest</span><br><span class="line">  GIT_REPOSITORY https://github.com/google/googletest.git</span><br><span class="line">  GIT_TAG release-<span class="number">1.13</span>.<span class="number">0</span></span><br><span class="line">  PREFIX <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>/_deps</span><br><span class="line">  INSTALL_COMMAND <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-8-å¤šç›®å½•é¡¹ç›®å®è·µç¤ºä¾‹"><a href="#5-8-å¤šç›®å½•é¡¹ç›®å®è·µç¤ºä¾‹" class="headerlink" title="5.8â€¯å¤šç›®å½•é¡¹ç›®å®è·µç¤ºä¾‹"></a>5.8â€¯å¤šç›®å½•é¡¹ç›®å®è·µç¤ºä¾‹</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¡¶å±‚ CMakeLists.txt</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.22</span>)</span><br><span class="line"><span class="keyword">project</span>(MyProj VERSION <span class="number">1.0</span> LANGUAGES CXX)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(FetchContent)</span><br><span class="line">FetchContent_Declare(spdlog</span><br><span class="line">  GIT_REPOSITORY https://github.com/gabime/spdlog.git</span><br><span class="line">  GIT_TAG v1.<span class="number">11.0</span>)</span><br><span class="line">FetchContent_MakeAvailable(spdlog)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_subdirectory</span>(src)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(app)</span><br></pre></td></tr></table></figure>

<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># src/CMakeLists.txt</span></span><br><span class="line"><span class="keyword">add_library</span>(core core.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(core PUBLIC spdlog::spdlog)</span><br></pre></td></tr></table></figure>

<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app/CMakeLists.txt</span></span><br><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE core)</span><br></pre></td></tr></table></figure>

<p>æ„å»ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -S . -B build</span><br><span class="line">cmake --build build -j</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-9-å¤šç›®å½•ç»„ç»‡ç»éªŒ"><a href="#5-9-å¤šç›®å½•ç»„ç»‡ç»éªŒ" class="headerlink" title="5.9â€¯å¤šç›®å½•ç»„ç»‡ç»éªŒ"></a>5.9â€¯å¤šç›®å½•ç»„ç»‡ç»éªŒ</h2><ul>
<li>æ¯å±‚çš„â€¯CMakeLists.txtâ€¯èŒè´£æ¸…æ™°ï¼Œå°½é‡åªæè¿°å½“å‰å±‚ç›®æ ‡ã€‚  </li>
<li>å˜é‡å’Œå¸¸é‡å°½é‡åœ¨é¡¶å±‚è®¾ç½®ï¼ˆç¼–è¯‘é€‰é¡¹ã€å…¨å±€å®šä¹‰ç­‰ï¼‰ã€‚  </li>
<li>ä½¿ç”¨ <code>PRIVATE/PUBLIC/INTERFACE</code>â€¯æ§åˆ¶å±æ€§ä¼ æ’­èŒƒå›´ã€‚  </li>
<li>å¤§å‹é¡¹ç›®å»ºè®®é…åˆâ€¯install&#x2F;exportâ€¯ç”Ÿæˆç»Ÿä¸€â€¯Configâ€¯åŒ…ã€‚  </li>
<li>å¤–éƒ¨ä¾èµ–æ¨èâ€¯FetchContentâ€¯æˆ–â€¯å·²ç»â€¯Configâ€¯åŒ–â€¯çš„åº“ã€‚  </li>
<li>è‹¥è¢«å¤šé¡¹ç›®å¤ç”¨ï¼Œå¯å•ç‹¬ç»´æŠ¤ä¸º git å­æ¨¡å— +â€¯add_subdirectoryã€‚</li>
</ul>
<hr>
<h2 id="5-10-ç« èŠ‚å°ç»“"><a href="#5-10-ç« èŠ‚å°ç»“" class="headerlink" title="5.10â€¯ç« èŠ‚å°ç»“"></a>5.10â€¯ç« èŠ‚å°ç»“</h2><p>âœ…â€¯æœ¬ç« æŒæ¡ï¼š</p>
<ul>
<li><strong>å¤šç›®å½•ç»“æ„</strong>â€¯åŠå…¶å±‚æ¬¡åŒ–ç®¡ç†æ¨¡å¼  </li>
<li><strong>add_subdirectory</strong>â€¯ç®¡ç†å†…éƒ¨ç»„ä»¶  </li>
<li><strong>ä½œç”¨åŸŸä¸å˜é‡ä¼ é€’è§„åˆ™</strong>  </li>
<li><strong>EXCLUDE_FROM_ALL</strong>â€¯é€‰é¡¹åº”ç”¨  </li>
<li><strong>FetchContent</strong>â€¯å¿«é€Ÿæ‹‰å–å¤–éƒ¨ä¾èµ–  </li>
<li><strong>ExternalProject_Add</strong>â€¯ç‹¬ç«‹å¤–éƒ¨æ„å»ºæ–¹æ¡ˆ  </li>
<li>ç»„ç»‡å¤§å‹å·¥ç¨‹çš„å¸¸è§å»ºè®®</li>
</ul>
<hr>
<hr>
<h1 id="âš™ï¸-ç¬¬-6-ç« -æ„å»ºç±»å‹ï¼ˆDebug-Releaseï¼‰ä¸å¤šé…ç½®ã€å¤šå¹³å°ç­–ç•¥"><a href="#âš™ï¸-ç¬¬-6-ç« -æ„å»ºç±»å‹ï¼ˆDebug-Releaseï¼‰ä¸å¤šé…ç½®ã€å¤šå¹³å°ç­–ç•¥" class="headerlink" title="âš™ï¸ ç¬¬â€¯6â€¯ç« â€¯|â€¯æ„å»ºç±»å‹ï¼ˆDebug&#x2F;Releaseï¼‰ä¸å¤šé…ç½®ã€å¤šå¹³å°ç­–ç•¥"></a>âš™ï¸ ç¬¬â€¯6â€¯ç« â€¯|â€¯æ„å»ºç±»å‹ï¼ˆDebug&#x2F;Releaseï¼‰ä¸å¤šé…ç½®ã€å¤šå¹³å°ç­–ç•¥</h1><hr>
<h2 id="6-1-æ„å»ºç±»å‹çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#6-1-æ„å»ºç±»å‹çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="6.1â€¯æ„å»ºç±»å‹çš„æ ¸å¿ƒæ¦‚å¿µ"></a>6.1â€¯æ„å»ºç±»å‹çš„æ ¸å¿ƒæ¦‚å¿µ</h2><blockquote>
<p>â€œæ„å»ºç±»å‹â€å†³å®šç¼–è¯‘ä¼˜åŒ–çº§åˆ«ã€è°ƒè¯•ç¬¦å·ã€å®å®šä¹‰ç­‰ç¼–è¯‘æ¡ä»¶ã€‚<br>åœ¨ CMake ä¸­ï¼Œå®ƒç”±å˜é‡ <code>CMAKE_BUILD_TYPE</code> æˆ–å¤šé…ç½®ç”Ÿæˆå™¨æ§åˆ¶ã€‚  </p>
</blockquote>
<hr>
<h2 id="6-2-å•é…ç½®ç”Ÿæˆå™¨-ğŸ§©"><a href="#6-2-å•é…ç½®ç”Ÿæˆå™¨-ğŸ§©" class="headerlink" title="6.2â€¯å•é…ç½®ç”Ÿæˆå™¨ ğŸ§©"></a>6.2â€¯å•é…ç½®ç”Ÿæˆå™¨ ğŸ§©</h2><p>å…¸å‹ä»£è¡¨ï¼š<br>GCCã€Clangã€Makefilesã€Ninja  </p>
<p>ğŸ“„ åœ¨è¿™ç§ç”Ÿæˆå™¨ä¸‹ï¼Œæ„å»ºç±»å‹é€šè¿‡å˜é‡  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cmake -DCMAKE_BUILD_TYPE=Release ..</span><br><span class="line">```  </span><br><span class="line">åœ¨â€¯**é…ç½®é˜¶æ®µå›ºå®š**ï¼Œæ¥ç€ç¼–è¯‘æ—¶ä»…å­˜åœ¨è¿™ä¸€ç§ã€‚  </span><br><span class="line"></span><br><span class="line">| å¸¸ç”¨æ„å»ºç±»å‹ | é»˜è®¤å® | ä¼˜åŒ–çŠ¶æ€ |</span><br><span class="line">|---------------|---------|----------|</span><br><span class="line">| Debug | `DEBUG`, `NDEBUG`â€¯æœªå®šä¹‰ | æ— ä¼˜åŒ– + è°ƒè¯•ç¬¦å· |</span><br><span class="line">| Release | `NDEBUG` | é«˜ä¼˜åŒ–ã€å»ç¬¦å· |</span><br><span class="line">| RelWithDebInfo | `NDEBUG` | ä¼˜åŒ– + è°ƒè¯•ç¬¦å· |</span><br><span class="line">| MinSizeRel | `NDEBUG` | å¾®ä¼˜åŒ–ä½“ç§¯ |</span><br><span class="line"></span><br><span class="line">å¯æŸ¥çœ‹å†…ç½®é€‰é¡¹ï¼š</span><br><span class="line">```bash</span><br><span class="line">cmake --help-variable CMAKE_BUILD_TYPE</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-3-å¤šé…ç½®ç”Ÿæˆå™¨-ğŸ§©"><a href="#6-3-å¤šé…ç½®ç”Ÿæˆå™¨-ğŸ§©" class="headerlink" title="6.3â€¯å¤šé…ç½®ç”Ÿæˆå™¨ ğŸ§©"></a>6.3â€¯å¤šé…ç½®ç”Ÿæˆå™¨ ğŸ§©</h2><p>å…¸å‹ä»£è¡¨ï¼š<br>Visualâ€¯Studioã€Xcodeã€Ninjaâ€¯Multi-Config  </p>
<p>ğŸ“¦ åœ¨è¿™ç§ç”Ÿæˆå™¨ä¸­ CMake ä¸€æ¬¡ç”Ÿæˆæ‰€æœ‰é…ç½®ï¼Œ<br>æ„å»ºæ—¶å†æŒ‡å®šé…ç½®ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake --build build --config Debug</span><br><span class="line">cmake --build build --config Release</span><br></pre></td></tr></table></figure>

<p>æ— éœ€å†è®¾ç½®â€¯<code>CMAKE_BUILD_TYPE</code>ã€‚</p>
<hr>
<h2 id="6-4-å®šä¹‰è‡ªå®šä¹‰æ„å»ºç±»å‹ï¼ˆè¿›é˜¶ï¼‰"><a href="#6-4-å®šä¹‰è‡ªå®šä¹‰æ„å»ºç±»å‹ï¼ˆè¿›é˜¶ï¼‰" class="headerlink" title="6.4â€¯å®šä¹‰è‡ªå®šä¹‰æ„å»ºç±»å‹ï¼ˆè¿›é˜¶ï¼‰"></a>6.4â€¯å®šä¹‰è‡ªå®šä¹‰æ„å»ºç±»å‹ï¼ˆè¿›é˜¶ï¼‰</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_CONFIGURATION_TYPES <span class="string">&quot;Debug;Release;ASan&quot;</span> CACHE <span class="keyword">STRING</span> <span class="string">&quot;&quot;</span> FORCE)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_FLAGS_ASan <span class="string">&quot;-fsanitize=address -O1 -g&quot;</span> CACHE <span class="keyword">STRING</span> <span class="string">&quot;&quot;</span> FORCE)</span><br></pre></td></tr></table></figure>

<p>åœ¨å¤šé…ç½®ä¸‹ä¼šå¤šå‡ºâ€¯ASanâ€¯é€‰é¡¹ã€‚</p>
<hr>
<h2 id="6-5-å¸¸è§ç¼–è¯‘é€‰é¡¹å˜é‡"><a href="#6-5-å¸¸è§ç¼–è¯‘é€‰é¡¹å˜é‡" class="headerlink" title="6.5â€¯å¸¸è§ç¼–è¯‘é€‰é¡¹å˜é‡"></a>6.5â€¯å¸¸è§ç¼–è¯‘é€‰é¡¹å˜é‡</h2><table>
<thead>
<tr>
<th>å˜é‡</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>CMAKE_C_FLAGS_&lt;CONFIG&gt;</code></td>
<td>C è¯­è¨€ç‰¹å®šç¼–è¯‘é€‰é¡¹</td>
</tr>
<tr>
<td><code>CMAKE_CXX_FLAGS_&lt;CONFIG&gt;</code></td>
<td>C++ ç¼–è¯‘é€‰é¡¹</td>
</tr>
<tr>
<td><code>&lt;LANG&gt;_COMPILER_LAUNCHER</code></td>
<td>åŒ…è£…å™¨ï¼ˆccache, distccï¼‰</td>
</tr>
<tr>
<td><code>CMAKE_EXE_LINKER_FLAGS_&lt;CONFIG&gt;</code></td>
<td>é“¾æ¥å™¨å‚æ•°</td>
</tr>
<tr>
<td><code>CMAKE_&lt;LANG&gt;_FLAGS_INIT</code></td>
<td>é»˜è®¤åˆå§‹å€¼</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_CXX_FLAGS_DEBUG <span class="string">&quot;-g -O0&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_FLAGS_RELEASE <span class="string">&quot;-O3 -DNDEBUG&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-6-é’ˆå¯¹ç›®æ ‡çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼"><a href="#6-6-é’ˆå¯¹ç›®æ ‡çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼" class="headerlink" title="6.6â€¯é’ˆå¯¹ç›®æ ‡çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼"></a>6.6â€¯é’ˆå¯¹ç›®æ ‡çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼</h2><p>CMake æä¾›å¸¦ <code>$&lt;CONFIG:...&gt;</code>â€¯çš„è¡¨è¾¾å¼åŒºåˆ†é…ç½®ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_compile_definitions</span>(app PRIVATE</span><br><span class="line">  $&lt;$&lt;CONFIG:Debug&gt;:DEBUG_MODE&gt;</span><br><span class="line">  $&lt;$&lt;CONFIG:Release&gt;:NDEBUG&gt;)</span><br></pre></td></tr></table></figure>

<p>æˆ–è·¯å¾„åŒºåˆ†ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_directories</span>(app PRIVATE</span><br><span class="line">  $&lt;$&lt;CONFIG:Debug&gt;:<span class="variable">$&#123;CMAKE_CURRENT_BINARY_DIR&#125;</span>/lib/Debug&gt;</span><br><span class="line">  $&lt;$&lt;CONFIG:Release&gt;:<span class="variable">$&#123;CMAKE_CURRENT_BINARY_DIR&#125;</span>/lib/Release&gt;)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-7-è·¨å¹³å°å˜é‡ä¸å®"><a href="#6-7-è·¨å¹³å°å˜é‡ä¸å®" class="headerlink" title="6.7â€¯è·¨å¹³å°å˜é‡ä¸å®"></a>6.7â€¯è·¨å¹³å°å˜é‡ä¸å®</h2><table>
<thead>
<tr>
<th>å¹³å°å®</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>WIN32</code></td>
<td>Windows</td>
</tr>
<tr>
<td><code>UNIX</code>â€¯(å«â€¯macOS,â€¯Linux)</td>
<td>ç±» Unix</td>
</tr>
<tr>
<td><code>APPLE</code></td>
<td>macOS</td>
</tr>
<tr>
<td><code>MSVC</code></td>
<td>Microsoftâ€¯VCâ€¯ç¼–è¯‘å™¨</td>
</tr>
<tr>
<td><code>MINGW</code></td>
<td>MinGW</td>
</tr>
<tr>
<td><code>CMAKE_SYSTEM_NAME</code></td>
<td>æ“ä½œç³»ç»Ÿåç§°</td>
</tr>
<tr>
<td><code>CMAKE_HOST_SYSTEM_NAME</code></td>
<td>ä¸»æœºç³»ç»Ÿåç§°</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(WIN32)</span><br><span class="line">  <span class="keyword">add_definitions</span>(-DPLATFORM_WINDOWS)</span><br><span class="line"><span class="keyword">elseif</span>(APPLE)</span><br><span class="line">  <span class="keyword">add_definitions</span>(-DPLATFORM_MAC)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-8-å¤šå¹³å°ç¼–è¯‘å™¨é€‚é…"><a href="#6-8-å¤šå¹³å°ç¼–è¯‘å™¨é€‚é…" class="headerlink" title="6.8â€¯å¤šå¹³å°ç¼–è¯‘å™¨é€‚é…"></a>6.8â€¯å¤šå¹³å°ç¼–è¯‘å™¨é€‚é…</h2><p>æ ¹æ®ç¼–è¯‘å™¨è®¾ç½®é€‰é¡¹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(MSVC)</span><br><span class="line">  <span class="keyword">target_compile_options</span>(app PRIVATE /W4 /permissive-)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">  <span class="keyword">target_compile_options</span>(app PRIVATE -Wall -Wextra -pedantic)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<p>å–„ç”¨â€¯<code>generator expressions</code>â€¯åŒºåˆ†å¿«æ·ã€‚</p>
<hr>
<h2 id="6-9-è·¨ç¼–è¯‘ï¼ˆCross-Compilationï¼‰ç®€è¿°"><a href="#6-9-è·¨ç¼–è¯‘ï¼ˆCross-Compilationï¼‰ç®€è¿°" class="headerlink" title="6.9â€¯è·¨ç¼–è¯‘ï¼ˆCrossâ€¯Compilationï¼‰ç®€è¿°"></a>6.9â€¯è·¨ç¼–è¯‘ï¼ˆCrossâ€¯Compilationï¼‰ç®€è¿°</h2><p>è·¨ç¼–è¯‘ä¸»è¦ä¾é â€œ<strong>Toolchainâ€¯æ–‡ä»¶</strong>â€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -DCMAKE_TOOLCHAIN_FILE=armgcc-toolchain.cmake -DCMAKE_BUILD_TYPE=Release ..</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹â€¯toolchainâ€¯æ–‡ä»¶ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_SYSTEM_NAME Linux)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_SYSTEM_PROCESSOR arm)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_C_COMPILER arm-linux-gnueabihf-gcc)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_COMPILER arm-linux-gnueabihf-g++)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_FIND_ROOT_PATH /opt/arm-sysroot)</span><br></pre></td></tr></table></figure>
<p>CMake æ®æ­¤è°ƒæ•´ç³»ç»Ÿæœç´¢è·¯å¾„ä¸äº¤å‰å·¥å…·é“¾ã€‚  </p>
<hr>
<h2 id="6-10-é»˜è®¤è¾“å‡ºç›®å½•æŒ‰é…ç½®åˆ†ç±»"><a href="#6-10-é»˜è®¤è¾“å‡ºç›®å½•æŒ‰é…ç½®åˆ†ç±»" class="headerlink" title="6.10â€¯é»˜è®¤è¾“å‡ºç›®å½•æŒ‰é…ç½®åˆ†ç±»"></a>6.10â€¯é»˜è®¤è¾“å‡ºç›®å½•æŒ‰é…ç½®åˆ†ç±»</h2><p>æ¨èå†™æ³•ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/bin&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_ARCHIVE_OUTPUT_DIRECTORY <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/lib&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_LIBRARY_OUTPUT_DIRECTORY <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/lib&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(OUTPUTCONFIG IN LISTS CMAKE_CONFIGURATION_TYPES)</span><br><span class="line">  <span class="keyword">string</span>(TOUPPER <span class="variable">$&#123;OUTPUTCONFIG&#125;</span> OUTPUTCONFIG)</span><br><span class="line">  <span class="keyword">set</span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY_<span class="variable">$&#123;OUTPUTCONFIG&#125;</span> <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/bin/$&#123;OUTPUTCONFIG&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">set</span>(CMAKE_LIBRARY_OUTPUT_DIRECTORY_<span class="variable">$&#123;OUTPUTCONFIG&#125;</span> <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/lib/$&#123;OUTPUTCONFIG&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">set</span>(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_<span class="variable">$&#123;OUTPUTCONFIG&#125;</span> <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/lib/$&#123;OUTPUTCONFIG&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>()</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·â€¯Debug&#x2F;Releaseâ€¯ä¾¿ä¼šåˆ†ç›®å½•ä¿å­˜ã€‚</p>
<hr>
<h2 id="6-11-å¤šå¹³å°ç­–ç•¥ç»éªŒæ€»ç»“"><a href="#6-11-å¤šå¹³å°ç­–ç•¥ç»éªŒæ€»ç»“" class="headerlink" title="6.11â€¯å¤šå¹³å°ç­–ç•¥ç»éªŒæ€»ç»“"></a>6.11â€¯å¤šå¹³å°ç­–ç•¥ç»éªŒæ€»ç»“</h2><p>1ï¸âƒ£ <strong>ä¸æ»¥ç”¨â€¯if(PLATFORM)</strong><br>å°½é‡æ”¾å…¥å•ç‹¬â€¯cmakeâ€¯æ¨¡å—æ–‡ä»¶ã€‚<br>ä¾‹å¦‚â€¯<code>platform/windows.cmake</code>ã€<code>platform/linux.cmake</code>ã€‚  </p>
<p>2ï¸âƒ£ <em><em>ä½¿ç”¨â€¯target_</em>â€¯å±æ€§æ¥å£åŒ–</em>*<br>è€Œéç›´æ¥å…¨å±€è®¾ç½®â€¯CMAKE_CXX_FLAGSã€‚  </p>
<p>3ï¸âƒ£ <strong>ç¡®ä¿è·¨ç¼–è¯‘å·¥å…·é“¾è‡ªæ´½</strong><br>ä¸è¦åœ¨ toolchainâ€¯é‡Œç¡¬ç¼–ç â€¯hostâ€¯è·¯å¾„ï¼›ä¿æŒå¹²å‡€çš„ sysrootã€‚  </p>
<p>4ï¸âƒ£ <strong>åˆ©ç”¨ç¼“å­˜å˜é‡åŒºåˆ†ç¯å¢ƒ</strong><br>å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -DCMAKE_TOOLCHAIN_FILE=... -DPLATFORM_RPI=ON</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-12-ç« èŠ‚å°ç»“"><a href="#6-12-ç« èŠ‚å°ç»“" class="headerlink" title="6.12â€¯ç« èŠ‚å°ç»“"></a>6.12â€¯ç« èŠ‚å°ç»“</h2><p>âœ…â€¯æœ¬ç« ä½ å·²ç»æŒæ¡ï¼š  </p>
<ul>
<li>å•é…ç½®â€¯vsâ€¯å¤šé…ç½®â€¯æ„å»ºæœºåˆ¶  </li>
<li><code>CMAKE_BUILD_TYPE</code>â€¯çš„æ„ä¹‰  </li>
<li>å„ä¸ªç±»å‹çš„ä¼˜åŒ–ä¸å®æ§åˆ¶  </li>
<li>åœ¨â€¯targetâ€¯å±‚ä½¿ç”¨â€¯generatorâ€¯è¡¨è¾¾å¼å®ç°å¤šé…ç½®å·®å¼‚  </li>
<li>ç”¨â€¯toolchainâ€¯æ–‡ä»¶è·¨å¹³å°æ„å»ºå·¥ç¨‹  </li>
<li>å¤šå¹³å°ç¼–è¯‘å™¨é€‰é¡¹ä¸è¾“å‡ºç›®å½•è§„èŒƒ</li>
</ul>
<hr>
<hr>
<h1 id="ğŸ”§-ç¬¬-7-ç« -è‡ªå®šä¹‰å‘½ä»¤-ä¸-è‡ªå®šä¹‰ç›®æ ‡ï¼šadd-custom-command-add-custom-target"><a href="#ğŸ”§-ç¬¬-7-ç« -è‡ªå®šä¹‰å‘½ä»¤-ä¸-è‡ªå®šä¹‰ç›®æ ‡ï¼šadd-custom-command-add-custom-target" class="headerlink" title="ğŸ”§ ç¬¬â€¯7â€¯ç« â€¯|â€¯è‡ªå®šä¹‰å‘½ä»¤â€¯ä¸â€¯è‡ªå®šä¹‰ç›®æ ‡ï¼šadd_custom_command()â€¯&amp;â€¯add_custom_target()"></a>ğŸ”§ ç¬¬â€¯7â€¯ç« â€¯|â€¯è‡ªå®šä¹‰å‘½ä»¤â€¯ä¸â€¯è‡ªå®šä¹‰ç›®æ ‡ï¼šadd_custom_command()â€¯&amp;â€¯add_custom_target()</h1><hr>
<h2 id="7-1-æ ¸å¿ƒæ¦‚å¿µ"><a href="#7-1-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="7.1â€¯æ ¸å¿ƒæ¦‚å¿µ"></a>7.1â€¯æ ¸å¿ƒæ¦‚å¿µ</h2><blockquote>
<p><strong>CMake ä¸åªä¼šç¼–è¯‘ä»£ç </strong>ï¼Œå®ƒåŒæ ·èƒ½é©±åŠ¨å„ç§å¤–éƒ¨å‘½ä»¤ã€ä»£ç ç”Ÿæˆã€æ‰“åŒ…ã€å¤åˆ¶ã€æ¸…ç†ç­‰ä»»åŠ¡ã€‚<br>è¿™å°±ä¾èµ–äºâ€¯<code>add_custom_command()</code>â€¯å’Œâ€¯<code>add_custom_target()</code>ã€‚  </p>
</blockquote>
<ul>
<li><strong><code>add_custom_command()</code></strong>â€¯â†’â€¯å®šåˆ¶ç”Ÿæˆè§„åˆ™ï¼ˆäº§ç”Ÿæ–‡ä»¶ï¼‰  </li>
<li><strong><code>add_custom_target()</code></strong>â€¯â†’â€¯å®šä¹‰ç‹¬ç«‹ç›®æ ‡ï¼ˆä¸ä¸€å®šç”Ÿæˆæ–‡ä»¶ï¼‰</li>
</ul>
<hr>
<h2 id="7-2-add-custom-command-ç”Ÿæˆå‹å‘½ä»¤"><a href="#7-2-add-custom-command-ç”Ÿæˆå‹å‘½ä»¤" class="headerlink" title="7.2â€¯add_custom_command()â€¯ç”Ÿæˆå‹å‘½ä»¤"></a>7.2â€¯add_custom_command()â€¯ç”Ÿæˆå‹å‘½ä»¤</h2><p>è¯­æ³•ä¸€ï¼ˆè¾“å‡ºæ–‡ä»¶ï¼‰ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_command</span>(</span><br><span class="line">  OUTPUT  generated.cpp</span><br><span class="line">  <span class="keyword">COMMAND</span> python3 gen.py input.idl -o generated.cpp</span><br><span class="line">  DEPENDS input.idl gen.py</span><br><span class="line">  COMMENT <span class="string">&quot;ç”Ÿæˆä»£ç æ–‡ä»¶ generated.cpp&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>å…³é”®å­—</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>OUTPUT</code></td>
<td>æ‰§è¡Œå‘½ä»¤åç”Ÿæˆçš„æ–‡ä»¶</td>
</tr>
<tr>
<td><code>COMMAND</code></td>
<td>å…·ä½“æ‰§è¡Œçš„å‘½ä»¤</td>
</tr>
<tr>
<td><code>DEPENDS</code></td>
<td>æ–‡ä»¶æˆ–ç›®æ ‡ä¾èµ–</td>
</tr>
<tr>
<td><code>WORKING_DIRECTORY</code></td>
<td>è¿è¡Œç›®å½•</td>
</tr>
<tr>
<td><code>COMMENT</code></td>
<td>æ—¥å¿—æ˜¾ç¤º</td>
</tr>
<tr>
<td><code>BYPRODUCTS</code></td>
<td>é™¤ OUTPUT å¤–äº§ç”Ÿçš„å…¶ä»–æ–‡ä»¶</td>
</tr>
<tr>
<td><code>VERBATIM</code></td>
<td>è‡ªåŠ¨å®‰å…¨è½¬ä¹‰å­—ç¬¦ä¸²</td>
</tr>
</tbody></table>
<p>ğŸ”¹â€¯æ‰§è¡Œæœºåˆ¶ï¼šå½“â€¯CMake å‘ç°â€¯<code>OUTPUT</code>â€¯ç¼ºå¤±æˆ–â€¯<code>DEPENDS</code>â€¯æ›´æ–°æ—¶ï¼Œè¯¥å‘½ä»¤è§¦å‘ã€‚</p>
<hr>
<h3 id="ä¸-target-å»ºç«‹å…³ç³»"><a href="#ä¸-target-å»ºç«‹å…³ç³»" class="headerlink" title="ä¸ target å»ºç«‹å…³ç³»"></a>ä¸ target å»ºç«‹å…³ç³»</h3><p>ä¸Šé¢åªæ˜¯è§„åˆ™ï¼Œè¦è®©å®ƒç”Ÿæ•ˆï¼Œå¿…é¡»è®©æŸç›®æ ‡ä¾èµ–å®ƒï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(app main.cpp generated.cpp)</span><br><span class="line"><span class="keyword">add_custom_command</span>(</span><br><span class="line">  OUTPUT generated.cpp</span><br><span class="line">  <span class="keyword">COMMAND</span> python3 gen.py input.idl -o generated.cpp</span><br><span class="line">  DEPENDS input.idl gen.py</span><br><span class="line">  COMMENT <span class="string">&quot;ç”Ÿæˆæ¥å£æ–‡ä»¶&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>CMake è‡ªåŠ¨åœ¨ç¼–è¯‘â€¯appâ€¯å‰æ‰§è¡Œä»£ç ç”Ÿæˆã€‚</p>
<p>è‹¥ç‹¬ç«‹ç”Ÿæˆå¤šä¸ªæ–‡ä»¶å¯ç»„åˆï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_command</span>(</span><br><span class="line">  OUTPUT a.h b.h</span><br><span class="line">  <span class="keyword">COMMAND</span> gen_headers.sh <span class="variable">$&#123;CMAKE_CURRENT_BINARY_DIR&#125;</span></span><br><span class="line">  DEPENDS defs.json</span><br><span class="line">  BYPRODUCTS temp.log)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-3-add-custom-target-è‡ªå®šä¹‰ç›®æ ‡"><a href="#7-3-add-custom-target-è‡ªå®šä¹‰ç›®æ ‡" class="headerlink" title="7.3â€¯add_custom_target()â€¯è‡ªå®šä¹‰ç›®æ ‡"></a>7.3â€¯add_custom_target()â€¯è‡ªå®šä¹‰ç›®æ ‡</h2><p>è¯­æ³•ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_target</span>(&lt;name&gt; [ALL]</span><br><span class="line">  <span class="keyword">COMMAND</span> &lt;cmd1&gt; [ARGS...]</span><br><span class="line">  DEPENDS &lt;other_target(s)&gt; &lt;<span class="keyword">file</span>(s)&gt;</span><br><span class="line">  COMMENT <span class="string">&quot;some text&quot;</span>)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å…³é”®å­—</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>ALL</code></td>
<td>ç¼–å…¥é»˜è®¤â€¯<code>all</code>â€¯ç›®æ ‡</td>
</tr>
<tr>
<td><code>COMMAND</code></td>
<td>å¯å¤šæ¡</td>
</tr>
<tr>
<td><code>DEPENDS</code></td>
<td>å¯æ˜¯æ–‡ä»¶æˆ–ç›®æ ‡</td>
</tr>
<tr>
<td><code>WORKING_DIRECTORY</code></td>
<td>æ‰§è¡Œä½ç½®</td>
</tr>
</tbody></table>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_target</span>(run ALL</span><br><span class="line">  <span class="keyword">COMMAND</span> app</span><br><span class="line">  DEPENDS app</span><br><span class="line">  COMMENT <span class="string">&quot;æ‰§è¡Œåº”ç”¨ç¨‹åº&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œï¼š<code>cmake --build . --target run</code></p>
<hr>
<h2 id="7-4-add-custom-target-VS-add-custom-command"><a href="#7-4-add-custom-target-VS-add-custom-command" class="headerlink" title="7.4â€¯add_custom_targetâ€¯VSâ€¯add_custom_command"></a>7.4â€¯add_custom_targetâ€¯VSâ€¯add_custom_command</h2><table>
<thead>
<tr>
<th>åŠŸèƒ½å·®å¼‚</th>
<th>add_custom_command</th>
<th>add_custom_target</th>
</tr>
</thead>
<tbody><tr>
<td>æ˜¯å¦ç”Ÿæˆæ–‡ä»¶</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td>èƒ½å¦ä¾èµ–äºç›®æ ‡</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>å¯å¦åŠ å…¥é»˜è®¤ç¼–è¯‘</td>
<td>å¦ï¼ˆéœ€è¢«å…¶ä»–ç›®æ ‡ä¾èµ–ï¼‰</td>
<td>å¯é€‰â€¯ALL</td>
</tr>
<tr>
<td>å¸¸è§ç”¨é€”</td>
<td>ä»£ç ç”Ÿæˆã€èµ„æºæ‹·è´ç­‰</td>
<td>è¿è¡Œè„šæœ¬ã€æµ‹è¯•ã€æ‰“åŒ…</td>
</tr>
</tbody></table>
<p>ç»„åˆä½¿ç”¨ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_command</span>(OUTPUT generated.h</span><br><span class="line">  <span class="keyword">COMMAND</span> gen_header tool.idl -o generated.h</span><br><span class="line">  DEPENDS tool.idl)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_custom_target</span>(generate ALL</span><br><span class="line">  DEPENDS generated.h)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-5-å…¸å‹ç”¨é€”ç¤ºä¾‹"><a href="#7-5-å…¸å‹ç”¨é€”ç¤ºä¾‹" class="headerlink" title="7.5â€¯å…¸å‹ç”¨é€”ç¤ºä¾‹"></a>7.5â€¯å…¸å‹ç”¨é€”ç¤ºä¾‹</h2><h3 id="1-èµ„æºæ‹·è´"><a href="#1-èµ„æºæ‹·è´" class="headerlink" title="(1)â€¯èµ„æºæ‹·è´"></a>(1)â€¯èµ„æºæ‹·è´</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_command</span>(</span><br><span class="line">  <span class="keyword">TARGET</span> app POST_BUILD</span><br><span class="line">  <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E copy</span><br><span class="line">          <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/config.json</span><br><span class="line">          $&lt;TARGET_FILE_DIR:app&gt;/config.json)</span><br></pre></td></tr></table></figure>

<p>ğŸ’¬â€¯è¯­æ³•â€¯2â€¯ï¼šå½“å‘½ä»¤ä¸å·²æœ‰ç›®æ ‡å…³è”æ—¶ï¼Œå¯ä»¥çœå»â€¯OUTPUTã€‚</p>
<hr>
<h3 id="2-ä»£ç ç”Ÿæˆ-â†’-Protobuf"><a href="#2-ä»£ç ç”Ÿæˆ-â†’-Protobuf" class="headerlink" title="(2)â€¯ä»£ç ç”Ÿæˆ â†’ Protobuf"></a>(2)â€¯ä»£ç ç”Ÿæˆ â†’ Protobuf</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_command</span>(</span><br><span class="line">  OUTPUT address.pb.cc address.pb.h</span><br><span class="line">  <span class="keyword">COMMAND</span> protoc --cpp_out=. <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/address.proto</span><br><span class="line">  DEPENDS <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/address.proto)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span>(proto address.pb.cc)</span><br><span class="line"><span class="keyword">target_include_directories</span>(proto PUBLIC <span class="variable">$&#123;CMAKE_CURRENT_BINARY_DIR&#125;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-æ‰“åŒ…ç›®æ ‡"><a href="#3-æ‰“åŒ…ç›®æ ‡" class="headerlink" title="(3)â€¯æ‰“åŒ…ç›®æ ‡"></a>(3)â€¯æ‰“åŒ…ç›®æ ‡</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_target</span>(package_zip ALL</span><br><span class="line">  <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E <span class="keyword">make_directory</span> <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>/dist</span><br><span class="line">  <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E tar <span class="string">&quot;cfv&quot;</span> dist/app.zip --format=zip</span><br><span class="line">          app.exe config.json</span><br><span class="line">  COMMENT <span class="string">&quot;æ‰“åŒ…é¡¹ç›®&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-6-CMake-å†…ç½®è¾…åŠ©å‘½ä»¤"><a href="#7-6-CMake-å†…ç½®è¾…åŠ©å‘½ä»¤" class="headerlink" title="7.6â€¯CMake å†…ç½®è¾…åŠ©å‘½ä»¤"></a>7.6â€¯CMake å†…ç½®è¾…åŠ©å‘½ä»¤</h2><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>cmake -E copy</code></td>
<td>å¤åˆ¶æ–‡ä»¶</td>
</tr>
<tr>
<td><code>cmake -E remove</code></td>
<td>åˆ é™¤æ–‡ä»¶</td>
</tr>
<tr>
<td><code>cmake -E tar</code></td>
<td>æ‰“åŒ…&#x2F;è§£åŒ…</td>
</tr>
<tr>
<td><code>cmake -E echo</code></td>
<td>æ‰“å°ä¿¡æ¯</td>
</tr>
<tr>
<td><code>cmake -E env</code></td>
<td>è®¾ç½®ä¸´æ—¶ç¯å¢ƒå˜é‡</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_target</span>(print_env</span><br><span class="line">  <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E env MY_VAR=<span class="number">123</span> bash -c <span class="string">&quot;echo $MY_VAR&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-7-æ„å»ºäº‹ä»¶ä¸é˜¶æ®µ"><a href="#7-7-æ„å»ºäº‹ä»¶ä¸é˜¶æ®µ" class="headerlink" title="7.7â€¯æ„å»ºäº‹ä»¶ä¸é˜¶æ®µ"></a>7.7â€¯æ„å»ºäº‹ä»¶ä¸é˜¶æ®µ</h2><p>CMake æ”¯æŒåœ¨ç›®æ ‡çš„ä¸åŒé˜¶æ®µæ’å…¥å‘½ä»¤ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_command</span>(</span><br><span class="line">  <span class="keyword">TARGET</span> app</span><br><span class="line">  PRE_BUILD   <span class="keyword">COMMAND</span> &lt;cmd&gt;  <span class="comment"># Windows only</span></span><br><span class="line">  PRE_LINK    <span class="keyword">COMMAND</span> &lt;cmd&gt;</span><br><span class="line">  POST_BUILD  <span class="keyword">COMMAND</span> &lt;cmd&gt;)</span><br></pre></td></tr></table></figure>

<p>Linux ä¸‹é€šå¸¸ä½¿ç”¨â€¯POST_BUILDâ€¯å³å¯ã€‚</p>
<hr>
<h2 id="7-8-è‡ªå®šä¹‰æ¸…ç†ä¸æ ¼å¼åŒ–"><a href="#7-8-è‡ªå®šä¹‰æ¸…ç†ä¸æ ¼å¼åŒ–" class="headerlink" title="7.8â€¯è‡ªå®šä¹‰æ¸…ç†ä¸æ ¼å¼åŒ–"></a>7.8â€¯è‡ªå®šä¹‰æ¸…ç†ä¸æ ¼å¼åŒ–</h2><h3 id="æ¸…ç†ç”Ÿæˆæ–‡ä»¶ï¼š"><a href="#æ¸…ç†ç”Ÿæˆæ–‡ä»¶ï¼š" class="headerlink" title="æ¸…ç†ç”Ÿæˆæ–‡ä»¶ï¼š"></a>æ¸…ç†ç”Ÿæˆæ–‡ä»¶ï¼š</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_target</span>(clean_gen</span><br><span class="line">  <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E rm -f generated.*</span><br><span class="line">  COMMENT <span class="string">&quot;æ¸…ç†ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="ä¸€é”®æ ¼å¼åŒ–æºä»£ç ï¼š"><a href="#ä¸€é”®æ ¼å¼åŒ–æºä»£ç ï¼š" class="headerlink" title="ä¸€é”®æ ¼å¼åŒ–æºä»£ç ï¼š"></a>ä¸€é”®æ ¼å¼åŒ–æºä»£ç ï¼š</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_target</span>(format</span><br><span class="line">  <span class="keyword">COMMAND</span> clang-format -i <span class="variable">$&#123;ALL_SOURCE_FILES&#125;</span></span><br><span class="line">  COMMENT <span class="string">&quot;æºä»£ç æ ¼å¼åŒ–&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-9-ç»¼åˆå®ä¾‹ï¼šé›†æˆè‡ªåŠ¨ä»£ç ç”Ÿæˆ"><a href="#7-9-ç»¼åˆå®ä¾‹ï¼šé›†æˆè‡ªåŠ¨ä»£ç ç”Ÿæˆ" class="headerlink" title="7.9â€¯ç»¼åˆå®ä¾‹ï¼šé›†æˆè‡ªåŠ¨ä»£ç ç”Ÿæˆ"></a>7.9â€¯ç»¼åˆå®ä¾‹ï¼šé›†æˆè‡ªåŠ¨ä»£ç ç”Ÿæˆ</h2><p>ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tool/</span><br><span class="line">â”œâ”€ gen.py</span><br><span class="line">â”œâ”€ input.msg</span><br><span class="line">â””â”€ main.cpp</span><br></pre></td></tr></table></figure>

<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_custom_command</span>(</span><br><span class="line">  OUTPUT <span class="keyword">message</span>.hpp</span><br><span class="line">  <span class="keyword">COMMAND</span> <span class="variable">$&#123;Python3_EXECUTABLE&#125;</span> <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>/gen.py <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>/input.msg &gt; <span class="keyword">message</span>.hpp</span><br><span class="line">  DEPENDS gen.py input.msg</span><br><span class="line">  COMMENT <span class="string">&quot;ç”Ÿæˆ message.hpp&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(tool main.cpp <span class="keyword">message</span>.hpp)</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ„å»ºæ—¶ï¼Œå¦‚æœè¾“å…¥æœ‰æ›´æ–°ï¼ŒCMake ä¼šè‡ªåŠ¨é‡æ–°æ‰§è¡Œâ€¯gen.pyã€‚</p>
<hr>
<h2 id="7-10-ç« èŠ‚å°ç»“"><a href="#7-10-ç« èŠ‚å°ç»“" class="headerlink" title="7.10â€¯ç« èŠ‚å°ç»“"></a>7.10â€¯ç« èŠ‚å°ç»“</h2><p>âœ…â€¯ä½ å·²æŒæ¡ï¼š</p>
<ul>
<li><code>add_custom_command()</code>â€¯ç”¨äºç”Ÿæˆæ–‡ä»¶æˆ–é™„åŠ å‘½ä»¤  </li>
<li><code>add_custom_target()</code>â€¯ç”¨äºå®šä¹‰é€»è¾‘ç›®æ ‡  </li>
<li>å¦‚ä½•åœ¨â€¯ç›®æ ‡â€¯ä¸åŒé˜¶æ®µâ€¯æ‰§è¡Œå‘½ä»¤ï¼ˆPRE&#x2F;POST_BUILDï¼‰  </li>
<li>åˆ©ç”¨â€¯cmakeâ€¯å†…ç½®æ‰§è¡Œå‘½ä»¤â€¯<code>cmake -E</code>â€¯å®Œæˆé€šç”¨ä»»åŠ¡  </li>
<li>è‡ªå®šä¹‰æ ¼å¼åŒ–ã€æ‰“åŒ…ã€æ¸…ç†ã€ä»£ç ç”Ÿæˆä»»åŠ¡å®è·µ</li>
</ul>
<hr>
<hr>
<h1 id="ğŸ§ª-ç¬¬-8-ç« -æµ‹è¯•ä¸æŒç»­é›†æˆï¼šCTest-ä¸-CDash-ä½¿ç”¨"><a href="#ğŸ§ª-ç¬¬-8-ç« -æµ‹è¯•ä¸æŒç»­é›†æˆï¼šCTest-ä¸-CDash-ä½¿ç”¨" class="headerlink" title="ğŸ§ª ç¬¬â€¯8â€¯ç« â€¯|â€¯æµ‹è¯•ä¸æŒç»­é›†æˆï¼šCTestâ€¯ä¸â€¯CDashâ€¯ä½¿ç”¨"></a>ğŸ§ª ç¬¬â€¯8â€¯ç« â€¯|â€¯æµ‹è¯•ä¸æŒç»­é›†æˆï¼šCTestâ€¯ä¸â€¯CDashâ€¯ä½¿ç”¨</h1><hr>
<h2 id="8-1-CMake-ä¸-CTest-çš„å…³ç³»"><a href="#8-1-CMake-ä¸-CTest-çš„å…³ç³»" class="headerlink" title="8.1â€¯CMakeâ€¯ä¸â€¯CTestâ€¯çš„å…³ç³»"></a>8.1â€¯CMakeâ€¯ä¸â€¯CTestâ€¯çš„å…³ç³»</h2><p>CMakeâ€¯å¹¶ä¸ä»…ç”Ÿæˆæ„å»ºç³»ç»Ÿï¼Œè¿˜åŒ…å«è‡ªå·±çš„æµ‹è¯•é©±åŠ¨æ¡†æ¶ â€”â€”â€¯<strong>CTest</strong>ã€‚<br>å®ƒå…è®¸ä½ åœ¨ç¼–è¯‘åè‡ªåŠ¨æ‰§è¡Œå•å…ƒæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ï¼Œå¹¶æŠŠç»“æœæäº¤ç»™â€¯CDashâ€¯ä»ªè¡¨ç›˜ã€‚  </p>
<blockquote>
<p>âœ… æ ¸å¿ƒä¼˜åŠ¿  </p>
<ul>
<li>è·¨å¹³å°æµ‹è¯•å…¥å£ä¸€è‡´ï¼š<code>ctest</code>  </li>
<li>å¯ä¸â€¯CTestâ€¯å‘½ä»¤ã€CTestConfig.cmakeã€CDashâ€¯æ— ç¼é›†æˆ  </li>
<li>åŒæ—¶æ”¯æŒâ€¯GoogleTestã€Catch2ã€doctestâ€¯ç­‰æ¡†æ¶</li>
</ul>
</blockquote>
<hr>
<h2 id="8-2-å¯ç”¨æµ‹è¯•"><a href="#8-2-å¯ç”¨æµ‹è¯•" class="headerlink" title="8.2â€¯å¯ç”¨æµ‹è¯•"></a>8.2â€¯å¯ç”¨æµ‹è¯•</h2><p>åœ¨é¡¶å±‚â€¯CMakeLists.txtâ€¯å†…åŠ å…¥ï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enable_testing</span>()</span><br></pre></td></tr></table></figure>
<p>æ­¤å‘½ä¼šè‡ªåŠ¨ç”Ÿæˆâ€¯CTestTestfile.cmakeï¼Œ<br>å¹¶å…è®¸ä½¿ç”¨â€¯<code>add_test()</code>â€¯æ·»åŠ æµ‹è¯•ç›®æ ‡ã€‚  </p>
<hr>
<h2 id="8-3-add-test-åŸºç¡€è¯­æ³•"><a href="#8-3-add-test-åŸºç¡€è¯­æ³•" class="headerlink" title="8.3â€¯add_test()â€¯åŸºç¡€è¯­æ³•"></a>8.3â€¯add_test()â€¯åŸºç¡€è¯­æ³•</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_test</span>(NAME &lt;test_name&gt;</span><br><span class="line">         <span class="keyword">COMMAND</span> &lt;executable&gt; [args...])</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(mytests test_main.cpp)</span><br><span class="line"><span class="keyword">add_test</span>(NAME basic <span class="keyword">COMMAND</span> mytests)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¹‹åå³å¯åœ¨æ„å»ºç›®å½•ä¸‹è¿è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctest</span><br><span class="line">ctest -V   <span class="comment"># verbose è¾“å‡º</span></span><br><span class="line">ctest -R basic  <span class="comment"># æŒ‰åç§°ç­›é€‰</span></span><br></pre></td></tr></table></figure>
</blockquote>
<hr>
<h2 id="8-4-test-å±æ€§ä¸é…ç½®"><a href="#8-4-test-å±æ€§ä¸é…ç½®" class="headerlink" title="8.4â€¯testâ€¯å±æ€§ä¸é…ç½®"></a>8.4â€¯testâ€¯å±æ€§ä¸é…ç½®</h2><table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>WORKING_DIRECTORY</td>
<td>æ›´æ”¹æµ‹è¯•æ‰§è¡Œç›®å½•</td>
</tr>
<tr>
<td>TIMEOUT</td>
<td>æŒ‡å®šè¶…æ—¶(ç§’)</td>
</tr>
<tr>
<td>ENVIRONMENT</td>
<td>è®¾ç½®ç¯å¢ƒå˜é‡</td>
</tr>
<tr>
<td>LABELS</td>
<td>æ·»åŠ æ ‡ç­¾åˆ†ç±»</td>
</tr>
<tr>
<td>DEPENDS</td>
<td>ä¾èµ–å…¶ä»–æµ‹è¯•å®Œæˆ</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_test</span>(NAME net_ping</span><br><span class="line">  <span class="keyword">COMMAND</span> ping_app --url=https://example.com)</span><br><span class="line"><span class="keyword">set_tests_properties</span>(net_ping PROPERTIES</span><br><span class="line">  TIMEOUT <span class="number">15</span></span><br><span class="line">  LABELS <span class="string">&quot;network;integration&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-5-ä¸-GoogleTest-é›†æˆ"><a href="#8-5-ä¸-GoogleTest-é›†æˆ" class="headerlink" title="8.5â€¯ä¸â€¯GoogleTestâ€¯é›†æˆ"></a>8.5â€¯ä¸â€¯GoogleTestâ€¯é›†æˆ</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(FetchContent)</span><br><span class="line">FetchContent_Declare(</span><br><span class="line">  googletest</span><br><span class="line">  GIT_REPOSITORY https://github.com/google/googletest.git</span><br><span class="line">  GIT_TAG release-<span class="number">1.14</span>.<span class="number">0</span>)</span><br><span class="line">FetchContent_MakeAvailable(googletest)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(unit_tests test_math.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(unit_tests PRIVATE GTest::gtest_main)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(GoogleTest)</span><br><span class="line">gtest_discover_tests(unit_tests)</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œï¼š  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctest -V</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>gtest_discover_tests()</code>â€¯ä¼šåœ¨é…ç½®æ—¶è‡ªåŠ¨æšä¸¾â€¯TEST()â€¯å®ç”Ÿæˆçš„å­æµ‹è¯•ã€‚</p>
</blockquote>
<hr>
<h2 id="8-6-è¾“å‡ºä¸æ—¥å¿—"><a href="#8-6-è¾“å‡ºä¸æ—¥å¿—" class="headerlink" title="8.6â€¯è¾“å‡ºä¸æ—¥å¿—"></a>8.6â€¯è¾“å‡ºä¸æ—¥å¿—</h2><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-V</code></td>
<td>è¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td><code>-N</code></td>
<td>åªåˆ—å‡ºè€Œä¸æ‰§è¡Œ</td>
</tr>
<tr>
<td><code>--output-on-failure</code></td>
<td>å¤±è´¥æ—¶è¾“å‡ºè¯¦æƒ…</td>
</tr>
<tr>
<td><code>--repeat until-fail:3</code></td>
<td>é‡è¯•å¤±è´¥æµ‹è¯•</td>
</tr>
<tr>
<td><code>-R pattern</code></td>
<td>æŒ‰åç§°æ­£åˆ™ç­›é€‰</td>
</tr>
</tbody></table>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctest --output-on-failure -R net</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-7-åˆ†ç»„ä¸æ ‡ç­¾ç®¡ç†"><a href="#8-7-åˆ†ç»„ä¸æ ‡ç­¾ç®¡ç†" class="headerlink" title="8.7â€¯åˆ†ç»„ä¸æ ‡ç­¾ç®¡ç†"></a>8.7â€¯åˆ†ç»„ä¸æ ‡ç­¾ç®¡ç†</h2><p>å¯é€šè¿‡æ ‡ç­¾æ§åˆ¶æµ‹è¯•é›†åˆï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set_tests_properties</span>(api_test PROPERTIES LABELS <span class="string">&quot;integration&quot;</span>)</span><br><span class="line"><span class="keyword">set_tests_properties</span>(math_test PROPERTIES LABELS <span class="string">&quot;unit&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œåˆ†ç»„ï¼š  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctest -L unit</span><br></pre></td></tr></table></figure>

<p>æˆ–æ’é™¤ï¼š  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctest -LE integration</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-8-CTest-é…ç½®æ–‡ä»¶"><a href="#8-8-CTest-é…ç½®æ–‡ä»¶" class="headerlink" title="8.8â€¯CTestâ€¯é…ç½®æ–‡ä»¶"></a>8.8â€¯CTestâ€¯é…ç½®æ–‡ä»¶</h2><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºâ€¯<code>CTestConfig.cmake</code>ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CTEST_PROJECT_NAME <span class="string">&quot;MyProj&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CTEST_NIGHTLY_START_TIME <span class="string">&quot;00:00:00 UTC&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CTEST_DROP_METHOD <span class="string">&quot;https&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CTEST_DROP_SITE <span class="string">&quot;cdash.myserver.com&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CTEST_DROP_LOCATION <span class="string">&quot;/submit.php?project=MyProj&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CTEST_DROP_SITE_CDASH <span class="keyword">TRUE</span>)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–‡ä»¶ä¸ºâ€¯CDashâ€¯ä¸Šä¼ é…ç½®æä¾›é»˜è®¤å€¼ã€‚</p>
<hr>
<h2 id="8-9-CTest-é©±åŠ¨è„šæœ¬æ¨¡å¼"><a href="#8-9-CTest-é©±åŠ¨è„šæœ¬æ¨¡å¼" class="headerlink" title="8.9â€¯CTestâ€¯é©±åŠ¨è„šæœ¬æ¨¡å¼"></a>8.9â€¯CTestâ€¯é©±åŠ¨è„šæœ¬æ¨¡å¼</h2><blockquote>
<p>é€šè¿‡â€¯<code>ctest -S script.cmake</code>â€¯è¿è¡Œå¯è‡ªåŠ¨å®Œæˆï¼šé…ç½®â€¯â†’â€¯ç¼–è¯‘â€¯â†’â€¯æµ‹è¯•â€¯â†’â€¯ä¸Šä¼ ã€‚  </p>
</blockquote>
<p>ç¤ºä¾‹â€¯<code>script.cmake</code>ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ctest_start</span>(Experimental)</span><br><span class="line"><span class="keyword">ctest_configure</span>(BUILD <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;&quot;</span> SOURCE <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">ctest_build</span>()</span><br><span class="line"><span class="keyword">ctest_test</span>(REPORT_FORMAT xml OUTPUT_JUNIT results.xml)</span><br><span class="line"><span class="keyword">ctest_submit</span>()</span><br></pre></td></tr></table></figure>

<p>å¯é…åˆâ€¯cronâ€¯æˆ–â€¯CI&#x2F;CDâ€¯å®šæœŸæ‰§è¡Œã€‚</p>
<hr>
<h2 id="8-10-CDash-ä»ªè¡¨ç›˜ç®€ä»‹"><a href="#8-10-CDash-ä»ªè¡¨ç›˜ç®€ä»‹" class="headerlink" title="8.10â€¯CDashâ€¯ä»ªè¡¨ç›˜ç®€ä»‹"></a>8.10â€¯CDashâ€¯ä»ªè¡¨ç›˜ç®€ä»‹</h2><p><strong>CDash</strong>â€¯æ˜¯â€¯Kitwareâ€¯æä¾›çš„ Webâ€¯æµ‹è¯•ç»“æœå±•ç¤ºå¹³å°ã€‚  </p>
<p>ä½ å¯ä»¥ï¼š</p>
<ul>
<li>èšåˆå„ä¸ªæ„å»ºæœºçš„â€¯Build&#x2F;Testâ€¯ç»“æœ</li>
<li>å¯è§†åŒ–æ€§èƒ½&#x2F;è¦†ç›–ç‡å˜åŒ–</li>
<li>è¿½è¸ªå›å½’</li>
</ul>
<p>å®‰è£…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8081:80 kitware/cdash</span><br></pre></td></tr></table></figure>
<p>è®¿é—®ï¼š<a target="_blank" rel="noopener" href="http://localhost:8081/">http://localhost:8081</a><br>ç„¶ååœ¨â€¯CTestConfig.cmakeâ€¯ä¸­å¡«å†™ç›¸åº”çš„â€¯DROPâ€¯åœ°å€ã€‚</p>
<hr>
<h2 id="8-11-æµ‹è¯•è¦†ç›–ç‡ä¸å†…å­˜æ£€æŸ¥"><a href="#8-11-æµ‹è¯•è¦†ç›–ç‡ä¸å†…å­˜æ£€æŸ¥" class="headerlink" title="8.11â€¯æµ‹è¯•è¦†ç›–ç‡ä¸å†…å­˜æ£€æŸ¥"></a>8.11â€¯æµ‹è¯•è¦†ç›–ç‡ä¸å†…å­˜æ£€æŸ¥</h2><h3 id="è¦†ç›–ç‡"><a href="#è¦†ç›–ç‡" class="headerlink" title="è¦†ç›–ç‡"></a>è¦†ç›–ç‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -DENABLE_COVERAGE=ON ..</span><br><span class="line">make coverage</span><br></pre></td></tr></table></figure>
<p>ç»“åˆå·¥å…·å¦‚ <code>gcovr</code> &#x2F; <code>llvm-cov</code>ã€‚  </p>
<h3 id="å†…å­˜æ³„æ¼æ£€æŸ¥"><a href="#å†…å­˜æ³„æ¼æ£€æŸ¥" class="headerlink" title="å†…å­˜æ³„æ¼æ£€æŸ¥"></a>å†…å­˜æ³„æ¼æ£€æŸ¥</h3><p>åœ¨æµ‹è¯•å‘½ä»¤ä¸­åŠ ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_test</span>(NAME memcheck</span><br><span class="line">  <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E env ASAN_OPTIONS=detect_leaks=<span class="number">1</span> ctest)</span><br></pre></td></tr></table></figure>
<p>æˆ–ä½¿ç”¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctest -T MemCheck</span><br></pre></td></tr></table></figure>
<p>CMake ä¼šè‡ªåŠ¨åœ¨æµ‹è¯•ä¸‹è¿è¡Œâ€¯Valgrindâ€¯æˆ–â€¯Dr.Memoryã€‚</p>
<hr>
<h2 id="8-12-ä¸-CI-ç³»ç»Ÿç»“åˆ"><a href="#8-12-ä¸-CI-ç³»ç»Ÿç»“åˆ" class="headerlink" title="8.12â€¯ä¸ CI ç³»ç»Ÿç»“åˆ"></a>8.12â€¯ä¸ CI ç³»ç»Ÿç»“åˆ</h2><p>å¸¸è§æ–¹å¼ï¼š<br>1ï¸âƒ£ <strong>GitHubâ€¯Actions</strong><br>   <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">run:</span> <span class="string">cmake</span> <span class="string">-S</span> <span class="string">.</span> <span class="string">-B</span> <span class="string">build</span> <span class="string">-DCMAKE_BUILD_TYPE=Release</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">run:</span> <span class="string">cmake</span> <span class="string">--build</span> <span class="string">build</span> <span class="string">-j</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">run:</span> <span class="string">ctest</span> <span class="string">--test-dir</span> <span class="string">build</span> <span class="string">--output-on-failure</span></span><br></pre></td></tr></table></figure></p>
<p>2ï¸âƒ£ <strong>GitLabâ€¯CI</strong><br>   <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cmake</span> <span class="string">-S</span> <span class="string">.</span> <span class="string">-B</span> <span class="string">build</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cmake</span> <span class="string">--build</span> <span class="string">build</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cd</span> <span class="string">build</span> <span class="string">&amp;&amp;</span> <span class="string">ctest</span> <span class="string">-V</span></span><br></pre></td></tr></table></figure></p>
<p>3ï¸âƒ£ <strong>Jenkins &#x2F; TeamCity</strong></p>
<blockquote>
<p>å¯ç›´æ¥æ‰§è¡Œâ€¯ctestâ€¯æˆ–è°ƒç”¨â€¯CTestâ€¯è„šæœ¬æ¨¡å¼ã€‚  </p>
</blockquote>
<hr>
<h2 id="8-13-ç« èŠ‚å°ç»“"><a href="#8-13-ç« èŠ‚å°ç»“" class="headerlink" title="8.13â€¯ç« èŠ‚å°ç»“"></a>8.13â€¯ç« èŠ‚å°ç»“</h2><p>âœ…â€¯ä½ ç°åœ¨ä¼šï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>enable_testing()</code>â€¯å¯ç”¨æµ‹è¯•  </li>
<li>å€ŸåŠ©â€¯<code>add_test()</code>â€¯æ·»åŠ å•å…ƒæµ‹è¯•  </li>
<li>è¾“å‡ºè¯¦ç»†æ—¥å¿—å¹¶åˆ†ç»„ç®¡ç†  </li>
<li>é›†æˆâ€¯GoogleTestâ€¯æ¡†æ¶  </li>
<li>é€šè¿‡â€¯CTestâ€¯è„šæœ¬ +â€¯CDashâ€¯å½¢æˆå®Œæ•´ä»ªè¡¨ç›˜  </li>
<li>å°†æµ‹è¯•æ¥å…¥â€¯CI&#x2F;CDâ€¯å¹³å°</li>
</ul>
<hr>
<hr>
<h1 id="ğŸ“¦-ç¬¬-9-ç« -å®‰è£…ã€å¯¼å‡ºä¸å¤ç”¨ï¼šinstall-ä¸-CMake-Package-Config"><a href="#ğŸ“¦-ç¬¬-9-ç« -å®‰è£…ã€å¯¼å‡ºä¸å¤ç”¨ï¼šinstall-ä¸-CMake-Package-Config" class="headerlink" title="ğŸ“¦ ç¬¬â€¯9â€¯ç« â€¯|â€¯å®‰è£…ã€å¯¼å‡ºä¸å¤ç”¨ï¼šinstall()â€¯ä¸â€¯CMakeâ€¯Packageâ€¯Config"></a>ğŸ“¦ ç¬¬â€¯9â€¯ç« â€¯|â€¯å®‰è£…ã€å¯¼å‡ºä¸å¤ç”¨ï¼šinstall()â€¯ä¸â€¯CMakeâ€¯Packageâ€¯Config</h1><hr>
<h2 id="9-1-å®‰è£…çš„æ„ä¹‰"><a href="#9-1-å®‰è£…çš„æ„ä¹‰" class="headerlink" title="9.1â€¯å®‰è£…çš„æ„ä¹‰"></a>9.1â€¯å®‰è£…çš„æ„ä¹‰</h2><p>CMakeâ€¯å¯ä»¥å°†ç¼–è¯‘äº§ç‰©ã€å¤´æ–‡ä»¶ã€é…ç½®ã€èµ„æºç»Ÿä¸€æ‰“åŒ…åˆ°å®‰è£…ç›®å½•ã€‚<br>è¿™ä¸ä»…æ–¹ä¾¿éƒ¨ç½²ï¼Œè¿˜èƒ½è®©åˆ«çš„é¡¹ç›®é€šè¿‡â€¯<code>find_package()</code>â€¯ç›´æ¥å¤ç”¨ä½ çš„åº“ã€‚  </p>
<p><strong>å®‰è£…æµç¨‹</strong>  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake --install &lt;build_dir&gt; [--prefix &lt;path&gt;]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é»˜è®¤å‰ç¼€ä¸ºâ€¯<code>$&#123;CMAKE_INSTALL_PREFIX&#125;</code>ï¼Œ<br>Linuxâ€¯é€šå¸¸â€¯<code>/usr/local</code>ï¼ŒWindowsâ€¯ä¸ºâ€¯<code>C:/Program Files/&lt;proj&gt;</code>ã€‚</p>
</blockquote>
<hr>
<h2 id="9-2-install-æ ¸å¿ƒè¯­æ³•"><a href="#9-2-install-æ ¸å¿ƒè¯­æ³•" class="headerlink" title="9.2â€¯install()â€¯æ ¸å¿ƒè¯­æ³•"></a>9.2â€¯install()â€¯æ ¸å¿ƒè¯­æ³•</h2><p>CMakeâ€¯çš„â€¯<code>install()</code>â€¯å‘½ä»¤æ”¯æŒå®‰è£…â€œç›®æ ‡â€ã€â€œæ–‡ä»¶â€ã€â€œç›®å½•â€å’Œâ€œè„šæœ¬â€ã€‚  </p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>ç¤ºä¾‹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody><tr>
<td>TARGETS</td>
<td><code>install(TARGETS mylib)</code></td>
<td>å¯æ‰§è¡Œ&#x2F;åº“ç›®æ ‡</td>
</tr>
<tr>
<td>FILES</td>
<td><code>install(FILES a.h b.h DESTINATION include)</code></td>
<td>çº¯æ–‡ä»¶</td>
</tr>
<tr>
<td>DIRECTORY</td>
<td><code>install(DIRECTORY include/ DESTINATION include)</code></td>
<td>æ•´ä¸ªç›®å½•</td>
</tr>
<tr>
<td>PROGRAMS</td>
<td><code>install(PROGRAMS script.sh DESTINATION bin)</code></td>
<td>å¯æ‰§è¡Œè„šæœ¬</td>
</tr>
<tr>
<td>SCRIPTâ€¯&#x2F;â€¯CODE</td>
<td>ç”¨äºåœ¨å®‰è£…æ‰§è¡Œ CMakeâ€¯ä»£ç </td>
<td></td>
</tr>
</tbody></table>
<hr>
<h2 id="9-3-å®‰è£…å¯æ‰§è¡Œä¸åº“"><a href="#9-3-å®‰è£…å¯æ‰§è¡Œä¸åº“" class="headerlink" title="9.3â€¯å®‰è£…å¯æ‰§è¡Œä¸åº“"></a>9.3â€¯å®‰è£…å¯æ‰§è¡Œä¸åº“</h2><p>æœ€å¸¸è§å†™æ³•ï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(app main.cpp)</span><br><span class="line"><span class="keyword">add_library</span>(mathlib <span class="keyword">math</span>.cpp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">install</span>(TARGETS app mathlib</span><br><span class="line">  RUNTIME DESTINATION bin</span><br><span class="line">  LIBRARY DESTINATION lib</span><br><span class="line">  ARCHIVE DESTINATION lib/static)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>-â€¯RUNTIMEâ€¯â†’â€¯å¯æ‰§è¡Œæ–‡ä»¶<br>-â€¯LIBRARYâ€¯â†’â€¯åŠ¨æ€åº“ (.so&#x2F;.dylib)<br>-â€¯ARCHIVEâ€¯â†’â€¯é™æ€åº“ (.a&#x2F;.lib)  </p>
</blockquote>
<hr>
<h2 id="9-4-å®‰è£…å¤´æ–‡ä»¶"><a href="#9-4-å®‰è£…å¤´æ–‡ä»¶" class="headerlink" title="9.4â€¯å®‰è£…å¤´æ–‡ä»¶"></a>9.4â€¯å®‰è£…å¤´æ–‡ä»¶</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(DIRECTORY <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/<span class="keyword">include</span>/</span><br><span class="line">  DESTINATION <span class="keyword">include</span></span><br><span class="line">  FILES_MATCHING PATTERN <span class="string">&quot;*.h&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æˆ–ç›´æ¥åˆ—è¡¨å¼ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(FILES <span class="keyword">math</span>.h util.h DESTINATION <span class="keyword">include</span>/mylib)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-5-CMAKE-INSTALL-PREFIX-ä¿®æ”¹"><a href="#9-5-CMAKE-INSTALL-PREFIX-ä¿®æ”¹" class="headerlink" title="9.5â€¯CMAKE_INSTALL_PREFIXâ€¯ä¿®æ”¹"></a>9.5â€¯CMAKE_INSTALL_PREFIXâ€¯ä¿®æ”¹</h2><p>é…ç½®æ—¶æŒ‡å®šï¼š  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -DCMAKE_INSTALL_PREFIX=/opt/mylib ..</span><br><span class="line">cmake --install build</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯åœ¨â€¯CMakeListsâ€¯ä¸­è®¾ç½®é»˜è®¤ï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_INSTALL_PREFIX <span class="string">&quot;$&#123;PROJECT_SOURCE_DIR&#125;/dist&quot;</span> CACHE PATH <span class="string">&quot;&quot;</span> FORCE)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-6-ç”Ÿæˆå®‰è£…åŒ…ç›®å½•ç»“æ„ç¤ºä¾‹"><a href="#9-6-ç”Ÿæˆå®‰è£…åŒ…ç›®å½•ç»“æ„ç¤ºä¾‹" class="headerlink" title="9.6â€¯ç”Ÿæˆå®‰è£…åŒ…ç›®å½•ç»“æ„ç¤ºä¾‹"></a>9.6â€¯ç”Ÿæˆå®‰è£…åŒ…ç›®å½•ç»“æ„ç¤ºä¾‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dist/</span><br><span class="line"> â”œâ”€ bin/</span><br><span class="line"> â”‚   â””â”€ app</span><br><span class="line"> â”œâ”€ lib/</span><br><span class="line"> â”‚   â”œâ”€ libmathlib.so</span><br><span class="line"> â”‚   â””â”€ cmake/mylib/MyLibConfig.cmake</span><br><span class="line"> â”œâ”€ include/</span><br><span class="line"> â”‚   â””â”€ mylib/</span><br><span class="line"> â”‚       â””â”€ math.h</span><br><span class="line"> â””â”€ share/doc/</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-7-å¯¼å‡ºç›®æ ‡ä¸é‡ç”¨"><a href="#9-7-å¯¼å‡ºç›®æ ‡ä¸é‡ç”¨" class="headerlink" title="9.7â€¯å¯¼å‡ºç›®æ ‡ä¸é‡ç”¨"></a>9.7â€¯å¯¼å‡ºç›®æ ‡ä¸é‡ç”¨</h2><p>ä¸ºäº†è®©åˆ«çš„é¡¹ç›®â€¯<code>find_package(MyLib)</code>â€¯ç”Ÿæ•ˆï¼Œ<br>éœ€è¦å¯¼å‡ºç›®æ ‡å’Œé…ç½®æ–‡ä»¶ã€‚</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(TARGETS mathlib</span><br><span class="line">  <span class="keyword">EXPORT</span> MyLibTargets</span><br><span class="line">  DESTINATION lib)</span><br><span class="line"></span><br><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> MyLibTargets</span><br><span class="line">  <span class="keyword">FILE</span> MyLibTargets.cmake</span><br><span class="line">  NAMESPACE MyLib::</span><br><span class="line">  DESTINATION lib/cmake/MyLib)</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·åˆ«çš„é¡¹ç›®å¯å†™ï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(MyLib REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE MyLib::mathlib)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-8-Config-Package-æ–‡ä»¶"><a href="#9-8-Config-Package-æ–‡ä»¶" class="headerlink" title="9.8â€¯Configâ€¯Packageâ€¯æ–‡ä»¶"></a>9.8â€¯Configâ€¯Packageâ€¯æ–‡ä»¶</h2><p>ç”Ÿæˆâ€¯<code>MyLibConfig.cmake</code>â€¯å’Œâ€¯<code>MyLibConfigVersion.cmake</code>ï¼Œ<br>ç”¨äºæè¿°åº“ç‰ˆæœ¬ä¸ä¾èµ–ã€‚&#96;&#96;&#96;cmake<br>include(CMakePackageConfigHelpers)</p>
<p>write_basic_package_version_file(<br>  â€œ${CMAKE_CURRENT_BINARY_DIR}&#x2F;MyLibConfigVersion.cmakeâ€<br>  VERSION ${PROJECT_VERSION}<br>  COMPATIBILITY SameMajorVersion)</p>
<p>configure_package_config_file(<br>  â€œ${CMAKE_CURRENT_SOURCE_DIR}&#x2F;cmake&#x2F;MyLibConfig.cmake.inâ€<br>  â€œ${CMAKE_CURRENT_BINARY_DIR}&#x2F;MyLibConfig.cmakeâ€<br>  INSTALL_DESTINATION lib&#x2F;cmake&#x2F;MyLib)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æ¨¡æ¿â€¯`MyLibConfig.cmake.in`ï¼š</span><br><span class="line">```cmake</span><br><span class="line">@PACKAGE_INIT@</span><br><span class="line">include(&quot;$&#123;CMAKE_CURRENT_LIST_DIR&#125;/MyLibTargets.cmake&quot;)</span><br></pre></td></tr></table></figure>

<p>ä¹‹åä¸€èµ·å®‰è£…ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(FILES</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyLibConfig.cmake&quot;</span></span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyLibConfigVersion.cmake&quot;</span></span><br><span class="line">  DESTINATION lib/cmake/MyLib)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-9-å¯¼å‡ºæ„å»ºç›®å½•ï¼ˆéå®‰è£…æ¨¡å¼ï¼‰"><a href="#9-9-å¯¼å‡ºæ„å»ºç›®å½•ï¼ˆéå®‰è£…æ¨¡å¼ï¼‰" class="headerlink" title="9.9â€¯å¯¼å‡ºæ„å»ºç›®å½•ï¼ˆéå®‰è£…æ¨¡å¼ï¼‰"></a>9.9â€¯å¯¼å‡ºæ„å»ºç›®å½•ï¼ˆéå®‰è£…æ¨¡å¼ï¼‰</h2><p>åœ¨å¼€å‘æ—¶å¯ç›´æ¥å¯¼å‡ºæ„å»ºæ ‘ä¾›ä¸´æ—¶ä½¿ç”¨ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span>(<span class="keyword">EXPORT</span> MyLibTargets</span><br><span class="line">  <span class="keyword">FILE</span> <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY&#125;/MyLibTargets.cmake&quot;</span></span><br><span class="line">  NAMESPACE MyLib::)</span><br></pre></td></tr></table></figure>

<p>åˆ«çš„é¡¹ç›®åœ¨æœ¬åœ°å¯é€šè¿‡ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(MyLib_DIR <span class="string">&quot;/path/to/build&quot;</span>)</span><br><span class="line"><span class="keyword">find_package</span>(MyLib REQUIRED)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-10-install-å‘½ä»¤é™„å¸¦ç»„ä»¶ä¸æ¡ä»¶"><a href="#9-10-install-å‘½ä»¤é™„å¸¦ç»„ä»¶ä¸æ¡ä»¶" class="headerlink" title="9.10â€¯installâ€¯å‘½ä»¤é™„å¸¦ç»„ä»¶ä¸æ¡ä»¶"></a>9.10â€¯installâ€¯å‘½ä»¤é™„å¸¦ç»„ä»¶ä¸æ¡ä»¶</h2><p>è®¾ç½®ç»„ä»¶ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(TARGETS app</span><br><span class="line">  COMPONENT runtime</span><br><span class="line">  DESTINATION bin)</span><br><span class="line"><span class="keyword">install</span>(DIRECTORY docs/ DESTINATION share/doc COMPONENT doc)</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake --install build --component runtime</span><br></pre></td></tr></table></figure>

<p>æ¡ä»¶å®‰è£…ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(FILES config.win DESTINATION etc RENAME config.txt</span><br><span class="line">  CONFIGURATIONS Release)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-11-ä½¿ç”¨-CPack-ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶"><a href="#9-11-ä½¿ç”¨-CPack-ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶" class="headerlink" title="9.11â€¯ä½¿ç”¨â€¯CPackâ€¯ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶"></a>9.11â€¯ä½¿ç”¨â€¯CPackâ€¯ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶</h2><p>åœ¨é¡¹ç›®ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(InstallRequiredSystemLibraries)</span><br><span class="line"><span class="keyword">set</span>(CPACK_PACKAGE_NAME <span class="string">&quot;MyLib&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CPACK_PACKAGE_VERSION <span class="string">&quot;1.0.0&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CPACK_GENERATOR <span class="string">&quot;ZIP;TGZ&quot;</span>)</span><br><span class="line"><span class="keyword">include</span>(CPack)</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpack</span><br></pre></td></tr></table></figure>
<p>å°†è‡ªåŠ¨æŠŠå®‰è£…äº§ç‰©æ‰“åŒ…ä¸ºâ€¯zip &#x2F; tar.gzâ€¯æ–‡ä»¶ã€‚  </p>
<hr>
<h2 id="9-12-ç« èŠ‚å°ç»“"><a href="#9-12-ç« èŠ‚å°ç»“" class="headerlink" title="9.12â€¯ç« èŠ‚å°ç»“"></a>9.12â€¯ç« èŠ‚å°ç»“</h2><p>âœ…â€¯ä½ å·²æŒæ¡ï¼š<br>-â€¯ä½¿ç”¨â€¯install()â€¯å®‰è£…ç›®æ ‡ã€æ–‡ä»¶ã€ç›®å½•<br>-â€¯é€šè¿‡â€¯CMAKE_INSTALL_PREFIXâ€¯æ§åˆ¶å®‰è£…è·¯å¾„<br>-â€¯å¯¼å‡ºâ€¯Targetsâ€¯ä¸â€¯Configâ€¯æ–‡ä»¶ä¾›å…¶ä»–é¡¹ç›®å¤ç”¨<br>-â€¯ä½¿ç”¨â€¯CPackâ€¯ç”Ÿæˆè·¨å¹³å°å®‰è£…åŒ…  </p>
<hr>
<hr>
<h1 id="ğŸ§©-ç¬¬-10-ç« -è¿›é˜¶é¡¹ç›®ç»“æ„ä¸æ¨¡å—åŒ–è®¾è®¡ï¼šåˆ†å±‚ã€å®ä¸å‡½æ•°ã€Find-Module-ç¼–å†™"><a href="#ğŸ§©-ç¬¬-10-ç« -è¿›é˜¶é¡¹ç›®ç»“æ„ä¸æ¨¡å—åŒ–è®¾è®¡ï¼šåˆ†å±‚ã€å®ä¸å‡½æ•°ã€Find-Module-ç¼–å†™" class="headerlink" title="ğŸ§© ç¬¬â€¯10â€¯ç« â€¯|â€¯è¿›é˜¶é¡¹ç›®ç»“æ„ä¸æ¨¡å—åŒ–è®¾è®¡ï¼šåˆ†å±‚ã€å®ä¸å‡½æ•°ã€Findâ€¯Moduleâ€¯ç¼–å†™"></a>ğŸ§© ç¬¬â€¯10â€¯ç« â€¯|â€¯è¿›é˜¶é¡¹ç›®ç»“æ„ä¸æ¨¡å—åŒ–è®¾è®¡ï¼šåˆ†å±‚ã€å®ä¸å‡½æ•°ã€Findâ€¯Moduleâ€¯ç¼–å†™</h1><hr>
<h2 id="10-1-å¤§å‹é¡¹ç›®çš„å…¸å‹ç»“æ„"><a href="#10-1-å¤§å‹é¡¹ç›®çš„å…¸å‹ç»“æ„" class="headerlink" title="10.1â€¯å¤§å‹é¡¹ç›®çš„å…¸å‹ç»“æ„"></a>10.1â€¯å¤§å‹é¡¹ç›®çš„å…¸å‹ç»“æ„</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MyProject/</span><br><span class="line">â”œâ”€ CMakeLists.txt        # é¡¶å±‚ï¼šé…ç½®ã€å…¨å±€é€‰é¡¹</span><br><span class="line">â”œâ”€ cmake/                # è‡ªå®šä¹‰æ¨¡å—è„šæœ¬</span><br><span class="line">â”‚   â”œâ”€ FindXXX.cmake</span><br><span class="line">â”‚   â””â”€ Utils.cmake</span><br><span class="line">â”œâ”€ src/</span><br><span class="line">â”‚   â”œâ”€ CMakeLists.txt    # åº“ / å¯æ‰§è¡Œå®šä¹‰</span><br><span class="line">â”‚   â”œâ”€ core/</span><br><span class="line">â”‚   â””â”€ ui/</span><br><span class="line">â”œâ”€ include/</span><br><span class="line">â”‚   â””â”€ myproj/</span><br><span class="line">â”‚       â””â”€ *.h</span><br><span class="line">â”œâ”€ tests/</span><br><span class="line">â”‚   â”œâ”€ CMakeLists.txt</span><br><span class="line">â”‚   â””â”€ *.cpp</span><br><span class="line">â””â”€ examples/</span><br><span class="line">    â””â”€ CMakeLists.txt</span><br></pre></td></tr></table></figure>

<p><strong>å±‚çº§æ€è·¯ï¼š</strong></p>
<ol>
<li>é¡¶å±‚å¤„ç†å…¨å±€é…ç½®ã€é€‰é¡¹ã€ä¾èµ–ï¼›</li>
<li>ä¸‹å±‚æ¨¡å—é€šè¿‡â€¯<code>add_library()</code>â€¯æˆ–â€¯<code>add_executable()</code>â€¯å®šä¹‰ï¼›</li>
<li>ä½¿ç”¨â€¯<code>option()</code>â€¯æ§åˆ¶å¯ç¼–è¯‘æ¨¡å—ï¼›</li>
<li>ä»£ç ä¸å¤´æ–‡ä»¶ä¿æŒåˆ†ç¦»ã€‚</li>
</ol>
<hr>
<h2 id="10-2-å±‚çº§-CMakeLists-txt-çš„åä½œ"><a href="#10-2-å±‚çº§-CMakeLists-txt-çš„åä½œ" class="headerlink" title="10.2â€¯å±‚çº§ CMakeLists.txtâ€¯çš„åä½œ"></a>10.2â€¯å±‚çº§ CMakeLists.txtâ€¯çš„åä½œ</h2><p>æ¯çº§åœ¨è‡ªå·±çš„ CMakeLists.txt ä¸­å®šä¹‰å±€éƒ¨é€»è¾‘ï¼Œ<br>ç„¶ååœ¨ä¸Šå±‚ç”¨â€¯<code>add_subdirectory()</code>â€¯åŠ è½½ã€‚</p>
<p><strong>é¡¶å±‚ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.20</span>)</span><br><span class="line"><span class="keyword">project</span>(MyProject VERSION <span class="number">1.0</span> LANGUAGES CXX)</span><br><span class="line"></span><br><span class="line"><span class="keyword">option</span>(ENABLE_TESTS <span class="string">&quot;Build tests&quot;</span> <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_subdirectory</span>(src)</span><br><span class="line"><span class="keyword">if</span>(ENABLE_TESTS)</span><br><span class="line">  <span class="keyword">enable_testing</span>()</span><br><span class="line"> _subdirectory(tests)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(cmake/Utils.cmake)</span><br></pre></td></tr></table></figure>

<p><strong>å­æ¨¡å—ï¼š</strong>  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(core core.cpp core.h)</span><br><span class="line"><span class="keyword">target_include_directories</span>(core PUBLIC <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="10-3-æ¨¡å—åŒ–ä¸æ¥å£å°è£…"><a href="#10-3-æ¨¡å—åŒ–ä¸æ¥å£å°è£…" class="headerlink" title="10.3â€¯æ¨¡å—åŒ–ä¸æ¥å£å°è£…"></a>10.3â€¯æ¨¡å—åŒ–ä¸æ¥å£å°è£…</h2><p>æ¨èåšæ³•ï¼š<br>æ¯ä¸ªå­æ¨¡å—æ„æˆè‡ªæˆä½“ç³»çš„â€¯libraryï¼Œ<br>æš´éœ²ç›®æ ‡åã€åŒ…å«è·¯å¾„ã€ä¾èµ–ã€‚  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(ui ui.cpp ui.h)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(ui PUBLIC core Qt::Widgets)</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–æ¨¡å—åªéœ€ï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE ui)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡â€¯<code>target_*</code>â€¯æ¥å£ç®¡ç†ä¾èµ–è€Œéæ‰‹å·¥ include&#x2F;linkï¼Œæ˜¯ç°ä»£â€¯CMakeâ€¯çš„å…³é”®ã€‚</p>
<hr>
<h2 id="10-4-è‡ªå®šä¹‰å‡½æ•°ä¸å®"><a href="#10-4-è‡ªå®šä¹‰å‡½æ•°ä¸å®" class="headerlink" title="10.4â€¯è‡ªå®šä¹‰å‡½æ•°ä¸å®"></a>10.4â€¯è‡ªå®šä¹‰å‡½æ•°ä¸å®</h2><p>CMakeâ€¯æ”¯æŒâ€¯<code>function()</code>â€¯ä¸â€¯<code>macro()</code>â€¯å®šä¹‰å¯é‡ç”¨é€»è¾‘ã€‚  </p>
<table>
<thead>
<tr>
<th>åŒºåˆ«</th>
<th>function</th>
<th>macro</th>
</tr>
</thead>
<tbody><tr>
<td>ä½œç”¨åŸŸ</td>
<td>å±€éƒ¨ä½œç”¨åŸŸï¼ˆæ¨èï¼‰</td>
<td>æ‰©å±•åˆ°è°ƒç”¨å¤„ä½œç”¨åŸŸ</td>
</tr>
<tr>
<td>å‚æ•°ä¼ é€’</td>
<td>å¤åˆ¶</td>
<td>æ–‡æœ¬æ›¿æ¢</td>
</tr>
</tbody></table>
<p>ä¾‹ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cmake/Utils.cmake</span></span><br><span class="line"><span class="keyword">function</span>(add_my_exec name)</span><br><span class="line">  <span class="keyword">add_executable</span>(<span class="variable">$&#123;name&#125;</span> <span class="variable">$&#123;ARGN&#125;</span>)</span><br><span class="line">  <span class="keyword">target_compile_features</span>(<span class="variable">$&#123;name&#125;</span> PRIVATE cxx_std_17)</span><br><span class="line"><span class="keyword">endfunction</span>()</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(cmake/Utils.cmake)</span><br><span class="line">add_my_exec(app main.cpp)</span><br></pre></td></tr></table></figure>

<p>å¯ç®€åŒ–é‡å¤æ¨¡å¼å¹¶ä¿æŒä¸€è‡´æ€§ã€‚</p>
<hr>
<h2 id="10-5-è·¨å­é¡¹ç›®ä¼ é€’å˜é‡"><a href="#10-5-è·¨å­é¡¹ç›®ä¼ é€’å˜é‡" class="headerlink" title="10.5â€¯è·¨å­é¡¹ç›®ä¼ é€’å˜é‡"></a>10.5â€¯è·¨å­é¡¹ç›®ä¼ é€’å˜é‡</h2><p>è‹¥è¦åœ¨é¡¶å±‚æ§åˆ¶å­é¡¹ç›®ï¼Œå¯ä»¥åˆ©ç”¨â€¯<code>CACHE</code>â€¯å˜é‡æˆ–â€¯<code>option()</code>ã€‚</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(BUILD_UI <span class="keyword">ON</span> CACHE BOOL <span class="string">&quot;Build UI module&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å­é¡¹ç›®å°±èƒ½æ£€æµ‹â€¯<code>BUILD_UI</code>â€¯æ˜¯å¦ä¸ºâ€¯ONã€‚</p>
<p>è‹¥æƒ³çœŸæ­£å¯¼å‡ºåˆ°å…¶ä»– scopeï¼Œå¯ç”¨ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(VAR_NAME value PARENT_SCOPE)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="10-6-è‡ªå®šä¹‰æ¨¡å—è·¯å¾„"><a href="#10-6-è‡ªå®šä¹‰æ¨¡å—è·¯å¾„" class="headerlink" title="10.6â€¯è‡ªå®šä¹‰æ¨¡å—è·¯å¾„"></a>10.6â€¯è‡ªå®šä¹‰æ¨¡å—è·¯å¾„</h2><p>è‹¥æƒ³è®©â€¯CMakeâ€¯æ‰¾åˆ°è‡ªå®šä¹‰çš„â€¯FindXXX.cmakeï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">list</span>(APPEND CMAKE_MODULE_PATH <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;/cmake&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æ‰§è¡Œâ€¯<code>find_package(XXX REQUIRED)</code>â€¯æ—¶ï¼Œä¼šä¼˜å…ˆåœ¨è¯¥ç›®å½•æœç´¢ã€‚</p>
<hr>
<h2 id="10-7-Find-Module-æ–‡ä»¶ç»“æ„"><a href="#10-7-Find-Module-æ–‡ä»¶ç»“æ„" class="headerlink" title="10.7â€¯Findâ€¯Moduleâ€¯æ–‡ä»¶ç»“æ„"></a>10.7â€¯Findâ€¯Moduleâ€¯æ–‡ä»¶ç»“æ„</h2><p>Find æ¨¡å—é€šå¸¸å‘½åä¸ºâ€¯<strong>Find<Package>.cmake</strong>ã€‚<br>åŸºæœ¬æ¨¡æ¿ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># FindFoo.cmake</span></span><br><span class="line"><span class="keyword">find_path</span>(FOO_INCLUDE_DIR foo.h)</span><br><span class="line"><span class="keyword">find_library</span>(FOO_LIBRARY NAMES foo)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(FindPackageHandleStandardArgs)</span><br><span class="line">find_package_handle_standard_args(Foo</span><br><span class="line">  REQUIRED_VARSOO_LIBRARY FOO_INCLUDE_DIR)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(FOO_FOUND)</span><br><span class="line">  <span class="keyword">set</span>(FOO_LIBRARIES <span class="variable">$&#123;FOO_LIBRARY&#125;</span>)</span><br><span class="line">  <span class="keyword">set</span>(FOO_INCLUDE_DIRS <span class="variable">$&#123;FOO_INCLUDE_DIR&#125;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<p>é¡¹ç›®ä¸­å³å¯ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(Foo REQUIRED)</span><br><span class="line"><span class="keyword">target_include_directories</span>(app PRIVATE <span class="variable">$&#123;FOO_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE <span class="variable">$&#123;FOO_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="10-8-å°è£…å¤–éƒ¨ä¾èµ–"><a href="#10-8-å°è£…å¤–éƒ¨ä¾èµ–" class="headerlink" title="10.8â€¯å°è£…å¤–éƒ¨ä¾èµ–"></a>10.8â€¯å°è£…å¤–éƒ¨ä¾èµ–</h2><p>å¯¹äºå¸¸è§ç¬¬ä¸‰æ–¹åº“ï¼Œä¾‹å¦‚ fmtã€spdlogã€OpenCVã€Boostï¼š  </p>
<ul>
<li><strong>ä¼˜å…ˆä½¿ç”¨å®˜æ–¹ CMake åŒ…</strong>  <figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(fmt CONFIG REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE fmt::fmt)</span><br></pre></td></tr></table></figure></li>
<li><strong>æ— å®˜æ–¹åŒ…æ—¶ä½¿ç”¨ Find æ¨¡å—</strong>  </li>
<li><strong>æˆ–è€…ä½¿ç”¨ FetchContent ç›´æ¥åµŒå…¥æºç </strong></li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(FetchContent)</span><br><span class="line">FetchContent_Declare(spdlog</span><br><span class="line">  GIT_REPOSITORY https://github.com/gabime/spdlog.git</span><br><span class="line">  GIT_TAG v1.<span class="number">13.0</span>)</span><br><span class="line">FetchContent_MakeAvailable(spdlog)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE spdlog::spdlog)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="10-9-æ¡ä»¶ç¼–è¯‘ä¸å¹³å°å·®å¼‚"><a href="#10-9-æ¡ä»¶ç¼–è¯‘ä¸å¹³å°å·®å¼‚" class="headerlink" title="10.9â€¯æ¡ä»¶ç¼–è¯‘ä¸å¹³å°å·®å¼‚"></a>10.9â€¯æ¡ä»¶ç¼–è¯‘ä¸å¹³å°å·®å¼‚</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(WIN32)</span><br><span class="line">  <span class="keyword">target_compile_definitions</span>(app PRIVATE PLATFORM_WINDOWS)</span><br><span class="line"><span class="keyword">elseif</span>(APPLE)</span><br><span class="line">  <span class="keyword">target_compile_definitions</span>(app PRIVATE PLATFORM_MACOS)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">  <span class="keyword">target_compile_definitions</span>(app PRIVATE PLATFORM_LINUX)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<p>-â€¯<code>WIN32</code>,â€¯<code>UNIX</code>,â€¯<code>APPLE</code>,â€¯<code>CMAKE_SYSTEM_NAME</code>â€¯ç­‰å˜é‡ç”¨äºåˆ¤æ–­ç³»ç»Ÿï¼›<br>-â€¯å¯é…åˆâ€¯generatorâ€¯expressionâ€¯åœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨åˆ‡æ¢ã€‚</p>
<hr>
<h2 id="10-10-ç”Ÿæˆå™¨è¡¨è¾¾å¼å›é¡¾"><a href="#10-10-ç”Ÿæˆå™¨è¡¨è¾¾å¼å›é¡¾" class="headerlink" title="10.10â€¯ç”Ÿæˆå™¨è¡¨è¾¾å¼å›é¡¾"></a>10.10â€¯ç”Ÿæˆå™¨è¡¨è¾¾å¼å›é¡¾</h2><p><strong>ç”Ÿæˆå™¨è¡¨è¾¾å¼</strong> <code>$&lt;...&gt;</code><br>å¯åœ¨é…ç½®æ—¶å†³å®šæŸä¸ªå±æ€§åœ¨ä¸åŒæ¡ä»¶ä¸‹çš„å€¼ï¼š  </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_compile_definitions</span>(app PRIVATE</span><br><span class="line">  $&lt;$&lt;CONFIG:Debug&gt;:DEBUG_BUILD&gt;)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(app PRIVATE</span><br><span class="line">  $&lt;$&lt;PLATFORM_ID:Windows&gt;:ws2_32&gt;)</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ç»Ÿä¸€ç®¡ç†å¤šå¹³å°å·®å¼‚ä¸”ä¿æŒæ–‡ä»¶æ•´æ´ã€‚</p>
<hr>
<h2 id="10-11-æœ€ä½³å®è·µæ€»ç»“"><a href="#10-11-æœ€ä½³å®è·µæ€»ç»“" class="headerlink" title="10.11â€¯æœ€ä½³å®è·µæ€»ç»“"></a>10.11â€¯æœ€ä½³å®è·µæ€»ç»“</h2><p>âœ…â€¯<strong>æ¨¡å—åŸåˆ™</strong>  </p>
<ul>
<li>æ¯ä¸ªæ¨¡å—å°½é‡ç‹¬ç«‹ï¼ˆè‡ªå®šä¹‰å¤´ã€æºç ã€CMakeListsï¼‰  </li>
<li>åœ¨æ¥å£ä¸Šæš´éœ²ç›®æ ‡è€Œéè·¯å¾„  </li>
<li>é¿å…ä½¿ç”¨å…¨å±€å˜é‡ä¸å…¨å±€ include_directories</li>
</ul>
<p>âœ…â€¯<strong>å‡½æ•°å°è£…</strong>  </p>
<ul>
<li>å°†é‡å¤è§„åˆ™æŠ½è±¡æˆå‡½æ•°  </li>
<li>å°½é‡é¿å…å®æ±¡æŸ“å…¨å±€</li>
</ul>
<p>âœ…â€¯<strong>ä¾èµ–ç®¡ç†</strong>  </p>
<ul>
<li>ä¼˜å…ˆâ€¯CONFIGâ€¯åŒ… â†’â€¯Find æ¨¡å— â†’â€¯FetchContent  </li>
<li>è‡ªå·±çš„åº“è¦å¯¼å‡ºâ€¯Configâ€¯æ–‡ä»¶æ–¹ä¾¿ä»–äººâ€¯find_package()</li>
</ul>
<p>âœ…â€¯<strong>ç›®å½•ç»„ç»‡</strong>  </p>
<ul>
<li><code>cmake/</code>â€¯æ”¾è‡ªå®šä¹‰è„šæœ¬  </li>
<li><code>include/</code>â€¯æš´éœ²å¤´æ–‡ä»¶  </li>
<li><code>src/</code>â€¯æ”¾å®ç°  </li>
<li><code>tests/</code>ã€<code>examples/</code>â€¯æ¸…æ™°åˆ†å±‚</li>
</ul>
<hr>
<h2 id="10-12-æ•´é—¨è¯¾ç¨‹å›é¡¾-ğŸ™Œ"><a href="#10-12-æ•´é—¨è¯¾ç¨‹å›é¡¾-ğŸ™Œ" class="headerlink" title="10.12â€¯æ•´é—¨è¯¾ç¨‹å›é¡¾ ğŸ™Œ"></a>10.12â€¯æ•´é—¨è¯¾ç¨‹å›é¡¾ ğŸ™Œ</h2><table>
<thead>
<tr>
<th>ç« èŠ‚</th>
<th>æ ¸å¿ƒå†…å®¹</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>CMakeâ€¯åˆä½“éªŒ</td>
</tr>
<tr>
<td>2</td>
<td>åŸºæœ¬å‘½ä»¤ä¸å˜é‡</td>
</tr>
<tr>
<td>3</td>
<td>ç›®æ ‡ä¸ä¾èµ–ç®¡ç†</td>
</tr>
<tr>
<td>4</td>
<td>ç¼–è¯‘é€‰é¡¹ä¸ç‰¹æ€§æ§åˆ¶</td>
</tr>
<tr>
<td>5</td>
<td>æ¡ä»¶ã€å¾ªç¯ä¸å®</td>
</tr>
<tr>
<td>6</td>
<td>å¤–éƒ¨é¡¹ç›®ä¸â€¯FetchContent</td>
</tr>
<tr>
<td>7</td>
<td>è‡ªå®šä¹‰å‘½ä»¤ä¸ç›®æ ‡</td>
</tr>
<tr>
<td>8</td>
<td>æµ‹è¯•ä¸â€¯CTest&#x2F;CDash</td>
</tr>
<tr>
<td>9</td>
<td>å®‰è£…ä¸å¯¼å‡ºé…ç½®</td>
</tr>
<tr>
<td>10</td>
<td>æ¨¡å—åŒ–ä¸å¤§å‹å·¥ç¨‹æ¶æ„</td>
</tr>
</tbody></table>
<p>ğŸ¯â€¯ç°åœ¨ä½ èƒ½ä»é›¶è®¾è®¡ã€æ„å»ºã€æµ‹è¯•ã€å®‰è£…å¹¶å¤ç”¨è·¨å¹³å°â€¯CMakeâ€¯é¡¹ç›®ã€‚  </p>
<hr>
<hr>
<h1 id="ğŸ“˜-é™„å½•-CMake-å¸¸ç”¨å‘½ä»¤ã€å˜é‡ä¸ç”Ÿæˆè¡¨è¾¾å¼é€ŸæŸ¥è¡¨"><a href="#ğŸ“˜-é™„å½•-CMake-å¸¸ç”¨å‘½ä»¤ã€å˜é‡ä¸ç”Ÿæˆè¡¨è¾¾å¼é€ŸæŸ¥è¡¨" class="headerlink" title="ğŸ“˜ é™„å½•â€¯|â€¯CMakeâ€¯å¸¸ç”¨å‘½ä»¤ã€å˜é‡ä¸ç”Ÿæˆè¡¨è¾¾å¼é€ŸæŸ¥è¡¨"></a>ğŸ“˜ é™„å½•â€¯|â€¯CMakeâ€¯å¸¸ç”¨å‘½ä»¤ã€å˜é‡ä¸ç”Ÿæˆè¡¨è¾¾å¼é€ŸæŸ¥è¡¨</h1><hr>
<h2 id="ğŸ”§-A-1-æ ¸å¿ƒå‘½ä»¤é€ŸæŸ¥"><a href="#ğŸ”§-A-1-æ ¸å¿ƒå‘½ä»¤é€ŸæŸ¥" class="headerlink" title="ğŸ”§â€¯A.1â€¯æ ¸å¿ƒå‘½ä»¤é€ŸæŸ¥"></a>ğŸ”§â€¯A.1â€¯æ ¸å¿ƒå‘½ä»¤é€ŸæŸ¥</h2><table>
<thead>
<tr>
<th>ç±»åˆ«</th>
<th>å¸¸ç”¨å‘½ä»¤</th>
<th>åŠŸèƒ½æ¦‚è¿°</th>
</tr>
</thead>
<tbody><tr>
<td><strong>é¡¹ç›®åˆå§‹åŒ–</strong></td>
<td><code>cmake_minimum_required()</code></td>
<td>å£°æ˜æ‰€éœ€æœ€ä½ç‰ˆæœ¬</td>
</tr>
<tr>
<td></td>
<td><code>project(&lt;name&gt; VERSION &lt;v&gt; LANGUAGES C CXX)</code></td>
<td>å®šä¹‰é¡¹ç›®åç§°ä¸è¯­è¨€</td>
</tr>
<tr>
<td><strong>æ„å»ºé€»è¾‘</strong></td>
<td><code>add_executable()</code></td>
<td>å®šä¹‰å¯æ‰§è¡Œæ–‡ä»¶</td>
</tr>
<tr>
<td></td>
<td><code>add_library()</code></td>
<td>å®šä¹‰é™æ€æˆ–åŠ¨æ€åº“</td>
</tr>
<tr>
<td></td>
<td><code>target_link_libraries()</code></td>
<td>ç»‘å®šä¾èµ–ç›®æ ‡</td>
</tr>
<tr>
<td></td>
<td><code>target_include_directories()</code></td>
<td>è®¾ç½®å¤´æ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<td></td>
<td><code>target_compile_definitions()</code></td>
<td>æŒ‡å®šå®å®šä¹‰</td>
</tr>
<tr>
<td><strong>å˜é‡ä¸é€‰é¡¹</strong></td>
<td><code>set()</code></td>
<td>å®šä¹‰å˜é‡</td>
</tr>
<tr>
<td></td>
<td><code>option()</code></td>
<td>å®šä¹‰å¼€å…³</td>
</tr>
<tr>
<td></td>
<td><code>message()</code></td>
<td>è¾“å‡ºä¿¡æ¯</td>
</tr>
<tr>
<td><strong>ç›®å½•å±‚çº§</strong></td>
<td><code>add_subdirectory()</code></td>
<td>åŒ…å«å­ç›®å½•</td>
</tr>
<tr>
<td></td>
<td><code>include()</code></td>
<td>å¼•å…¥è„šæœ¬æ–‡ä»¶</td>
</tr>
<tr>
<td><strong>æ¡ä»¶ä¸å¾ªç¯</strong></td>
<td><code>if()/elseif()/else()/endif()</code></td>
<td>æ¡ä»¶åˆ¤æ–­</td>
</tr>
<tr>
<td></td>
<td><code>foreach()/endforeach()</code></td>
<td>å¾ªç¯è¿­ä»£</td>
</tr>
<tr>
<td></td>
<td><code>while()/endwhile()</code></td>
<td>æ¡ä»¶å¾ªç¯</td>
</tr>
<tr>
<td><strong>å®‰è£…ä¸æ‰“åŒ…</strong></td>
<td><code>install()</code></td>
<td>å®‰è£…æ–‡ä»¶&#x2F;ç›®æ ‡</td>
</tr>
<tr>
<td></td>
<td><code>include(CPack)</code></td>
<td>å¯åŠ¨æ‰“åŒ…ç³»ç»Ÿ</td>
</tr>
<tr>
<td><strong>æµ‹è¯•</strong></td>
<td><code>enable_testing()</code></td>
<td>å¼€å¯æµ‹è¯•åŠŸèƒ½</td>
</tr>
<tr>
<td></td>
<td><code>add_test()</code></td>
<td>æ³¨å†Œæµ‹è¯•</td>
</tr>
<tr>
<td></td>
<td><code>ctest</code></td>
<td>å‘½ä»¤è¡Œæ‰§è¡Œæµ‹è¯•</td>
</tr>
<tr>
<td><strong>è‡ªå®šä¹‰è¡Œä¸º</strong></td>
<td><code>add_custom_command()</code></td>
<td>è‡ªå®šä¹‰å‘½ä»¤</td>
</tr>
<tr>
<td></td>
<td><code>add_custom_target()</code></td>
<td>è‡ªå®šä¹‰ç›®æ ‡</td>
</tr>
<tr>
<td><strong>å¯¼å…¥ä¸ä¾èµ–</strong></td>
<td><code>find_package()</code></td>
<td>æŸ¥æ‰¾å¤–éƒ¨åº“</td>
</tr>
<tr>
<td></td>
<td><code>find_library()</code>â€¯&#x2F;â€¯<code>find_path()</code></td>
<td>æŸ¥æ‰¾æ–‡ä»¶æˆ–åº“è·¯å¾„</td>
</tr>
<tr>
<td><strong>è„šæœ¬ä¸å‡½æ•°</strong></td>
<td><code>function()</code></td>
<td>å®šä¹‰å±€éƒ¨å‡½æ•°</td>
</tr>
<tr>
<td></td>
<td><code>macro()</code></td>
<td>å®šä¹‰å®</td>
</tr>
<tr>
<td><strong>å¯¼å‡ºå¤ç”¨</strong></td>
<td><code>install(EXPORT â€¦)</code></td>
<td>å®‰è£…å¯¼å‡ºç›®æ ‡</td>
</tr>
<tr>
<td></td>
<td><code>export(EXPORT â€¦)</code></td>
<td>å¯¼å‡ºæ„å»ºå†…ç›®æ ‡</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ§©-A-2-é‡è¦å˜é‡é€ŸæŸ¥"><a href="#ğŸ§©-A-2-é‡è¦å˜é‡é€ŸæŸ¥" class="headerlink" title="ğŸ§©â€¯A.2â€¯é‡è¦å˜é‡é€ŸæŸ¥"></a>ğŸ§©â€¯A.2â€¯é‡è¦å˜é‡é€ŸæŸ¥</h2><table>
<thead>
<tr>
<th>å˜é‡</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>CMAKE_SOURCE_DIR</code></td>
<td>é¡¶å±‚æºç›®å½•</td>
</tr>
<tr>
<td><code>CMAKE_BINARY_DIR</code></td>
<td>é¡¶å±‚æ„å»ºç›®å½•</td>
</tr>
<tr>
<td><code>CMAKE_CURRENT_SOURCE_DIR</code></td>
<td>å½“å‰è„šæœ¬æºç›®å½•</td>
</tr>
<tr>
<td><code>CMAKE_CURRENT_BINARY_DIR</code></td>
<td>å½“å‰è„šæœ¬æ„å»ºç›®å½•</td>
</tr>
<tr>
<td><code>CMAKE_INSTALL_PREFIX</code></td>
<td>å®‰è£…è·¯å¾„</td>
</tr>
<tr>
<td><code>CMAKE_BUILD_TYPE</code></td>
<td>æ„å»ºç±»å‹ï¼ˆDebug&#x2F;Releaseï¼‰</td>
</tr>
<tr>
<td><code>PROJECT_SOURCE_DIR</code> &#x2F; <code>PROJECT_BINARY_DIR</code></td>
<td>å½“å‰é¡¹ç›®è·¯å¾„</td>
</tr>
<tr>
<td><code>CMAKE_CXX_STANDARD</code></td>
<td>è®¾ç½® C++ æ ‡å‡†ç‰ˆæœ¬</td>
</tr>
<tr>
<td><code>CMAKE_MODULE_PATH</code></td>
<td>æŸ¥æ‰¾è‡ªå®šä¹‰æ¨¡å—è·¯å¾„</td>
</tr>
<tr>
<td><code>CMAKE_PREFIX_PATH</code></td>
<td>æç¤º find_package() æŸ¥æ‰¾å‰ç¼€</td>
</tr>
<tr>
<td><code>CMAKE_TOOLCHAIN_FILE</code></td>
<td>æŒ‡å®šäº¤å‰ç¼–è¯‘å·¥å…·é“¾æ–‡ä»¶</td>
</tr>
<tr>
<td><code>CMAKE_GENERATOR</code></td>
<td>å½“å‰ç”Ÿæˆå™¨ç±»å‹</td>
</tr>
<tr>
<td><code>CMAKE_EXPORT_COMPILE_COMMANDS</code></td>
<td>è¾“å‡ºâ€¯compile_commands.json</td>
</tr>
</tbody></table>
<hr>
<h2 id="âš™ï¸-A-3-å¸¸ç”¨ç”Ÿæˆè¡¨è¾¾å¼ï¼ˆGenerator-Expressionsï¼‰"><a href="#âš™ï¸-A-3-å¸¸ç”¨ç”Ÿæˆè¡¨è¾¾å¼ï¼ˆGenerator-Expressionsï¼‰" class="headerlink" title="âš™ï¸â€¯A.3â€¯å¸¸ç”¨ç”Ÿæˆè¡¨è¾¾å¼ï¼ˆGenerator Expressionsï¼‰"></a>âš™ï¸â€¯A.3â€¯å¸¸ç”¨ç”Ÿæˆè¡¨è¾¾å¼ï¼ˆGenerator Expressionsï¼‰</h2><table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>åŠŸèƒ½è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>$&lt;CONFIG:Debug&gt;</code></td>
<td>åœ¨ Debugâ€¯é…ç½®æ—¶ä¸ºçœŸ</td>
</tr>
<tr>
<td><code>$&lt;STREQUAL:a,b&gt;</code></td>
<td>åˆ¤æ–­å­—ç¬¦ä¸²ç›¸ç­‰</td>
</tr>
<tr>
<td><code>$&lt;PLATFORM_ID:Windows&gt;</code></td>
<td>åŒ¹é…ç‰¹å®šå¹³å°</td>
</tr>
<tr>
<td><code>$&lt;COMPILE_LANG_AND_ID:CXX,Clang&gt;</code></td>
<td>æ£€æµ‹ç¼–è¯‘å™¨</td>
</tr>
<tr>
<td><code>$&lt;TARGET_EXISTS:foo&gt;</code></td>
<td>åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨</td>
</tr>
<tr>
<td><code>$&lt;BUILD_INTERFACE:â€¦&gt;</code></td>
<td>æ„å»ºé˜¶æ®µæœ‰æ•ˆå†…å®¹</td>
</tr>
<tr>
<td><code>$&lt;INSTALL_INTERFACE:â€¦&gt;</code></td>
<td>å®‰è£…é˜¶æ®µæœ‰æ•ˆå†…å®¹</td>
</tr>
<tr>
<td><code>$&lt;BOOL:var&gt;</code></td>
<td>å¸ƒå°”å–å€¼</td>
</tr>
<tr>
<td><code>$&lt;IF:cond,then,else&gt;</code></td>
<td>æ¡ä»¶è¡¨è¾¾å¼</td>
</tr>
<tr>
<td><code>$&lt;AND:cond1,cond2&gt;</code></td>
<td>ä¸é€»è¾‘</td>
</tr>
<tr>
<td><code>$&lt;OR:cond1,cond2&gt;</code></td>
<td>æˆ–é€»è¾‘</td>
</tr>
</tbody></table>
<p>å¸¸è§ç”¨æ³•ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_include_directories</span>(mylib PUBLIC</span><br><span class="line">  $&lt;BUILD_INTERFACE:<span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/<span class="keyword">include</span>&gt;</span><br><span class="line">  $&lt;INSTALL_INTERFACE:<span class="keyword">include</span>&gt;)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§°-A-4-CTest-å‘½ä»¤é€ŸæŸ¥"><a href="#ğŸ§°-A-4-CTest-å‘½ä»¤é€ŸæŸ¥" class="headerlink" title="ğŸ§°â€¯A.4â€¯CTestâ€¯å‘½ä»¤é€ŸæŸ¥"></a>ğŸ§°â€¯A.4â€¯CTestâ€¯å‘½ä»¤é€ŸæŸ¥</h2><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>ctest -N</code></td>
<td>ä»…åˆ—å‡ºæµ‹è¯•</td>
</tr>
<tr>
<td><code>ctest -V</code></td>
<td>è¯¦ç»†æ¨¡å¼</td>
</tr>
<tr>
<td><code>ctest -R &lt;regex&gt;</code></td>
<td>æŒ‰åç§°ç­›é€‰</td>
</tr>
<tr>
<td><code>ctest --output-on-failure</code></td>
<td>ä»…è¾“å‡ºå¤±è´¥æµ‹è¯•ä¿¡æ¯</td>
</tr>
<tr>
<td><code>ctest -L &lt;label&gt;</code></td>
<td>æŒ‰æ ‡ç­¾æ‰§è¡Œ</td>
</tr>
<tr>
<td><code>ctest -T memcheck</code></td>
<td>è¿è¡Œå†…å­˜æ£€æŸ¥</td>
</tr>
<tr>
<td><code>ctest -T coverage</code></td>
<td>è¿è¡Œè¦†ç›–ç‡æµ‹è¯•</td>
</tr>
<tr>
<td><code>ctest -S &lt;script&gt;</code></td>
<td>è¿è¡Œè„šæœ¬æ¨¡å¼</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸª£-A-5-ç›®å½•ç»„ç»‡é£æ ¼ä¸å‘½åå»ºè®®"><a href="#ğŸª£-A-5-ç›®å½•ç»„ç»‡é£æ ¼ä¸å‘½åå»ºè®®" class="headerlink" title="ğŸª£â€¯A.5â€¯ç›®å½•ç»„ç»‡é£æ ¼ä¸å‘½åå»ºè®®"></a>ğŸª£â€¯A.5â€¯ç›®å½•ç»„ç»‡é£æ ¼ä¸å‘½åå»ºè®®</h2><table>
<thead>
<tr>
<th>é¡¹ç›®éƒ¨åˆ†</th>
<th>ç¤ºä¾‹</th>
<th>å»ºè®®</th>
</tr>
</thead>
<tbody><tr>
<td>ä¸»ä»£ç </td>
<td><code>src/</code></td>
<td>æŒ‰æ¨¡å—ç»†åˆ†ï¼šcoreã€uiã€net</td>
</tr>
<tr>
<td>å¤´æ–‡ä»¶</td>
<td><code>include/&lt;project&gt;/</code></td>
<td>å¯¹å¤–æ¥å£</td>
</tr>
<tr>
<td>å•å…ƒæµ‹è¯•</td>
<td><code>tests/</code></td>
<td>ä¸€è‡´çš„å‘½åï¼š<code>test_*.cpp</code></td>
</tr>
<tr>
<td>ç¤ºä¾‹</td>
<td><code>examples/</code></td>
<td>æ•™å­¦æˆ–éªŒè¯ä»£ç </td>
</tr>
<tr>
<td>CMake è„šæœ¬</td>
<td><code>cmake/</code></td>
<td>å­˜æ”¾ Find æ¨¡å— &#x2F; å·¥å…·å‡½æ•°</td>
</tr>
<tr>
<td>è¾“å‡ºç›®å½•</td>
<td><code>build/</code></td>
<td>æºç å¤–æ„å»º</td>
</tr>
<tr>
<td>å®‰è£…äº§ç‰©</td>
<td><code>dist/</code>â€¯æˆ–â€¯<code>install/</code></td>
<td>å‘å¸ƒåŒ…</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ“œ-A-6-å®ç”¨æŠ€å·§æ±‡æ€»"><a href="#ğŸ“œ-A-6-å®ç”¨æŠ€å·§æ±‡æ€»" class="headerlink" title="ğŸ“œâ€¯A.6â€¯å®ç”¨æŠ€å·§æ±‡æ€»"></a>ğŸ“œâ€¯A.6â€¯å®ç”¨æŠ€å·§æ±‡æ€»</h2><ul>
<li>ä½¿ç”¨â€¯<code>target_*</code>â€¯ç³»åˆ—ä»£æ›¿å…¨å±€å‘½ä»¤ï¼›</li>
<li>è‡ªåŠ¨æ£€æµ‹ç¼–è¯‘å™¨æ”¯æŒï¼š<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(CheckCXXCompilerFlag)</span><br><span class="line">check_cxx_compiler_flag(<span class="string">&quot;-std=c++20&quot;</span> HAS_CXX20)</span><br></pre></td></tr></table></figure></li>
<li>é€šè¿‡â€¯<code>FetchContent</code>â€¯ç®¡ç†è½»é‡ä¾èµ–ï¼›</li>
<li>ä½¿ç”¨â€¯<code>find_package(... CONFIG REQUIRED)</code>â€¯ä¼˜å…ˆå¯¼å…¥ç°ä»£â€¯CMakeâ€¯åŒ…ï¼›</li>
<li>åœ¨å¤šå¹³å°è„šæœ¬ä¸­åˆ©ç”¨ç”Ÿæˆè¡¨è¾¾å¼æ§åˆ¶å·®å¼‚ï¼›</li>
<li>æ„å»ºå‹å¯¼å‡ºä¸å®‰è£…å‹å¯¼å‡ºç»“åˆï¼Œæé«˜å¤ç”¨æ€§ï¼›</li>
<li>ç¡®ä¿é¡¹ç›®æœ€é¡¶å±‚â€¯<code>CMakeLists.txt</code>â€¯å¹²å‡€ç®€æ˜ï¼Œå¯ä½œä¸ºç¤ºä¾‹æ•™å­¦ï¼›</li>
<li>é‡‡ç”¨â€¯<code>ctest</code>â€¯æŒç»­æµ‹è¯•å’Œâ€¯CDashâ€¯å¯è§†åŒ–ç»“æœã€‚</li>
</ul>
<hr>
<h2 id="ğŸ§­-A-7-å‚è€ƒä¸åç»­å­¦ä¹ è·¯çº¿"><a href="#ğŸ§­-A-7-å‚è€ƒä¸åç»­å­¦ä¹ è·¯çº¿" class="headerlink" title="ğŸ§­â€¯A.7â€¯å‚è€ƒä¸åç»­å­¦ä¹ è·¯çº¿"></a>ğŸ§­â€¯A.7â€¯å‚è€ƒä¸åç»­å­¦ä¹ è·¯çº¿</h2><table>
<thead>
<tr>
<th>ä¸»é¢˜</th>
<th>æ¨èèµ„æº</th>
</tr>
</thead>
<tbody><tr>
<td>å®˜æ–¹æ–‡æ¡£</td>
<td><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/latest">https://cmake.org/cmake/help/latest</a></td>
</tr>
<tr>
<td>Kitware Blog</td>
<td>æ·±å…¥è®²è§£ç°ä»£â€¯CMakeâ€¯ç‰¹æ€§ä¸å®è·µ</td>
</tr>
<tr>
<td>â€œEffectiveâ€¯Modernâ€¯CMakeâ€ï¼ˆå¼€æºç”µå­ä¹¦ï¼‰</td>
<td>ç³»ç»Ÿæ•´ç†ç°ä»£ç”¨æ³•</td>
</tr>
<tr>
<td>GoogleTest &#x2F; Catch2 é›†æˆ</td>
<td>å®˜æ–¹ç¤ºä¾‹ä»“åº“</td>
</tr>
<tr>
<td>Conan &#x2F; vcpkg</td>
<td>æ„å»ºä¸æ‰“åŒ…ç”Ÿæ€å·¥å…·</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ“-ç»“è¯­"><a href="#ğŸ“-ç»“è¯­" class="headerlink" title="ğŸ“â€¯ç»“è¯­"></a>ğŸ“â€¯ç»“è¯­</h2><p>ä½ å·²ç»å®Œæ•´æŒæ¡ä»åŸºç¡€åˆ°è¿›é˜¶çš„â€¯CMakeâ€¯å·¥ç¨‹æŠ€å·§ï¼š<br>ä» <strong>æ„å»ºç³»ç»Ÿç”Ÿæˆ â†’ æ¨¡å—åŒ–ä¾èµ–ç®¡ç† â†’ æµ‹è¯• â†’ å®‰è£…æ‰“åŒ… â†’ å¤ç”¨ä¸å‘å¸ƒ</strong>ã€‚  </p>
<p>æ— è®ºæ˜¯å°å‹å¼€æºåº“è¿˜æ˜¯ä¼ä¸šçº§è·¨å¹³å°é¡¹ç›®ï¼Œ<br>è¿™å¥—ä½“ç³»éƒ½èƒ½ç›´æ¥åº”ç”¨ã€‚  </p>
<hr>
<p>âœ… <strong>å­¦ä¹ å®Œç»“</strong></p>
<blockquote>
<p>æ­å–œå®Œæˆã€Šç°ä»£â€¯CMakeâ€¯å¼€å‘ä¸å·¥ç¨‹å®è·µæŒ‡å—ã€‹ğŸ‰<br>å¯ä»¥è‡ªè¡Œåˆ›å»ºé¡¹ç›®ã€ç»´æŠ¤æ¨¡å—åº“å’Œé›†æˆâ€¯CI&#x2F;CDâ€¯æµ‹è¯•ï¼</p>
</blockquote>
<hr>
<hr>
<h1 id="ğŸ—ï¸-CMake-é¡¹ç›®è„šæ‰‹æ¶æ¨¡æ¿"><a href="#ğŸ—ï¸-CMake-é¡¹ç›®è„šæ‰‹æ¶æ¨¡æ¿" class="headerlink" title="ğŸ—ï¸â€¯CMakeâ€¯é¡¹ç›®è„šæ‰‹æ¶æ¨¡æ¿"></a>ğŸ—ï¸â€¯CMakeâ€¯é¡¹ç›®è„šæ‰‹æ¶æ¨¡æ¿</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MyProject/                # é¡¹ç›®æ ¹ç›®å½•</span><br><span class="line">â”œâ”€ CMakeLists.txt         # é¡¶å±‚é…ç½®</span><br><span class="line">â”œâ”€ include/</span><br><span class="line">â”‚   â””â”€ myproject/</span><br><span class="line">â”‚       â””â”€ myproject.h</span><br><span class="line">â”œâ”€ src/</span><br><span class="line">â”‚   â”œâ”€ CMakeLists.txt</span><br><span class="line">â”‚   â””â”€ myproject.cpp</span><br><span class="line">â”œâ”€ tests/</span><br><span class="line">â”‚   â”œâ”€ CMakeLists.txt</span><br><span class="line">â”‚   â””â”€ test_main.cpp</span><br><span class="line">â”œâ”€ cmake/</span><br><span class="line">â”‚   â””â”€ Utils.cmake        # å·¥å…·æ¨¡å—ç¤ºä¾‹</span><br><span class="line">â””â”€ README.md</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§©-é¡¶å±‚-CMakeLists-txt"><a href="#ğŸ§©-é¡¶å±‚-CMakeLists-txt" class="headerlink" title="ğŸ§© é¡¶å±‚â€¯CMakeLists.txt"></a>ğŸ§© é¡¶å±‚â€¯CMakeLists.txt</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.20</span>)</span><br><span class="line"><span class="keyword">project</span>(MyProject VERSION <span class="number">1.0</span>.<span class="number">0</span> LANGUAGES CXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1ï¸âƒ£ å…¨å±€è®¾ç½®</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">17</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD_REQUIRED <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_EXTENSIONS <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_EXPORT_COMPILE_COMMANDS <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">option</span>(ENABLE_TESTS <span class="string">&quot;Build and run unit tests&quot;</span> <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">list</span>(APPEND CMAKE_MODULE_PATH <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;/cmake&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2ï¸âƒ£ å­ç›®å½•</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(src)</span><br><span class="line"><span class="keyword">if</span>(ENABLE_TESTS)</span><br><span class="line">  <span class="keyword">enable_testing</span>()</span><br><span class="line">  <span class="keyword">add_subdirectory</span>(tests)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3ï¸âƒ£ å®‰è£…å¯¼å‡ºé…ç½®ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"><span class="keyword">include</span>(CMakePackageConfigHelpers)</span><br><span class="line"><span class="keyword">install</span>(TARGETS myproject</span><br><span class="line">  <span class="keyword">EXPORT</span> MyProjectTargets</span><br><span class="line">  ARCHIVE DESTINATION lib</span><br><span class="line">  LIBRARY DESTINATION lib</span><br><span class="line">  RUNTIME DESTINATION bin)</span><br><span class="line"><span class="keyword">install</span>(DIRECTORY <span class="keyword">include</span>/ DESTINATION <span class="keyword">include</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> MyProjectTargets</span><br><span class="line">  <span class="keyword">FILE</span> MyProjectTargets.cmake</span><br><span class="line">  NAMESPACE MyProject::</span><br><span class="line">  DESTINATION lib/cmake/MyProject)</span><br><span class="line"></span><br><span class="line">configure_package_config_file(</span><br><span class="line">  cmake/MyProjectConfig.cmake.in</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjectConfig.cmake&quot;</span></span><br><span class="line">  INSTALL_DESTINATION lib/cmake/MyProject)</span><br><span class="line"></span><br><span class="line">write_basic_package_version_file(</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjectConfigVersion.cmake&quot;</span></span><br><span class="line">  VERSION <span class="variable">$&#123;PROJECT_VERSION&#125;</span></span><br><span class="line">  COMPATIBILITY SameMajorVersion)</span><br><span class="line"></span><br><span class="line"><span class="keyword">install</span>(FILES</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjectConfig.cmake&quot;</span></span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/MyProjectConfigVersion.cmake&quot;</span></span><br><span class="line">  DESTINATION lib/cmake/MyProject)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4ï¸âƒ£ CPack æ‰“åŒ…</span></span><br><span class="line"><span class="keyword">set</span>(CPACK_PACKAGE_VENDOR <span class="string">&quot;YourName&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CPACK_PACKAGE_CONTACT <span class="string">&quot;you@example.com&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(CPACK_PACKAGE_FILE_NAME <span class="string">&quot;$&#123;PROJECT_NAME&#125;-$&#123;PROJECT_VERSION&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">include</span>(CPack)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âš™ï¸-src-CMakeLists-txt"><a href="#âš™ï¸-src-CMakeLists-txt" class="headerlink" title="âš™ï¸â€¯src&#x2F;CMakeLists.txt"></a>âš™ï¸â€¯src&#x2F;CMakeLists.txt</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(myproject myproject.cpp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>(myproject</span><br><span class="line">  PUBLIC</span><br><span class="line">    $&lt;BUILD_INTERFACE:<span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/<span class="keyword">include</span>&gt;</span><br><span class="line">    $&lt;INSTALL_INTERFACE:<span class="keyword">include</span>&gt;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_compile_features</span>(myproject PUBLIC cxx_std_17)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰å‡½æ•°ï¼ˆæ¼”ç¤ºï¼‰ï¼š</span></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/cmake/Utils.cmake)</span><br><span class="line">add_my_compile_options(myproject)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ¨-cmake-Utils-cmake"><a href="#âœ¨-cmake-Utils-cmake" class="headerlink" title="âœ¨â€¯cmake&#x2F;Utils.cmake"></a>âœ¨â€¯cmake&#x2F;Utils.cmake</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(add_my_compile_options <span class="keyword">target</span>)</span><br><span class="line">  <span class="keyword">message</span>(STATUS <span class="string">&quot;Applying default warnings to target $&#123;target&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">target_compile_options</span>(<span class="variable">$&#123;target&#125;</span></span><br><span class="line">    PRIVATE</span><br><span class="line">      $&lt;$&lt;CXX_COMPILER_ID:MSVC&gt;:/W4 /permissive-&gt;</span><br><span class="line">      $&lt;$&lt;<span class="keyword">NOT</span>:$CXX_COMPILER_ID:MSVC&gt;&gt;:-Wall -Wextra -Wpedantic&gt;)</span><br><span class="line"><span class="keyword">endfunction</span>()</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§±-src-myproject-cpp"><a href="#ğŸ§±-src-myproject-cpp" class="headerlink" title="ğŸ§±â€¯src&#x2F;myproject.cpp"></a>ğŸ§±â€¯src&#x2F;myproject.cpp</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;myproject/myproject.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myproject::say_hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello, CMake world!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“˜-include-myproject-myproject-h"><a href="#ğŸ“˜-include-myproject-myproject-h" class="headerlink" title="ğŸ“˜â€¯include&#x2F;myproject&#x2F;myproject.h"></a>ğŸ“˜â€¯include&#x2F;myproject&#x2F;myproject.h</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="keyword">namespace</span> myproject &#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">say_hello</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§ª-tests-CMakeLists-txt"><a href="#ğŸ§ª-tests-CMakeLists-txt" class="headerlink" title="ğŸ§ªâ€¯tests&#x2F;CMakeLists.txt"></a>ğŸ§ªâ€¯tests&#x2F;CMakeLists.txt</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(test_main test_main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(test_main PRIVATE myproject)</span><br><span class="line"><span class="keyword">add_test</span>(NAME test_main <span class="keyword">COMMAND</span> test_main)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§ª-tests-test-main-cpp"><a href="#ğŸ§ª-tests-test-main-cpp" class="headerlink" title="ğŸ§ªâ€¯tests&#x2F;test_main.cpp"></a>ğŸ§ªâ€¯tests&#x2F;test_main.cpp</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;myproject/myproject.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    myproject::<span class="built_in">say_hello</span>();</span><br><span class="line">    <span class="comment">// ç®€å•éªŒè¯è¾“å‡ºï¼Œå¯æ‰©å±•ä¸ºå•å…ƒæµ‹è¯•æ¡†æ¶ï¼ˆå¦‚â€¯Catch2â€¯æˆ–â€¯GoogleTestï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“¥-æ„å»ºä¸æµ‹è¯•æŒ‡ä»¤"><a href="#ğŸ“¥-æ„å»ºä¸æµ‹è¯•æŒ‡ä»¤" class="headerlink" title="ğŸ“¥â€¯æ„å»ºä¸æµ‹è¯•æŒ‡ä»¤"></a>ğŸ“¥â€¯æ„å»ºä¸æµ‹è¯•æŒ‡ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1ï¸âƒ£ é…ç½®æ„å»º</span></span><br><span class="line">cmake -S . -B build</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2ï¸âƒ£ ç¼–è¯‘</span></span><br><span class="line">cmake --build build -j</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3ï¸âƒ£ è¿è¡Œæµ‹è¯•</span></span><br><span class="line">ctest --test-dir build --output-on-failure</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4ï¸âƒ£ å®‰è£…åˆ°æœ¬åœ°ï¼ˆé»˜è®¤ /usr/localï¼‰</span></span><br><span class="line">cmake --install build</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5ï¸âƒ£ æ‰“åŒ…</span></span><br><span class="line">cpack --config build/CPackConfig.cmake</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<p>âœ… è¿™ä¸€å¥—æ¨¡æ¿èƒ½ç«‹å³è¿è¡Œï¼š<br>åœ¨ä¸€ä¸ªç©ºç›®å½•ä¸­å¤åˆ¶è¿™äº›æ–‡ä»¶ â†’ æ„å»º â†’ è¿è¡Œ â†’ çœ‹åˆ°<br><code>Hello, CMake world!</code>â€¯è¾“å‡ºï¼Œå³æˆåŠŸï¼</p>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Fravel Wang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/CMAKE%E5%AE%8C%E5%85%A8%E6%89%8B%E5%86%8C/">http://example.com/CMAKE%E5%AE%8C%E5%85%A8%E6%89%8B%E5%86%8C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/avatar.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/%E4%BD%A0%E5%A5%BD%E5%B9%B6%E5%8F%91%E4%B8%96%E7%95%8C%E6%96%87%E6%91%98/" title="ä½ å¥½å¹¶å‘ä¸–ç•Œæ–‡æ‘˜"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">ä½ å¥½å¹¶å‘ä¸–ç•Œæ–‡æ‘˜</div></div><div class="info-2"><div class="info-item-1">   121.2 ä¸ºä»€ä¹ˆä½¿ç”¨å¹¶å‘ï¼Ÿä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼šå…³æ³¨ç‚¹åˆ†ç¦»(SOC)å’Œæ€§èƒ½ã€‚ 2ç§å¹¶å‘æ–¹å¼ï¼Œå¤šè¿›ç¨‹ å’Œ å¤šçº¿ç¨‹å¤šè¿›ç¨‹ï¼š å¼€é”€æ›´å¤§ï¼Œè¿›ç¨‹é—´é€šä¿¡æ›´éº»çƒ¦(IPC) è¿›ç¨‹å†…å­˜å¸ƒå±€(may 1Mb)0x100000    high address0x â€¦         command-line arguments and variables0x â€¦         stack0x â€¦         heap0x â€¦         uninitialized data(bss), initialized to zero by exec0x â€¦         initialized data       , read from program file by exec0x â€¦         text                   , read from program file by exec0x000000    low address                                          çº¿ç¨‹ä¹‹é—´å…±äº« uninitialized data(bs...</div></div></div></a><a class="pagination-related" href="/%E7%AE%80%E6%98%8ECMAKE%E8%AF%AD%E6%B3%95%E4%B8%8E%E5%B7%A5%E7%A8%8B%E7%AE%A1%E7%90%86%E6%8C%87%E5%8D%97/" title="ç®€æ˜CMAKEè¯­æ³•ä¸å·¥ç¨‹ç®¡ç†æŒ‡å—"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">ç®€æ˜CMAKEè¯­æ³•ä¸å·¥ç¨‹ç®¡ç†æŒ‡å—</div></div><div class="info-2"><div class="info-item-1">å¿«é€Ÿè®¤è¯†CMakeï¼Œå¹¶æŒæ¡ç®€å•çš„å·¥ç¨‹åŒ–çš„èƒ½åŠ›, è¡¥å……å†…å®¹ï¼Œå¦‚æœè¿˜æœ‰é—æ¼å¯ä»¥åˆ°å®Œå…¨æ‰‹å†Œä¸­æŸ¥è¯¢ç›¸å…³è¯´æ˜ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸæ–‡ç¨¿  ğŸ§­ æ€»è§ˆç»“æ„ CMake æ¦‚å¿µé€Ÿè§ˆä¸å±‚æ¬¡å…³ç³»   å‘½ä»¤è¡Œè¯­æ³• vs. è„šæœ¬è¯­æ³• å·¥ç¨‹ç»„ç»‡æ€æƒ³   CMake è¯­æ³•å¤§å…¨ï¼ˆè„šæœ¬è¯­æ³• + å‘½ä»¤è¡Œè¯­æ³•ï¼‰ è¯­è¨€ç»“æ„ã€æ§åˆ¶æµã€å˜é‡ã€å‡½æ•°ã€å® å¸¸ç”¨å‘½ä»¤ï¼ˆaddã€targetã€linkã€installã€exportç­‰ï¼‰ å‘½ä»¤è¡Œå·¥å…·ï¼ˆcmakeã€ctestã€cpackï¼‰   å·¥ç¨‹å®æˆ˜æ¨¡æ¿ä¸èŒƒä¾‹ æ ‡å‡†é¡¹ç›®ç»“æ„ + å«å¤šå­åº“&#x2F;åŠ¨æ€&#x2F;é™æ€ + å¤–éƒ¨åº“ + å¤´æ–‡ä»¶å¼•ç”¨ + install&#x2F;export é™„å¸¦æ˜“ç†è§£çš„ C++ ç¤ºä¾‹ä»£ç  åˆ†çº§è§£é‡Šä½œç”¨ã€å¯ç›´æ¥ç¼–è¯‘è¿è¡Œ     ğŸ§© PART Iï¼šCMake æ¦‚å¿µä¸ç»“æ„ğŸ€ CMake æ˜¯â€œä¸¤å±‚è¯­è¨€â€   å±‚ æè¿° ç±»æ¯”    è„šæœ¬è¯­æ³• CMakeLists.txt æ–‡ä»¶ï¼Œç”± CMake è¯­æ³•ç»„æˆï¼Œç”¨æ¥æè¿°å·¥ç¨‹è§„åˆ™ Shell è„šæœ¬   å‘½ä»¤è¡Œæ¥å£ cmake CLI å‘½ä»¤ï¼Œç”¨äºé…ç½®ã€æ„å»ºã€å®‰è£…ã€æµ‹è¯•ã€æ‰“åŒ… æ§åˆ¶é¢æ¿   !&gt; CMake ä¸æ˜¯ç¼–è¯‘å™¨ï¼Œä¹Ÿä¸...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Fravel Wang</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/fravelwang"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%A7%B1-%E7%AC%AC-1-%E7%AB%A0-CMake-%E5%8F%98%E9%87%8F%E7%B3%BB%E7%BB%9F%E5%85%A8%E8%A7%A3%EF%BC%88%E8%84%9A%E6%9C%AC%E8%AF%AD%E6%B3%95%E6%A0%B8%E5%BF%83%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">ğŸ§±â€¯ç¬¬â€¯1â€¯ç« â€¯|â€¯CMakeâ€¯å˜é‡ç³»ç»Ÿå…¨è§£ï¼ˆè„šæœ¬è¯­æ³•æ ¸å¿ƒï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%AE%9A%E4%B9%89%E8%A7%84%E5%88%99"><span class="toc-number">1.1.</span> <span class="toc-text">1.â€¯å˜é‡ç±»å‹ä¸å®šä¹‰è§„åˆ™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%B8%89%E7%B1%BB%E4%B8%BB%E8%A6%81%E5%8F%98%E9%87%8F"><span class="toc-number">1.2.</span> <span class="toc-text">2.â€¯ä¸‰ç±»ä¸»è¦å˜é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.</span> <span class="toc-text">3.â€¯å˜é‡ä½œç”¨åŸŸç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%97%E8%A1%A8%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.</span> <span class="toc-text">4.â€¯åˆ—è¡¨ä¸å­—ç¬¦ä¸²æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%88%97%E8%A1%A8%E5%9F%BA%E7%A1%80"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1â€¯åˆ—è¡¨åŸºç¡€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%B8%B8%E7%94%A8-list-%E5%AD%90%E5%91%BD%E4%BB%A4"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2â€¯å¸¸ç”¨â€¯list()â€¯å­å‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3â€¯å­—ç¬¦ä¸²å¤„ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%A2%84%E5%AE%9A%E4%B9%89%E8%B7%AF%E5%BE%84%E5%8F%98%E9%87%8F%EF%BC%88%E5%BF%85%E9%A1%BB%E7%86%9F%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">5.â€¯é¢„å®šä¹‰è·¯å¾„å˜é‡ï¼ˆå¿…é¡»ç†Ÿï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E8%B7%AF%E5%BE%84%E4%B8%8E%E6%96%87%E4%BB%B6%E8%BE%85%E5%8A%A9%E5%8F%98%E9%87%8F"><span class="toc-number">1.6.</span> <span class="toc-text">6.â€¯è·¯å¾„ä¸æ–‡ä»¶è¾…åŠ©å˜é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%8F%98%E9%87%8F%E5%AD%98%E5%9C%A8%E6%80%A7%E4%B8%8E%E9%BB%98%E8%AE%A4%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-number">1.7.</span> <span class="toc-text">7.â€¯å˜é‡å­˜åœ¨æ€§ä¸é»˜è®¤å€¼å¤„ç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7%EF%BC%9A%E7%88%B6%E4%BD%9C%E7%94%A8%E5%9F%9F-%E5%A4%8D%E5%90%88%E8%B7%AF%E5%BE%84"><span class="toc-number">1.8.</span> <span class="toc-text">8.â€¯é«˜çº§æŠ€å·§ï¼šçˆ¶ä½œç”¨åŸŸ &amp; å¤åˆè·¯å¾„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E5%B0%8F%E7%BB%93%E4%B8%8E%E5%B8%B8%E8%A7%81%E8%AF%AF%E5%8C%BA"><span class="toc-number">1.9.</span> <span class="toc-text">9.â€¯å°ç»“ä¸å¸¸è§è¯¯åŒº</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E7%AC%AC-2-%E7%AB%A0-CMake-%E7%9B%AE%E6%A0%87-Target-%E4%BD%93%E7%B3%BB%E4%B8%8E%E4%BE%9D%E8%B5%96%E6%9C%BA%E5%88%B6%E5%85%A8%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">âš™ï¸â€¯ç¬¬â€¯2â€¯ç« â€¯|â€¯CMakeâ€¯ç›®æ ‡â€¯(Target)â€¯ä½“ç³»ä¸ä¾èµ–æœºåˆ¶å…¨è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Target-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">2.1.</span> <span class="toc-text">2.1â€¯Targetâ€¯æ˜¯ä»€ä¹ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E5%88%9B%E5%BB%BA%E7%9B%AE%E6%A0%87"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1â€¯åˆ›å»ºç›®æ ‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E7%9B%AE%E6%A0%87%E5%91%BD%E5%90%8D%E4%B8%8E%E8%B7%AF%E5%BE%84%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2â€¯ç›®æ ‡å‘½åä¸è·¯å¾„å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-target-link-libraries%EF%BC%9A%E5%BB%BA%E7%AB%8B%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="toc-number">2.2.</span> <span class="toc-text">2.2â€¯target_link_librariesï¼šå»ºç«‹ä¾èµ–å…³ç³»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%9C%BA%E6%99%AF%E4%B8%BE%E4%BE%8B"><span class="toc-number">2.2.1.</span> <span class="toc-text">å¸¸è§åœºæ™¯ä¸¾ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-target-include-directories%EF%BC%9A%E5%A4%B4%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="toc-number">2.3.</span> <span class="toc-text">2.3â€¯target_include_directoriesï¼šå¤´æ–‡ä»¶è·¯å¾„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-target-compile-definitions%EF%BC%9A%E7%BC%96%E8%AF%91%E5%AE%8F"><span class="toc-number">2.4.</span> <span class="toc-text">2.4â€¯target_compile_definitionsï¼šç¼–è¯‘å®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-target-compile-options%EF%BC%9A%E6%B7%BB%E5%8A%A0%E7%BC%96%E8%AF%91%E5%99%A8%E6%A0%87%E5%BF%97"><span class="toc-number">2.5.</span> <span class="toc-text">2.5â€¯target_compile_optionsï¼šæ·»åŠ ç¼–è¯‘å™¨æ ‡å¿—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E7%9B%AE%E6%A0%87%E5%B1%9E%E6%80%A7-%E4%B8%8E-get-set"><span class="toc-number">2.6.</span> <span class="toc-text">2.6â€¯ç›®æ ‡å±æ€§â€¯ä¸â€¯get&#x2F;set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-%E5%AF%BC%E5%85%A5%E4%B8%8E%E6%8E%A5%E5%8F%A3%E7%9B%AE%E6%A0%87"><span class="toc-number">2.7.</span> <span class="toc-text">2.7â€¯å¯¼å…¥ä¸æ¥å£ç›®æ ‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-1-IMPORTED"><span class="toc-number">2.7.1.</span> <span class="toc-text">2.7.1â€¯IMPORTED</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2-INTERFACE"><span class="toc-number">2.7.2.</span> <span class="toc-text">2.7.2â€¯INTERFACE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-NAMESPACE"><span class="toc-number">2.8.</span> <span class="toc-text">2.8â€¯å‘½åç©ºé—´â€¯(NAMESPACE)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E4%B8%8E%E6%8E%92%E6%9F%A5"><span class="toc-number">2.9.</span> <span class="toc-text">2.9â€¯å¸¸è§é”™è¯¯ä¸æ’æŸ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">2.10.</span> <span class="toc-text">2.10â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%A7%A9-%E7%AC%AC-3-%E7%AB%A0-install-%E4%B8%8E-export-%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">ğŸ§© ç¬¬â€¯3â€¯ç« â€¯|â€¯install()â€¯ä¸â€¯export()â€¯æœºåˆ¶è¯¦è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81-install"><span class="toc-number">3.1.</span> <span class="toc-text">3.1â€¯ä¸ºä»€ä¹ˆè¦â€¯install()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%88%86%E7%B1%BB"><span class="toc-number">3.2.</span> <span class="toc-text">3.2â€¯åŸºæœ¬è¯­æ³•åˆ†ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E4%B8%BB%E8%A6%81%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">3.3.</span> <span class="toc-text">3.3â€¯ä¸»è¦å‚æ•°è¯´æ˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AE%89%E8%A3%85%E5%BA%93%E4%B8%8E%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">3.4â€¯ç¤ºä¾‹ï¼šå®‰è£…åº“ä¸å¯æ‰§è¡Œæ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-install-EXPORT-%E7%94%9F%E6%88%90-Config-%E5%8C%85"><span class="toc-number">3.5.</span> <span class="toc-text">3.5â€¯install(EXPORT)â€¯ç”Ÿæˆâ€¯Configâ€¯åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">3.5.1.</span> <span class="toc-text">æ­¥éª¤ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-%E5%AF%BC%E5%87%BA%E6%B8%85%E5%8D%95%E4%B8%8E%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%EF%BC%88NAMESPACE%EF%BC%89"><span class="toc-number">3.6.</span> <span class="toc-text">3.6â€¯å¯¼å‡ºæ¸…å•ä¸å‘½åç©ºé—´ï¼ˆNAMESPACEï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-7-install-FILES-DIRECTORY-%E5%B8%B8%E8%A7%84%E7%94%A8%E9%80%94"><span class="toc-number">3.7.</span> <span class="toc-text">3.7â€¯install(FILES | DIRECTORY)â€¯å¸¸è§„ç”¨é€”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-8-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%A8%A1%E6%9D%BF-configure-file"><span class="toc-number">3.8.</span> <span class="toc-text">3.8â€¯é…ç½®æ–‡ä»¶æ¨¡æ¿â€¯configure_file()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-9-%E5%B8%B8%E8%A7%81-install-%E5%8F%98%E9%87%8F"><span class="toc-number">3.9.</span> <span class="toc-text">3.9â€¯å¸¸è§ install å˜é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-10-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98-Q-A"><span class="toc-number">3.10.</span> <span class="toc-text">3.10â€¯å¸¸è§é—®é¢˜â€¯Q&amp;A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-11-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">3.11.</span> <span class="toc-text">3.11â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%94%8D-%E7%AC%AC-4-%E7%AB%A0-find-package-%E4%B8%8E-CMake-%E5%8C%85%EF%BC%88Package%EF%BC%89%E6%9C%BA%E5%88%B6%E5%AE%9E%E6%88%98"><span class="toc-number">4.</span> <span class="toc-text">ğŸ” ç¬¬â€¯4â€¯ç« â€¯|â€¯find_package()â€¯ä¸â€¯CMakeâ€¯åŒ…ï¼ˆPackageï¼‰æœºåˆ¶å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-find-package-%E7%9A%84%E4%BD%BF%E5%91%BD"><span class="toc-number">4.1.</span> <span class="toc-text">4.1â€¯find_packageâ€¯çš„ä½¿å‘½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E4%B8%A4%E7%A7%8D%E5%8C%85%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.2.</span> <span class="toc-text">4.2â€¯ä¸¤ç§åŒ…æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-Config-%E6%A8%A1%E5%BC%8F%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.3.</span> <span class="toc-text">4.3â€¯Config æ¨¡å¼å·¥ä½œåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-Config-%E6%96%87%E4%BB%B6%E6%A8%A1%E6%9D%BF%E5%BF%AB%E9%80%9F%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.3.1.</span> <span class="toc-text">4.3.1â€¯Config æ–‡ä»¶æ¨¡æ¿å¿«é€Ÿç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-Find-%E6%A8%A1%E5%BC%8F%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.4.</span> <span class="toc-text">4.4â€¯Find æ¨¡å¼å·¥ä½œåŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-%E6%90%9C%E7%B4%A2%E8%B7%AF%E5%BE%84%E4%B8%8E%E6%8E%A7%E5%88%B6%E5%8F%98%E9%87%8F"><span class="toc-number">4.5.</span> <span class="toc-text">4.5â€¯æœç´¢è·¯å¾„ä¸æ§åˆ¶å˜é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-%E7%89%88%E6%9C%AC%E4%B8%8E%E5%8F%AF%E9%80%89%E9%A1%B9"><span class="toc-number">4.6.</span> <span class="toc-text">4.6â€¯ç‰ˆæœ¬ä¸å¯é€‰é¡¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-CMakePackageConfigHelpers-%E5%B7%A5%E5%85%B7"><span class="toc-number">4.7.</span> <span class="toc-text">4.7â€¯CMakePackageConfigHelpers å·¥å…·</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8-%E8%B7%A8%E5%B9%B3%E5%8F%B0-Find-%E5%AE%9E%E6%88%98%E4%B8%BE%E4%BE%8B"><span class="toc-number">4.8.</span> <span class="toc-text">4.8â€¯è·¨å¹³å° Find å®æˆ˜ä¸¾ä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9F%A5%E6%89%BE%E7%B3%BB%E7%BB%9F%E5%BA%93-OpenSSL"><span class="toc-number">4.8.1.</span> <span class="toc-text">(1)â€¯æŸ¥æ‰¾ç³»ç»Ÿåº“ OpenSSL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9F%A5%E6%89%BE%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%85%E8%B7%AF%E5%BE%84"><span class="toc-number">4.8.2.</span> <span class="toc-text">(2)â€¯æŸ¥æ‰¾è‡ªå®šä¹‰åŒ…è·¯å¾„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8-pkg-config-%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.8.3.</span> <span class="toc-text">(3)â€¯ä½¿ç”¨â€¯pkg-configâ€¯æ¨¡å¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-9-%E6%9F%A5%E6%89%BE%E4%BC%98%E5%85%88%E7%BA%A7%E7%AE%80%E5%8C%96%E6%B5%81%E7%A8%8B"><span class="toc-number">4.9.</span> <span class="toc-text">4.9â€¯æŸ¥æ‰¾ä¼˜å…ˆçº§ç®€åŒ–æµç¨‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-10-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E4%B8%8E%E7%BB%8F%E9%AA%8C"><span class="toc-number">4.10.</span> <span class="toc-text">4.10â€¯å¸¸è§é—®é¢˜ä¸ç»éªŒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-11-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">4.11.</span> <span class="toc-text">4.11â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%A7%B1-%E7%AC%AC-5-%E5%A4%9A%E7%9B%AE%E5%BD%95%E4%B8%8E%E5%AD%90%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%EF%BC%9Aadd-subdirectory-%E4%B8%8E-FetchContent-%E5%AE%9E%E6%88%98"><span class="toc-number">5.</span> <span class="toc-text">ğŸ§± ç¬¬â€¯5â€¯â€¯|â€¯å¤šç›®å½•ä¸å­é¡¹ç›®ç®¡ç†ï¼šadd_subdirectory()â€¯ä¸â€¯FetchContentâ€¯å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E5%A4%9A%E7%9B%AE%E5%BD%95%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">5.1.</span> <span class="toc-text">5.1â€¯å¤šç›®å½•é¡¹ç›®ç»“æ„çš„æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-add-subdirectory"><span class="toc-number">5.2.</span> <span class="toc-text">5.2â€¯add_subdirectory()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E5%8F%98%E9%87%8F%E4%BC%A0%E6%92%AD%E8%A7%84%E5%88%99"><span class="toc-number">5.3.</span> <span class="toc-text">5.3â€¯ä½œç”¨åŸŸä¸å˜é‡ä¼ æ’­è§„åˆ™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E5%AD%90%E9%A1%B9%E7%9B%AE%E9%97%B4%E4%BE%9D%E8%B5%96"><span class="toc-number">5.4.</span> <span class="toc-text">5.4â€¯å­é¡¹ç›®é—´ä¾èµ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-EXCLUDE-FROM-ALL-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">5.5.</span> <span class="toc-text">5.5â€¯EXCLUDE_FROM_ALLâ€¯çš„ä½¿ç”¨åœºæ™¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-%E5%A4%96%E9%83%A8%E5%AD%90%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88%E4%B8%80%EF%BC%9Aadd-subdirectory-FetchContent"><span class="toc-number">5.6.</span> <span class="toc-text">5.6â€¯å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆä¸€ï¼šadd_subdirectory + FetchContent</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-1-%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">5.6.1.</span> <span class="toc-text">5.6.1â€¯åŸºæœ¬æµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-2-%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0"><span class="toc-number">5.6.2.</span> <span class="toc-text">5.6.2â€¯å¯é€‰å‚æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7-%E5%A4%96%E9%83%A8%E5%AD%90%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88%E4%BA%8C%EF%BC%9AExternalProject-Add"><span class="toc-number">5.7.</span> <span class="toc-text">5.7â€¯å¤–éƒ¨å­é¡¹ç›®ç®¡ç†æ–¹æ¡ˆäºŒï¼šExternalProject_Add</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-8-%E5%A4%9A%E7%9B%AE%E5%BD%95%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.8.</span> <span class="toc-text">5.8â€¯å¤šç›®å½•é¡¹ç›®å®è·µç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-9-%E5%A4%9A%E7%9B%AE%E5%BD%95%E7%BB%84%E7%BB%87%E7%BB%8F%E9%AA%8C"><span class="toc-number">5.9.</span> <span class="toc-text">5.9â€¯å¤šç›®å½•ç»„ç»‡ç»éªŒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-10-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">5.10.</span> <span class="toc-text">5.10â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E7%AC%AC-6-%E7%AB%A0-%E6%9E%84%E5%BB%BA%E7%B1%BB%E5%9E%8B%EF%BC%88Debug-Release%EF%BC%89%E4%B8%8E%E5%A4%9A%E9%85%8D%E7%BD%AE%E3%80%81%E5%A4%9A%E5%B9%B3%E5%8F%B0%E7%AD%96%E7%95%A5"><span class="toc-number">6.</span> <span class="toc-text">âš™ï¸ ç¬¬â€¯6â€¯ç« â€¯|â€¯æ„å»ºç±»å‹ï¼ˆDebug&#x2F;Releaseï¼‰ä¸å¤šé…ç½®ã€å¤šå¹³å°ç­–ç•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E6%9E%84%E5%BB%BA%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">6.1.</span> <span class="toc-text">6.1â€¯æ„å»ºç±»å‹çš„æ ¸å¿ƒæ¦‚å¿µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E5%8D%95%E9%85%8D%E7%BD%AE%E7%94%9F%E6%88%90%E5%99%A8-%F0%9F%A7%A9"><span class="toc-number">6.2.</span> <span class="toc-text">6.2â€¯å•é…ç½®ç”Ÿæˆå™¨ ğŸ§©</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E5%A4%9A%E9%85%8D%E7%BD%AE%E7%94%9F%E6%88%90%E5%99%A8-%F0%9F%A7%A9"><span class="toc-number">6.3.</span> <span class="toc-text">6.3â€¯å¤šé…ç½®ç”Ÿæˆå™¨ ğŸ§©</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E5%AE%9A%E4%B9%89%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9E%84%E5%BB%BA%E7%B1%BB%E5%9E%8B%EF%BC%88%E8%BF%9B%E9%98%B6%EF%BC%89"><span class="toc-number">6.4.</span> <span class="toc-text">6.4â€¯å®šä¹‰è‡ªå®šä¹‰æ„å»ºç±»å‹ï¼ˆè¿›é˜¶ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E5%B8%B8%E8%A7%81%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9%E5%8F%98%E9%87%8F"><span class="toc-number">6.5.</span> <span class="toc-text">6.5â€¯å¸¸è§ç¼–è¯‘é€‰é¡¹å˜é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-%E9%92%88%E5%AF%B9%E7%9B%AE%E6%A0%87%E7%9A%84%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">6.6.</span> <span class="toc-text">6.6â€¯é’ˆå¯¹ç›®æ ‡çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%8F%98%E9%87%8F%E4%B8%8E%E5%AE%8F"><span class="toc-number">6.7.</span> <span class="toc-text">6.7â€¯è·¨å¹³å°å˜é‡ä¸å®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-8-%E5%A4%9A%E5%B9%B3%E5%8F%B0%E7%BC%96%E8%AF%91%E5%99%A8%E9%80%82%E9%85%8D"><span class="toc-number">6.8.</span> <span class="toc-text">6.8â€¯å¤šå¹³å°ç¼–è¯‘å™¨é€‚é…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-9-%E8%B7%A8%E7%BC%96%E8%AF%91%EF%BC%88Cross-Compilation%EF%BC%89%E7%AE%80%E8%BF%B0"><span class="toc-number">6.9.</span> <span class="toc-text">6.9â€¯è·¨ç¼–è¯‘ï¼ˆCrossâ€¯Compilationï¼‰ç®€è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-10-%E9%BB%98%E8%AE%A4%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95%E6%8C%89%E9%85%8D%E7%BD%AE%E5%88%86%E7%B1%BB"><span class="toc-number">6.10.</span> <span class="toc-text">6.10â€¯é»˜è®¤è¾“å‡ºç›®å½•æŒ‰é…ç½®åˆ†ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-11-%E5%A4%9A%E5%B9%B3%E5%8F%B0%E7%AD%96%E7%95%A5%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">6.11.</span> <span class="toc-text">6.11â€¯å¤šå¹³å°ç­–ç•¥ç»éªŒæ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-12-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">6.12.</span> <span class="toc-text">6.12â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%94%A7-%E7%AC%AC-7-%E7%AB%A0-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4-%E4%B8%8E-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%AE%E6%A0%87%EF%BC%9Aadd-custom-command-add-custom-target"><span class="toc-number">7.</span> <span class="toc-text">ğŸ”§ ç¬¬â€¯7â€¯ç« â€¯|â€¯è‡ªå®šä¹‰å‘½ä»¤â€¯ä¸â€¯è‡ªå®šä¹‰ç›®æ ‡ï¼šadd_custom_command()â€¯&amp;â€¯add_custom_target()</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">7.1.</span> <span class="toc-text">7.1â€¯æ ¸å¿ƒæ¦‚å¿µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-add-custom-command-%E7%94%9F%E6%88%90%E5%9E%8B%E5%91%BD%E4%BB%A4"><span class="toc-number">7.2.</span> <span class="toc-text">7.2â€¯add_custom_command()â€¯ç”Ÿæˆå‹å‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E-target-%E5%BB%BA%E7%AB%8B%E5%85%B3%E7%B3%BB"><span class="toc-number">7.2.1.</span> <span class="toc-text">ä¸ target å»ºç«‹å…³ç³»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-add-custom-target-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%AE%E6%A0%87"><span class="toc-number">7.3.</span> <span class="toc-text">7.3â€¯add_custom_target()â€¯è‡ªå®šä¹‰ç›®æ ‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-add-custom-target-VS-add-custom-command"><span class="toc-number">7.4.</span> <span class="toc-text">7.4â€¯add_custom_targetâ€¯VSâ€¯add_custom_command</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5-%E5%85%B8%E5%9E%8B%E7%94%A8%E9%80%94%E7%A4%BA%E4%BE%8B"><span class="toc-number">7.5.</span> <span class="toc-text">7.5â€¯å…¸å‹ç”¨é€”ç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B5%84%E6%BA%90%E6%8B%B7%E8%B4%9D"><span class="toc-number">7.5.1.</span> <span class="toc-text">(1)â€¯èµ„æºæ‹·è´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90-%E2%86%92-Protobuf"><span class="toc-number">7.5.2.</span> <span class="toc-text">(2)â€¯ä»£ç ç”Ÿæˆ â†’ Protobuf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%89%93%E5%8C%85%E7%9B%AE%E6%A0%87"><span class="toc-number">7.5.3.</span> <span class="toc-text">(3)â€¯æ‰“åŒ…ç›®æ ‡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-6-CMake-%E5%86%85%E7%BD%AE%E8%BE%85%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="toc-number">7.6.</span> <span class="toc-text">7.6â€¯CMake å†…ç½®è¾…åŠ©å‘½ä»¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-7-%E6%9E%84%E5%BB%BA%E4%BA%8B%E4%BB%B6%E4%B8%8E%E9%98%B6%E6%AE%B5"><span class="toc-number">7.7.</span> <span class="toc-text">7.7â€¯æ„å»ºäº‹ä»¶ä¸é˜¶æ®µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B8%85%E7%90%86%E4%B8%8E%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">7.8.</span> <span class="toc-text">7.8â€¯è‡ªå®šä¹‰æ¸…ç†ä¸æ ¼å¼åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E7%90%86%E7%94%9F%E6%88%90%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">7.8.1.</span> <span class="toc-text">æ¸…ç†ç”Ÿæˆæ–‡ä»¶ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%BA%90%E4%BB%A3%E7%A0%81%EF%BC%9A"><span class="toc-number">7.8.2.</span> <span class="toc-text">ä¸€é”®æ ¼å¼åŒ–æºä»£ç ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-9-%E7%BB%BC%E5%90%88%E5%AE%9E%E4%BE%8B%EF%BC%9A%E9%9B%86%E6%88%90%E8%87%AA%E5%8A%A8%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90"><span class="toc-number">7.9.</span> <span class="toc-text">7.9â€¯ç»¼åˆå®ä¾‹ï¼šé›†æˆè‡ªåŠ¨ä»£ç ç”Ÿæˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-10-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">7.10.</span> <span class="toc-text">7.10â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%A7%AA-%E7%AC%AC-8-%E7%AB%A0-%E6%B5%8B%E8%AF%95%E4%B8%8E%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%EF%BC%9ACTest-%E4%B8%8E-CDash-%E4%BD%BF%E7%94%A8"><span class="toc-number">8.</span> <span class="toc-text">ğŸ§ª ç¬¬â€¯8â€¯ç« â€¯|â€¯æµ‹è¯•ä¸æŒç»­é›†æˆï¼šCTestâ€¯ä¸â€¯CDashâ€¯ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-CMake-%E4%B8%8E-CTest-%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">8.1.</span> <span class="toc-text">8.1â€¯CMakeâ€¯ä¸â€¯CTestâ€¯çš„å…³ç³»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E5%90%AF%E7%94%A8%E6%B5%8B%E8%AF%95"><span class="toc-number">8.2.</span> <span class="toc-text">8.2â€¯å¯ç”¨æµ‹è¯•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-add-test-%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">8.3.</span> <span class="toc-text">8.3â€¯add_test()â€¯åŸºç¡€è¯­æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-test-%E5%B1%9E%E6%80%A7%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="toc-number">8.4.</span> <span class="toc-text">8.4â€¯testâ€¯å±æ€§ä¸é…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-%E4%B8%8E-GoogleTest-%E9%9B%86%E6%88%90"><span class="toc-number">8.5.</span> <span class="toc-text">8.5â€¯ä¸â€¯GoogleTestâ€¯é›†æˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-6-%E8%BE%93%E5%87%BA%E4%B8%8E%E6%97%A5%E5%BF%97"><span class="toc-number">8.6.</span> <span class="toc-text">8.6â€¯è¾“å‡ºä¸æ—¥å¿—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-7-%E5%88%86%E7%BB%84%E4%B8%8E%E6%A0%87%E7%AD%BE%E7%AE%A1%E7%90%86"><span class="toc-number">8.7.</span> <span class="toc-text">8.7â€¯åˆ†ç»„ä¸æ ‡ç­¾ç®¡ç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-8-CTest-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">8.8.</span> <span class="toc-text">8.8â€¯CTestâ€¯é…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-9-CTest-%E9%A9%B1%E5%8A%A8%E8%84%9A%E6%9C%AC%E6%A8%A1%E5%BC%8F"><span class="toc-number">8.9.</span> <span class="toc-text">8.9â€¯CTestâ€¯é©±åŠ¨è„šæœ¬æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-10-CDash-%E4%BB%AA%E8%A1%A8%E7%9B%98%E7%AE%80%E4%BB%8B"><span class="toc-number">8.10.</span> <span class="toc-text">8.10â€¯CDashâ€¯ä»ªè¡¨ç›˜ç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-11-%E6%B5%8B%E8%AF%95%E8%A6%86%E7%9B%96%E7%8E%87%E4%B8%8E%E5%86%85%E5%AD%98%E6%A3%80%E6%9F%A5"><span class="toc-number">8.11.</span> <span class="toc-text">8.11â€¯æµ‹è¯•è¦†ç›–ç‡ä¸å†…å­˜æ£€æŸ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A6%86%E7%9B%96%E7%8E%87"><span class="toc-number">8.11.1.</span> <span class="toc-text">è¦†ç›–ç‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%A3%80%E6%9F%A5"><span class="toc-number">8.11.2.</span> <span class="toc-text">å†…å­˜æ³„æ¼æ£€æŸ¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-12-%E4%B8%8E-CI-%E7%B3%BB%E7%BB%9F%E7%BB%93%E5%90%88"><span class="toc-number">8.12.</span> <span class="toc-text">8.12â€¯ä¸ CI ç³»ç»Ÿç»“åˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-13-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">8.13.</span> <span class="toc-text">8.13â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%93%A6-%E7%AC%AC-9-%E7%AB%A0-%E5%AE%89%E8%A3%85%E3%80%81%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%A4%8D%E7%94%A8%EF%BC%9Ainstall-%E4%B8%8E-CMake-Package-Config"><span class="toc-number">9.</span> <span class="toc-text">ğŸ“¦ ç¬¬â€¯9â€¯ç« â€¯|â€¯å®‰è£…ã€å¯¼å‡ºä¸å¤ç”¨ï¼šinstall()â€¯ä¸â€¯CMakeâ€¯Packageâ€¯Config</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-%E5%AE%89%E8%A3%85%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">9.1.</span> <span class="toc-text">9.1â€¯å®‰è£…çš„æ„ä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-install-%E6%A0%B8%E5%BF%83%E8%AF%AD%E6%B3%95"><span class="toc-number">9.2.</span> <span class="toc-text">9.2â€¯install()â€¯æ ¸å¿ƒè¯­æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-%E5%AE%89%E8%A3%85%E5%8F%AF%E6%89%A7%E8%A1%8C%E4%B8%8E%E5%BA%93"><span class="toc-number">9.3.</span> <span class="toc-text">9.3â€¯å®‰è£…å¯æ‰§è¡Œä¸åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-%E5%AE%89%E8%A3%85%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="toc-number">9.4.</span> <span class="toc-text">9.4â€¯å®‰è£…å¤´æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-CMAKE-INSTALL-PREFIX-%E4%BF%AE%E6%94%B9"><span class="toc-number">9.5.</span> <span class="toc-text">9.5â€¯CMAKE_INSTALL_PREFIXâ€¯ä¿®æ”¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-6-%E7%94%9F%E6%88%90%E5%AE%89%E8%A3%85%E5%8C%85%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%E7%A4%BA%E4%BE%8B"><span class="toc-number">9.6.</span> <span class="toc-text">9.6â€¯ç”Ÿæˆå®‰è£…åŒ…ç›®å½•ç»“æ„ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-7-%E5%AF%BC%E5%87%BA%E7%9B%AE%E6%A0%87%E4%B8%8E%E9%87%8D%E7%94%A8"><span class="toc-number">9.7.</span> <span class="toc-text">9.7â€¯å¯¼å‡ºç›®æ ‡ä¸é‡ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-8-Config-Package-%E6%96%87%E4%BB%B6"><span class="toc-number">9.8.</span> <span class="toc-text">9.8â€¯Configâ€¯Packageâ€¯æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-9-%E5%AF%BC%E5%87%BA%E6%9E%84%E5%BB%BA%E7%9B%AE%E5%BD%95%EF%BC%88%E9%9D%9E%E5%AE%89%E8%A3%85%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-number">9.9.</span> <span class="toc-text">9.9â€¯å¯¼å‡ºæ„å»ºç›®å½•ï¼ˆéå®‰è£…æ¨¡å¼ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-10-install-%E5%91%BD%E4%BB%A4%E9%99%84%E5%B8%A6%E7%BB%84%E4%BB%B6%E4%B8%8E%E6%9D%A1%E4%BB%B6"><span class="toc-number">9.10.</span> <span class="toc-text">9.10â€¯installâ€¯å‘½ä»¤é™„å¸¦ç»„ä»¶ä¸æ¡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-11-%E4%BD%BF%E7%94%A8-CPack-%E7%94%9F%E6%88%90%E6%89%93%E5%8C%85%E6%96%87%E4%BB%B6"><span class="toc-number">9.11.</span> <span class="toc-text">9.11â€¯ä½¿ç”¨â€¯CPackâ€¯ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-12-%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93"><span class="toc-number">9.12.</span> <span class="toc-text">9.12â€¯ç« èŠ‚å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%A7%A9-%E7%AC%AC-10-%E7%AB%A0-%E8%BF%9B%E9%98%B6%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E6%A8%A1%E5%9D%97%E5%8C%96%E8%AE%BE%E8%AE%A1%EF%BC%9A%E5%88%86%E5%B1%82%E3%80%81%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0%E3%80%81Find-Module-%E7%BC%96%E5%86%99"><span class="toc-number">10.</span> <span class="toc-text">ğŸ§© ç¬¬â€¯10â€¯ç« â€¯|â€¯è¿›é˜¶é¡¹ç›®ç»“æ„ä¸æ¨¡å—åŒ–è®¾è®¡ï¼šåˆ†å±‚ã€å®ä¸å‡½æ•°ã€Findâ€¯Moduleâ€¯ç¼–å†™</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-%E5%A4%A7%E5%9E%8B%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%B8%E5%9E%8B%E7%BB%93%E6%9E%84"><span class="toc-number">10.1.</span> <span class="toc-text">10.1â€¯å¤§å‹é¡¹ç›®çš„å…¸å‹ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-%E5%B1%82%E7%BA%A7-CMakeLists-txt-%E7%9A%84%E5%8D%8F%E4%BD%9C"><span class="toc-number">10.2.</span> <span class="toc-text">10.2â€¯å±‚çº§ CMakeLists.txtâ€¯çš„åä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-%E6%A8%A1%E5%9D%97%E5%8C%96%E4%B8%8E%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85"><span class="toc-number">10.3.</span> <span class="toc-text">10.3â€¯æ¨¡å—åŒ–ä¸æ¥å£å°è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-4-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E4%B8%8E%E5%AE%8F"><span class="toc-number">10.4.</span> <span class="toc-text">10.4â€¯è‡ªå®šä¹‰å‡½æ•°ä¸å®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-5-%E8%B7%A8%E5%AD%90%E9%A1%B9%E7%9B%AE%E4%BC%A0%E9%80%92%E5%8F%98%E9%87%8F"><span class="toc-number">10.5.</span> <span class="toc-text">10.5â€¯è·¨å­é¡¹ç›®ä¼ é€’å˜é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-6-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97%E8%B7%AF%E5%BE%84"><span class="toc-number">10.6.</span> <span class="toc-text">10.6â€¯è‡ªå®šä¹‰æ¨¡å—è·¯å¾„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-7-Find-Module-%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">10.7.</span> <span class="toc-text">10.7â€¯Findâ€¯Moduleâ€¯æ–‡ä»¶ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-8-%E5%B0%81%E8%A3%85%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96"><span class="toc-number">10.8.</span> <span class="toc-text">10.8â€¯å°è£…å¤–éƒ¨ä¾èµ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-9-%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%AE%E5%BC%82"><span class="toc-number">10.9.</span> <span class="toc-text">10.9â€¯æ¡ä»¶ç¼–è¯‘ä¸å¹³å°å·®å¼‚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-10-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%9E%E9%A1%BE"><span class="toc-number">10.10.</span> <span class="toc-text">10.10â€¯ç”Ÿæˆå™¨è¡¨è¾¾å¼å›é¡¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-11-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93"><span class="toc-number">10.11.</span> <span class="toc-text">10.11â€¯æœ€ä½³å®è·µæ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-12-%E6%95%B4%E9%97%A8%E8%AF%BE%E7%A8%8B%E5%9B%9E%E9%A1%BE-%F0%9F%99%8C"><span class="toc-number">10.12.</span> <span class="toc-text">10.12â€¯æ•´é—¨è¯¾ç¨‹å›é¡¾ ğŸ™Œ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%93%98-%E9%99%84%E5%BD%95-CMake-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E3%80%81%E5%8F%98%E9%87%8F%E4%B8%8E%E7%94%9F%E6%88%90%E8%A1%A8%E8%BE%BE%E5%BC%8F%E9%80%9F%E6%9F%A5%E8%A1%A8"><span class="toc-number">11.</span> <span class="toc-text">ğŸ“˜ é™„å½•â€¯|â€¯CMakeâ€¯å¸¸ç”¨å‘½ä»¤ã€å˜é‡ä¸ç”Ÿæˆè¡¨è¾¾å¼é€ŸæŸ¥è¡¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%A7-A-1-%E6%A0%B8%E5%BF%83%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="toc-number">11.1.</span> <span class="toc-text">ğŸ”§â€¯A.1â€¯æ ¸å¿ƒå‘½ä»¤é€ŸæŸ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A9-A-2-%E9%87%8D%E8%A6%81%E5%8F%98%E9%87%8F%E9%80%9F%E6%9F%A5"><span class="toc-number">11.2.</span> <span class="toc-text">ğŸ§©â€¯A.2â€¯é‡è¦å˜é‡é€ŸæŸ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-A-3-%E5%B8%B8%E7%94%A8%E7%94%9F%E6%88%90%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%88Generator-Expressions%EF%BC%89"><span class="toc-number">11.3.</span> <span class="toc-text">âš™ï¸â€¯A.3â€¯å¸¸ç”¨ç”Ÿæˆè¡¨è¾¾å¼ï¼ˆGenerator Expressionsï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%B0-A-4-CTest-%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="toc-number">11.4.</span> <span class="toc-text">ğŸ§°â€¯A.4â€¯CTestâ€¯å‘½ä»¤é€ŸæŸ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%AA%A3-A-5-%E7%9B%AE%E5%BD%95%E7%BB%84%E7%BB%87%E9%A3%8E%E6%A0%BC%E4%B8%8E%E5%91%BD%E5%90%8D%E5%BB%BA%E8%AE%AE"><span class="toc-number">11.5.</span> <span class="toc-text">ğŸª£â€¯A.5â€¯ç›®å½•ç»„ç»‡é£æ ¼ä¸å‘½åå»ºè®®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9C-A-6-%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB"><span class="toc-number">11.6.</span> <span class="toc-text">ğŸ“œâ€¯A.6â€¯å®ç”¨æŠ€å·§æ±‡æ€»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AD-A-7-%E5%8F%82%E8%80%83%E4%B8%8E%E5%90%8E%E7%BB%AD%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF"><span class="toc-number">11.7.</span> <span class="toc-text">ğŸ§­â€¯A.7â€¯å‚è€ƒä¸åç»­å­¦ä¹ è·¯çº¿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%93-%E7%BB%93%E8%AF%AD"><span class="toc-number">11.8.</span> <span class="toc-text">ğŸ“â€¯ç»“è¯­</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%8F%97%EF%B8%8F-CMake-%E9%A1%B9%E7%9B%AE%E8%84%9A%E6%89%8B%E6%9E%B6%E6%A8%A1%E6%9D%BF"><span class="toc-number">12.</span> <span class="toc-text">ğŸ—ï¸â€¯CMakeâ€¯é¡¹ç›®è„šæ‰‹æ¶æ¨¡æ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A9-%E9%A1%B6%E5%B1%82-CMakeLists-txt"><span class="toc-number">12.1.</span> <span class="toc-text">ğŸ§© é¡¶å±‚â€¯CMakeLists.txt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-src-CMakeLists-txt"><span class="toc-number">12.2.</span> <span class="toc-text">âš™ï¸â€¯src&#x2F;CMakeLists.txt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%A8-cmake-Utils-cmake"><span class="toc-number">12.3.</span> <span class="toc-text">âœ¨â€¯cmake&#x2F;Utils.cmake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%B1-src-myproject-cpp"><span class="toc-number">12.4.</span> <span class="toc-text">ğŸ§±â€¯src&#x2F;myproject.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%98-include-myproject-myproject-h"><span class="toc-number">12.5.</span> <span class="toc-text">ğŸ“˜â€¯include&#x2F;myproject&#x2F;myproject.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-tests-CMakeLists-txt"><span class="toc-number">12.6.</span> <span class="toc-text">ğŸ§ªâ€¯tests&#x2F;CMakeLists.txt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-tests-test-main-cpp"><span class="toc-number">12.7.</span> <span class="toc-text">ğŸ§ªâ€¯tests&#x2F;test_main.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%A5-%E6%9E%84%E5%BB%BA%E4%B8%8E%E6%B5%8B%E8%AF%95%E6%8C%87%E4%BB%A4"><span class="toc-number">12.8.</span> <span class="toc-text">ğŸ“¥â€¯æ„å»ºä¸æµ‹è¯•æŒ‡ä»¤</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Mermaid-cheatsheet/" title="Mermaid cheatsheet">Mermaid cheatsheet</a><time datetime="2025-10-18T04:44:55.000Z" title="Created 2025-10-18 12:44:55">2025-10-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Graphviz-cheatsheet/" title="Graphviz cheatsheet">Graphviz cheatsheet</a><time datetime="2025-10-18T04:41:55.000Z" title="Created 2025-10-18 12:41:55">2025-10-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/PlantUML-cheatsheet/" title="PlantUML cheatsheet">PlantUML cheatsheet</a><time datetime="2025-10-18T04:28:52.000Z" title="Created 2025-10-18 12:28:52">2025-10-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98pdf/" title="linuxå†…æ ¸æ¢ç§˜pdf">linuxå†…æ ¸æ¢ç§˜pdf</a><time datetime="2025-10-14T00:42:49.000Z" title="Created 2025-10-14 08:42:49">2025-10-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E4%BD%A0%E5%A5%BD%E5%B9%B6%E5%8F%91%E4%B8%96%E7%95%8C%E6%96%87%E6%91%98/" title="ä½ å¥½å¹¶å‘ä¸–ç•Œæ–‡æ‘˜">ä½ å¥½å¹¶å‘ä¸–ç•Œæ–‡æ‘˜</a><time datetime="2025-10-13T16:51:43.000Z" title="Created 2025-10-14 00:51:43">2025-10-14</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Fravel Wang</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="local-search-input"><input placeholder="Search for Posts" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div></body></html>